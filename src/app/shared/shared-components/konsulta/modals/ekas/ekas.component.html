<div id="defaultModal" tabindex="-1" class="overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 w-full md:inset-0 h-modal md:h-full justify-center items-center flex" aria-hidden="true" role="dialog" style="z-index:60">
  <div class="relative p-4 max-w-4xl h-full md:h-auto">
    <!-- Modal content -->
    <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
      <!-- Modal header -->
      <div class="flex justify-between items-start py-3 px-5 rounded-t border-b bg-blue-500 dark:border-gray-600">
        <h3 class="mt-2 text-sm font-bold text-white dark:text-white">
            electronic Konsulta Availment Slip (eKAS)
        </h3>
        <button type="button" printSectionId="philhealth_form" ngxPrint [useExistingCss]="true" class="bg-white text-blue-500 hover:bg-gray-100 hover:text-blue-400 px-2 py-1 rounded-md">
          <fa-icon [icon]="faPrint"></fa-icon>
        </button>
      </div>
      <!-- Modal body -->
      <div class="overflow-y-auto scrollbar-thin h-96 scrollbar-thumb-gray-400 scrollbar-track-gray-100" *ngIf="show_form">
        <div class="w-[210mm] h-[297mm] flex justify-center align-middle bg-white">
          <div class="w-[195mm] h-[272mm] mt-[12.5mm]" id="philhealth_form">
            <!-- FORM START -->
            <!-- <div class="w-full p-1 font-semibold">
              ANNEX G: Electronic Konsulta Availment Slip (eKAS)
            </div> -->

            <!-- <div class="text-xs my-5">
              Electronic Konsulta Availment Slip (eKAS) â€“ proof of availment of services by the eligible beneficiary. This will be
              generated by the PhilHealth Konsulta facility for every patient encounter and to be submitted to PhilHealth.
            </div> -->

            <div class="border-2 border-gray-400">
              <div class="flex justify-center h-16 p-1">
                <img src="./assets/img/philhealth_logo_with_name.png" class="h-16" />
                <span class="font-semibold mt-4 ml-5 text-xl">ELECTRONIC KONSULTA AVAILMENT SLIP (EKAS)</span>
              </div>

              <div class="m-1 font-semibold mt-3">
                To be filled-out by the facility (Pupunuan ng Pasilidad)
              </div>

              <table class="table-auto border border-gray-400 p-1 w-full">
                <tbody>
                  <tr>
                    <td colspan="6" class="text-xs border border-gray-400">
                      <span class="font-semibold">HCI NAME:</span><br />
                      {{ facility?.konsulta_credential.facility_name }}
                    </td>
                    <td colspan="2" class="text-xs border border-gray-400">
                      <span class="font-semibold">Case No:</span><br />
                      {{ patient_info?.case_number }}
                    </td>
                    <td colspan="2" class="text-xs border border-gray-400">
                      <span class="font-semibold text-xs">HCI Accreditation No.:</span><br />
                      {{ facility?.konsulta_credential.accreditation_number }}
                    </td>
                    <td colspan="2" class="text-xs border border-gray-400">
                      <span class="font-semibold text-sm">Transaction No.:</span><br />
                      {{ 'S'+consult_details?.transaction_number }}
                    </td>
                  </tr>

                  <tr>
                    <td colspan="6" class="text-xs border border-gray-400">
                      <span class="font-semibold">PIN (PhilHealth Identification No.):</span><br />
                      {{ patient_philhealth?.philhealth_id }}
                    </td>
                    <td colspan="6" class="text-xs border border-gray-400">
                      <span class="font-semibold">Membership Category (Ketegorya ng Miyembro):</span><br />
                      &nbsp;
                    </td>
                  </tr>

                  <tr>
                    <td colspan="6" class="text-xs border border-gray-400">
                      <span class="font-semibold">Patient Name (Pangalan ng Pasyente):</span><br />
                      {{ patient_info?.last_name }}, {{ patient_info?.first_name }} {{ patient_info?.middle_name }} {{ patient_info?.suffix_name === 'NA' ? '' : patient_info?.suffix_name }}
                    </td>
                    <td colspan="3" class="text-xs border border-gray-400">
                      <span class="font-semibold">Age (Edad):</span><br />
                      {{ patient_age }}
                    </td>
                    <td colspan="3" class="text-xs border border-gray-400">
                      <span class="font-semibold">Contact No. (Numero ng Telepono):</span><br />
                      {{ patient_info?.mobile_number }}
                    </td>
                  </tr>

                  <tr>
                    <td colspan="6" class="text-xs border border-gray-400">
                      <span class="font-semibold">Membership Type:</span><br />
                      <div class="flex justify-end">
                        <div>
                          <input type="checkbox" disabled class="input-checkbox disabled:bg-gray-400 checked:bg-gray-400" [checked]="patient_philhealth?.membership_type_id === 'MM'">
                          <label>Member</label>
                        </div>
                        <div class="ml-3">
                          <input type="checkbox" disabled class="input-checkbox disabled:bg-gray-400 checked:bg-gray-400" [checked]="patient_philhealth?.membership_type_id === 'DD'">
                          <label>Dependent</label>
                        </div>
                      </div>
                    </td>
                    <td colspan="6" class="text-xs border border-gray-400">
                      <span class="font-semibold">Authorization Transaction Code (ATC):</span><br />
                      {{ consult_details?.walkedin_status === true ? 'WALKEDIN' : (consult_details?.authorization_transaction_code ? consult_details?.authorization_transaction_code : 'WALKEDIN' ) }}
                    </td>
                  </tr>
                </tbody>
              </table>

              <table class="table-auto border border-gray-400 border-collapse w-full">
                <thead>
                  <tr>
                    <th class="w-6/12 border border-slate-700 text-[.8em]">
                      Konsulta Services
                    </th>
                    <th class="w-1/12 border border-slate-700 text-[.8em]">
                      Performed <br />
                      <fa-icon></fa-icon>
                    </th>
                    <th class="w-3/12 border border-slate-700 text-[.8em]">
                      Date Performed
                    </th>
                    <th class="w-2/12 border border-slate-700 text-[.8em]">
                      Performed by
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of lab_arr | keyvalue">
                    <td class="border border-slate-700 [.8em]">
                      {{ item.value.desc }}
                    </td>
                    <td class="border border-slate-700 text-center [.8em]">
                      <fa-icon [icon]="!item.value.with_result ? faXmark : faCheck"></fa-icon>
                    </td>
                    <td class="border border-slate-700 [.8em] text-center">
                      {{ item.value.with_result ? (item.value.with_result.laboratory_date | date: 'MM/dd/yyyy') : '-'  }}
                    </td>
                    <td class="border border-slate-700 [.8em] text-center">
                      {{ item.value.with_result ? item.value.with_result.user : '-' }}
                    </td>
                  </tr>
                </tbody>
              </table>

              <div class="text-[.6em] border-b-2 border-dashed border-gray-400 w-full p-2">
                Note: <br />
                This form shall be provided to the Konsulta beneficiary
              </div>

              <div class="flex p-2 border-b-2 border-dotted border-gray-400 w-full">
                <div class="w-7/12 text-[.65em]">
                  Have you received the above-mentioned essential services?<br />
                  (Natanggap mo ba ang mga pangunahing serbisyo na nabanggit?)
                </div>
                <div class="text-[.65em] mt-3 ml-5">
                  __Yes (Oo) __No (Hindi)
                </div>
              </div>

              <div class="flex p-2 border-b-2 border-dotted border-gray-400 w-full">
                <div class="w-7/12 text-[.65em]">
                  How satisfied are you with the services provided?<br />
                  (Gaano ka nasiyahan sa natanggap na serbisyo?)
                </div>
                <div class="text-[.65em] ml-5 flex text-center">
                  <input type="checkbox" class="input-checkbox mt-3 ">
                  <div class="ml-2">
                    <fa-icon [icon]="faFaceSmile" class="text-xl"></fa-icon><br />
                    HAPPY
                  </div>
                </div>

                <div class="text-[.65em] ml-5 flex text-center">
                  <input type="checkbox" class="input-checkbox mt-3 ">
                  <div class="ml-2">
                    <fa-icon [icon]="faFaceMeh" class="text-xl"></fa-icon><br />
                    NEUTRAL
                  </div>
                </div>

                <div class="text-[.65em] ml-5 flex text-center">
                  <input type="checkbox" class="input-checkbox mt-3 ">
                  <div class="ml-2">
                    <fa-icon [icon]="faFaceFrown" class="text-xl"></fa-icon><br />
                    SAD
                  </div>
                </div>
              </div>

              <div class="flex p-2 border-b-2 border-gray-400 w-full">
                <div class="w-7/12 text-[.65em]">
                  For your comment, suggestion or complaint:<br />
                  (Para sa iyong komento, mungkahi o reklamo):
                </div>
              </div>
              <div class="flex p-2 border-b-2 border-gray-400 w-full">

              </div>

              <div class="flex p-1 w-full">
                <div class="w-7/12 text-[.65em]">
                  Note:<br />
                  Accomplished form shall be submitted to Konsulta Provider<br />
                  (Ang kumpletong form ay dapay Isumite sa tagapagbigay ng Konsulta)
                </div>
                <div class="text-[.65em] mt-3 ml-5 align-bottom justify-end flex mt-5">
                  Philhealth Identification Number of Patient: <span class="underline">{{ patient_philhealth?.philhealth_id }}</span>
                </div>
              </div>
              <!-- <div class="w-full pl-1 text-xs">
                <div class="grid grid-cols-1">
                  <div class="flex text-[.8em]">
                    Have you received the above-mentioned essential services? __Yes (Oo) __No (Hindi)
                  </div>
                  <div class="flex text-[.8em]">
                    (Natanggap mo ba ang mga essential services na nabanggit?)
                  </div>
                </div>

                <div class="grid grid-cols-4 mt-3">
                  <div class="col-span-2 grid grid-cols-1 text-[.8em]">
                    <span>How satisfied are you with the services provided?</span>
                    <span>(Gaano ka nasiyahan sa natanggap mong serbisyo?)</span>
                  </div>
                  <div class="col-span-2 flex">
                    <div class="w-2 h-2 border border-slate-700 mt-5 mr-2"></div>
                    <fa-icon [icon]="faFaceSmile" class="text-3xl text-green-600 mr-3"></fa-icon>

                    <div class="w-2 h-2 border border-slate-700 mt-5 mr-2"></div>
                    <fa-icon [icon]="faFaceMeh" class="text-3xl text-yellow-500 mr-3"></fa-icon>

                    <div class="w-2 h-2 border border-slate-700 mt-5 mr-2"></div>
                    <fa-icon [icon]="faFaceFrown" class="text-3xl text-red-600"></fa-icon>
                  </div>
                </div>

                <div class="grid grid-cols-1 mt-3">
                  <div class="flex text-[.8em]">
                    For your comment, suggestion or complaint:
                  </div>
                  <div class="flex text-[.8em]">
                    (Para sa iyong komento, mungkahi o reklamo)
                  </div>

                  <div class="w-full border-y border-black h-5 mt-5">

                  </div>
                </div>

                <div class="grid grid-cols-1 mt-3">
                  <div class="flex text-[.8em]">
                    Under the penalty of law, I attest that the information I provided in this slip are true and accurate.
                  </div>
                  <div class="flex text-[.8em]">
                    (Sa ilalim ng batas, pinatutunayan ko na ang impormasyong ibinigay ko ay totoo at tama)
                  </div>
                </div>
              </div>

              <div class="w-full p-1 text-xs mt-7 mb-5">
                <div class="grid grid-cols-12">
                  <div class="col-span-7 text-[.8em]">
                    ________________________________________ <br />
                    Signature over printed name of patient <br />
                    (Lagda sa nakalimbag na pangalan ng pasyente)
                  </div>
                  <div class="col-span-5 text-[.8em]">
                    Next Consultation Date: _____________________ <br />
                    (Petsa ng susunod na bigay ng gamot)
                  </div>
                </div>

                <div class="grid grid-cols-12 mt-4">
                  <div class="col-span-7 text-[.8em]">
                    Note: <br />
                    Accomplished form shall be submitted to PhilHealth <br />
                    (Ang kumpletong form ay dapat isumite sa PhilHealth)
                  </div>
                </div>
              </div> -->
            </div>
            <!-- FORM END -->
          </div>
        </div>


      </div>

      <div class="h-96 flex justify-center align-middle w-full" *ngIf="!show_form">
        <fa-icon [icon]="faCircleNotch" spin="true" size="2xl" class="mt-20 text-blue-500"></fa-icon>
      </div>
      <!-- Modal footer -->
      <div class="flex justify-end py-4 px-5 space-x-4 rounded-b border-t border-gray-200 dark:border-gray-600">
        <button  type="button" class="text-white bg-orange-500 hover:ring-2 focus:outline-none hover:ring-orange-300 rounded text-sm font-medium px-6 py-2.5 transition duration-150 ease-in-out transform hover:scale-110 " (click)="closeModal()">Close</button>
        <!-- <button  type="button" class="text-white bg-blue-500 hover:ring-2 focus:outline-none hover:ring-blue-300 font-medium rounded text-sm px-6 py-2.5 text-center transition duration-150 ease-in-out transform hover:scale-110" (click)="onSubmit()" >Save</button> -->
      </div>
    </div>
  </div>
</div>

<div class="opacity-50 fixed inset-0 z-50 bg-black"></div>
