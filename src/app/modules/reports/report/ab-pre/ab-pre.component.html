<div *ngIf="show_stats" class="grid grid-cols-1">
  <div class="flex justify-between w-full text-blue-500 font-semibold text-lg  p-3" >
    <span>Post-Exposure Prophylaxis Cohort Report</span>
    <span>
      <button  type="button" class="text-2xl" (click)="exportX()">
        <fa-icon [icon]="faFileExcel" class="text-green-700"></fa-icon>
      </button>
    </span>
  </div>

  <div class="w-full flex justify-center text-center text-sm font-semibold">
    Province of {{ facility.province.name }} <br />
    {{ facility.facility_name }} <br />
    Wireless Access for Health <br />
    Report Form on Animal Bite/Human Rabies Cases <br />
    Pre-Exposure Prophylaxis Report <br />
    Period Covered: {{ label_value.labelDate }} Year: {{ label_value.labelYear }} <br /><br />
  </div>

  <table class="w-full table-fix border border-gray-300 mb-5" id="reportForm">
    <thead class="font-normal">
      <tr>
        <th rowspan="2">Municipality/Barangay</th>
        <th colspan="2">Sex</th>
        <th colspan="2">Age</th>
        <th colspan="3">Status of Immunization</th>
      </tr>
      <tr>
        <th>F</th>
        <th>M</th>
        <th>&lt; 15</th>
        <th>&GreaterEqual;; 15</th>
        <th>D0</th>
        <th>D0 & D7</th>
        <th>D0, D7, D21</th>
      </tr>
    </thead>
    <tbody>
      <tr class="text-right" *ngFor="let item of stats; let last = last">
        <td class="text-left">{{ item.name }}</td>
        <td (click)="showNameList('female', item.code)" [class]="item.female > 0 ? 'text-blue-500 hover:cursor-pointer' : 'pointer-events-none'">{{ item.female }} {{ countTotal('female', item.female) }}</td>
        <td (click)="showNameList('male', item.code)" [class]="item.male > 0 ? 'text-blue-500 hover:cursor-pointer' : 'pointer-events-none'">{{ item.male }} {{ countTotal('male', item.male) }}</td>
        <td (click)="showNameList('less_than_15', item.code)" [class]="item.less_than_15 > 0 ? 'text-blue-500 hover:cursor-pointer' : 'pointer-events-none'">{{ item.less_than_15 }} {{ countTotal('less_than_15', item.less_than_15) }}</td>
        <td (click)="showNameList('greater_than_15', item.code)" [class]="item.greater_than_15 > 0 ? 'text-blue-500 hover:cursor-pointer' : 'pointer-events-none'">{{ item.greater_than_15 }} {{ countTotal('greater_than_15', item.greater_than_15) }}</td>
        <td (click)="showNameList('day0', item.code)" [class]="item.day0 > 0 ? 'text-blue-500 hover:cursor-pointer' : 'pointer-events-none'">{{ item.day0 }} {{ countTotal('day0', item.day0) }}</td>
        <td (click)="showNameList('day0_day7', item.code)" [class]="item.day0_day7 > 0 ? 'text-blue-500 hover:cursor-pointer' : 'pointer-events-none'">{{ item.day0_day7 }} {{ countTotal('day0_day7', item.day0_day7) }}</td>
        <td (click)="showNameList('day0_day7_day21', item.code)" [class]="item.day0_day7_day21 > 0 ? 'text-blue-500 hover:cursor-pointer' : 'pointer-events-none'">{{ item.day0_day7_day21 }} {{ countTotal('day0_day7_day21', item.day0_day7_day21, last) }}</td>
      </tr>
      <tr class="text-center font-semibold">
        <td>Total</td>
        <td colspan="2">{{ +total?.female + +total?.male }}</td>
        <td colspan="2">{{ +total?.less_than_15 + +total?.greater_than_15 }}</td>
        <td colspan="3">{{ +total?.day0 + +total?.day0_day7 + +total?.day0_day7_day21 }}</td>
      </tr>

      <tr *ngIf="stats.length === 0">
        <td colspan="8" class="text-center italic font-semibold py-5">No query result</td>
      </tr>
    </tbody>
  </table>
</div>

<app-show-name-list
  *ngIf="openList"
  (toggleModal)="toggleModal()"
  [name_list_params]="name_list_params"
  [selected_barangay]="selected_barangay"
  [reportForm]="reportForm"
  [url]="url"
  [loc]="'fp'"
></app-show-name-list>
