<div id="defaultModal" tabindex="-1" class="overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 w-full md:inset-0 h-modal md:h-full justify-center items-center flex" aria-hidden="true" role="dialog" style="z-index:60">
  <div class="relative p-4 max-w-4xl h-full md:h-auto">
    <!-- Modal content -->
    <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
      <!-- Modal header -->
      <div class="flex justify-between items-start py-3 px-5 rounded-t border-b bg-blue-500 dark:border-gray-600">
        <h3 class="mt-2 text-sm font-bold text-white dark:text-white">
            electronic Konsulta Availment Slip (eKAS)
        </h3>
        <button type="button" printSectionId="philhealth_form" ngxPrint [useExistingCss]="true" class="bg-white text-blue-500 hover:bg-gray-100 hover:text-blue-400 px-2 py-1 rounded-md">
          <fa-icon [icon]="faPrint"></fa-icon>
        </button>
      </div>
      <!-- Modal body -->
      <div class="overflow-y-auto scrollbar-thin h-96 scrollbar-thumb-gray-400 scrollbar-track-gray-100" *ngIf="show_form">
        <div class="w-[210mm] h-[297mm] flex justify-center align-middle bg-white">
          <div class="w-[195mm] h-[272mm] mt-[12.5mm]" id="philhealth_form">
            <!-- FORM START -->
            <div class="border border-black w-full p-1 font-semibold">
              ANNEX G: Electronic Konsulta Availment Slip (eKAS)
            </div>

            <div class="text-xs my-5">
              Electronic Konsulta Availment Slip (eKAS) â€“ proof of availment of services by the eligible beneficiary. This will be
              generated by the PhilHealth Konsulta facility for every patient encounter and to be submitted to PhilHealth.
            </div>

            <div class="border-2 border-sky-700">
              <div class="flex align-middle h-14 p-1">
                <img src="./assets/img/philhealth_logo.png" class="w-12 h-14" />
                <span class="underline font-semibold mt-3">ELECTRONIC KONSULTA AVAILMENT SLIP (eKAS)</span>
              </div>

              <div class="p-1">
                <div class="grid grid-cols-4 text-xs">
                  <div class="col-span-2 flex">
                    <span class="text-[.75em]">HCI Name:</span>
                    <span class="underline flex-1 w-full">{{ facility?.konsulta_credential.facility_name }}</span>
                  </div>
                  <div class="col-span-2 flex">
                    <span>HCI Accreditation No:</span>
                    <span class="underline flex-1 w-full">{{ facility?.konsulta_credential.accreditation_number }}</span>
                  </div>

                  <div class="col-span-2 flex">
                    <span class="text-[.75em]">Case No.:</span>
                    <span class="underline flex-1 w-full text-[.8em]">{{ patient_info?.case_number }}</span>
                  </div>
                  <div class="col-span-2 flex">
                    <span class="text-[.75em]">Transaction No.:</span>
                    <span class="underline flex-1 w-full text-[.8em]">{{ 'S'+consult_details?.transaction_number }}</span>
                  </div>
                </div>

                <div class="grid grid-cols-4 text-xs mt-2">
                  <div class="col-span-2 flex">
                    <span class="text-[.75em]">Patient name (pangalan ng pasyente): </span>
                    <span class="underline flex-1 w-full text-[.8em]">
                      {{ patient_info?.last_name }}, {{ patient_info?.first_name }} {{ patient_info?.middle_name }} {{ patient_info?.suffix_name === 'NA' ? '' : patient_info?.suffix_name }}
                    </span>
                  </div>
                  <div class="col-span-1 flex">
                    <span class="text-[.75em]">Age (Edad): </span>
                    <span class="underline flex-1 w-full text-[.75em]">{{ patient_age }}</span>
                  </div>
                  <div class="col-span-1 flex">
                    <span class="text-[.75em]">Contact No.: </span>
                    <span class="underline flex-1 w-full text-[.8em]">{{ patient_info?.mobile_number }}</span>
                  </div>
                </div>

                <div class="grid grid-cols-4 text-xs">
                  <div class="col-span-2 flex">
                    <span class="text-[.75em]">PIN (PhilHealth Identification No.): </span>
                    <span class="underline flex-1 w-full text-[.8em]">{{ patient_philhealth?.philhealth_id }}</span>
                  </div>
                  <div class="col-span-2 flex">
                    <span class="text-[.75em]">Membership Category: </span>
                    <span class="underline flex-1 w-full text-[.8em]"> </span>
                  </div>
                </div>

                <div class="grid grid-cols-4 text-xs">
                  <div class="col-span-2 flex">
                    <span class="text-[.75em]">Membership type: </span>
                    <span class="flex-1 w-full text-[.8em]">{{ patient_philhealth?.membership_type_id === "MM" ? 'Member' : 'Dependent' }}</span>
                  </div>
                  <div class="col-span-2 flex">
                    <span class="text-[.75em]">Authorization Transaction Code (ATC):</span>
                    <span class="underline flex-1 w-full text-[.8em]">{{ consult_details?.walkedin_status === true ? 'WALKEDIN' : (consult_details?.authorization_transaction_code ? consult_details?.authorization_transaction_code : 'WALKEDIN' ) }}</span>
                  </div>
                </div>
              </div>

              <div class="w-full border border-black bg-gray-300 text-xs my-5 p-1 py-0">
                To be filled out by the facility (pupunuan ng pasilidad)
              </div>

              <div class="w-full text-xs">
                <table class="border border-slate-600 border-collapse mx-1">
                  <thead>
                    <tr>
                      <th class="w-4/12 border border-slate-700 text-[.8em]">Konsulta Services</th>
                      <th class="w-2/12 border border-slate-700 text-[.8em]">
                        <span class="underline">&#10004;</span> Performed <span class="text-[.7em]">(nagawa)</span> <br />
                        <span class="underline">X</span> Not performed <span class="text-[.7em]">(hindi nagawa)</span> <br />
                      </th>
                      <th class="w-3/12 border border-slate-700 text-[.8em]">
                        Date Performed <br />
                        (Petsa kung kelan ginawa)
                      </th>
                      <th class="w-3/12 border border-slate-700 text-[.8em]">
                        Performed by <br />
                        (Ginawa ni) <br />
                        (Initial/Signature of Health Care Provider/Technician)<br />
                        (Initial o Lagda ng Health Care Provider/Technician)
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td class="border border-slate-700 [.8em]">History and physical examination (vitals, anthropometrics)</td>
                      <td class="border border-slate-700 text-center [.8em]">&#10004;</td>
                      <td class="border border-slate-700 [.8em]">
                        {{ consult_details.consult_date | date: 'yyyy-MM-dd' }}
                      </td>
                      <td class="border border-slate-700 [.8em]">
                        {{ consult_details.user.first_name }} {{ consult_details.user.middle_name }} {{ consult_details.user.last_name }}
                      </td>
                    </tr>
                    <tr *ngFor="let lab of lab_list">
                      <td class="border border-slate-700 [.8em]">{{ lab.laboratory.desc }}</td>
                      <td class="border border-slate-700 text-center [.8em]">
                        {{ lab.result ? '&#10004;' : 'X'}}
                      </td>

                      <td class="border border-slate-700 [.8em]">
                        {{ lab.result ? lab.result.laboratory_date : '-' }}
                      </td>
                      <td class="border border-slate-700 [.8em]">
                        {{ lab.result ? lab.result.user : '-' }}
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <div class="w-full border border-black bg-gray-300 text-xs my-3 p-1 py-0 text-[.8em]">
                To be filled out by the patient (pupunuan ng pasyente)
              </div>

              <div class="w-full pl-1 text-xs">
                <div class="grid grid-cols-1">
                  <div class="flex text-[.8em]">
                    Have you received the above-mentioned essential services? __ Yes __ No
                  </div>
                  <div class="flex text-[.8em]">
                    (Natanggap mo ba ang mga essential services na nabanggit?)
                  </div>
                </div>

                <div class="grid grid-cols-4 mt-3">
                  <div class="col-span-2 grid grid-cols-1 text-[.8em]">
                    <span>How satisfied are you with the services provided?</span>
                    <span>(Gaano ka nasiyahan sa natanggap mong serbisyo?)</span>
                  </div>
                  <div class="col-span-2 flex">
                    <div class="w-2 h-2 border border-slate-700 mt-5 mr-2"></div>
                    <fa-icon [icon]="faFaceSmile" class="text-3xl text-green-600 mr-3"></fa-icon>

                    <div class="w-2 h-2 border border-slate-700 mt-5 mr-2"></div>
                    <fa-icon [icon]="faFaceMeh" class="text-3xl text-yellow-500 mr-3"></fa-icon>

                    <div class="w-2 h-2 border border-slate-700 mt-5 mr-2"></div>
                    <fa-icon [icon]="faFaceFrown" class="text-3xl text-red-600"></fa-icon>
                    <!-- PUT IMAGE HERE -->
                  </div>
                </div>

                <div class="grid grid-cols-1 mt-3">
                  <div class="flex text-[.8em]">
                    For your comment, suggestion or complaint:
                  </div>
                  <div class="flex text-[.8em]">
                    (Para sa iyong komento, mungkahi o reklamo)
                  </div>

                  <div class="w-full border-y border-black h-5 mt-5">

                  </div>
                </div>

                <div class="grid grid-cols-1 mt-3">
                  <div class="flex text-[.8em]">
                    Under the penalty of law, I attest that the information I provided in this slip are true and accurate.
                  </div>
                  <div class="flex text-[.8em]">
                    (Sa ilalim ng batas, pinatutunayan ko na ang impormasyong ibinigay ko ay totoo at tama)
                  </div>
                </div>
              </div>

              <div class="w-full p-1 text-xs mt-7 mb-5">
                <div class="grid grid-cols-12">
                  <div class="col-span-7 text-[.8em]">
                    ________________________________________ <br />
                    Signature over printed name of patient <br />
                    (Lagda sa nakalimbag na pangalan ng pasyente)
                  </div>
                  <div class="col-span-5 text-[.8em]">
                    Next Consultation Date: _____________________ <br />
                    (Petsa ng susunod na bigay ng gamot)
                  </div>
                </div>

                <div class="grid grid-cols-12 mt-4">
                  <div class="col-span-7 text-[.8em]">
                    Note: <br />
                    Accomplished form shall be submitted to PhilHealth <br />
                    (Ang kumpletong form ay dapat isumite sa PhilHealth)
                  </div>
                </div>
              </div>
            </div>
            <!-- FORM END -->
          </div>
        </div>


      </div>

      <div class="h-96 flex justify-center align-middle w-full" *ngIf="!show_form">
        <fa-icon [icon]="faCircleNotch" spin="true" size="2xl" class="mt-20 text-blue-500"></fa-icon>
      </div>
      <!-- Modal footer -->
      <div class="flex justify-end py-4 px-5 space-x-4 rounded-b border-t border-gray-200 dark:border-gray-600">
        <button  type="button" class="text-white bg-orange-500 hover:ring-2 focus:outline-none hover:ring-orange-300 rounded text-sm font-medium px-6 py-2.5 transition duration-150 ease-in-out transform hover:scale-110 " (click)="closeModal()">Close</button>
        <!-- <button  type="button" class="text-white bg-blue-500 hover:ring-2 focus:outline-none hover:ring-blue-300 font-medium rounded text-sm px-6 py-2.5 text-center transition duration-150 ease-in-out transform hover:scale-110" (click)="onSubmit()" >Save</button> -->
      </div>
    </div>
  </div>
</div>

<div class="opacity-50 fixed inset-0 z-50 bg-black"></div>
