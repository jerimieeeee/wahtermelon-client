<nav class="sticky top-0 z-30 bg-white">
  <div class="md:h-22 py-auto px-6 md:flex md:justify-between md:items-center">
    <div class="flex justify-between items-center">
      <a href="#">
        <img src="./assets/img/wah_icon.png" class="rounded-full w-12 h-12 mx-auto mr-5" />
      </a>

      <ng-select class="search" placeholder="search" #mySelect
        (focusout)="resetList()"
        [items]="patients$ | async"
        [minTermLength]="minLengthTerm"
        [loading]="patientLoading"
        typeToSearchText="search..."
        [typeahead]="searchInput$"
        [(ngModel)]="selectedPatient"
        (change)="onSelect(selectedPatient)"
        notFoundText="No records found"
        [clearSearchOnAdd]
        (scrollToEnd)="onScrollEnd()">
        <ng-template ng-option-tmp let-item="item" let-index="index" let-search="searchTerm">
          <div class="grid grid-flow-col auto-cols-max">
            <div class="my-auto mr-3">
              <div class="inline-flex overflow-hidden relative justify-center items-center w-14 h-14 bg-gray-100 rounded-full dark:bg-gray-600">
                <span class="font-medium text-gray-600 dark:text-gray-300">{{ getInitials(item.first_name+' '+item.last_name) }}</span>
              </div>
            </div>
            <div>
              <h5 class="text-blue-400" [ngOptionHighlight]="search">{{ item.last_name }}, {{ item.first_name }} {{ item.middle_name }} {{ item.suffix_name === 'NA' ? '' : item.suffix_name}}</h5>
              <h6 class="text-muted">{{ item.birthdate | date: 'MM/dd/yyyy':'Asia/Manila'}}</h6>
            </div>
          </div>
        </ng-template>

        <ng-template *ngIf="showCreate" ng-footer-tmp>
          <a class="text-blue-600 hover:cursor-pointer" (click)="navigateTo('registration')"> Create a new record</a>
        </ng-template>
      </ng-select>
    </div>


    <div class="md:flex items-center">
      <div class="flex flex-col md:flex-row md:mx-2 items-center">
        <a class="my-1 text-sm text-gray-700 font-medium hover:text-indigo-500 md:mx-2 md:my-0" href="#">
          <fa-icon [icon]="faHome"  size="lg"></fa-icon>
        </a>
        <a class="my-1 text-sm text-gray-700 hover:text-indigo-500 md:mx-2 md:my-0" href="#/households">
          <svg class="fill-current w-6 h-6" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
            <path d="M16,4c0-1.11,0.89-2,2-2s2,0.89,2,2s-0.89,2-2,2S16,5.11,16,4z M20,22v-6h2.5l-2.54-7.63C19.68,7.55,18.92,7,18.06,7h-0.12 c-0.86,0-1.63,0.55-1.9,1.37l-0.86,2.58C16.26,11.55,17,12.68,17,14v8H20z M12.5,11.5c0.83,0,1.5-0.67,1.5-1.5s-0.67-1.5-1.5-1.5 S11,9.17,11,10S11.67,11.5,12.5,11.5z M5.5,6c1.11,0,2-0.89,2-2s-0.89-2-2-2s-2,0.89-2,2S4.39,6,5.5,6z M7.5,22v-7H9V9 c0-1.1-0.9-2-2-2H4C2.9,7,2,7.9,2,9v6h1.5v7H7.5z M14,22v-4h1v-4c0-0.82-0.68-1.5-1.5-1.5h-2c-0.82,0-1.5,0.68-1.5,1.5v4h1v4H14z" />
          </svg>
        </a>
        <a class="my-1 text-sm text-gray-700  hover:text-indigo-500 md:mx-2 md:my-0 font-medium" routerLink="/reports">
          <fa-icon [icon]="faSquarePollVertical" size="xl"></fa-icon>
        </a>

        <a *ngIf="user.designation_code === 'MEDTECH'" class="my-1 text-sm text-gray-700  hover:text-indigo-500 md:mx-2 md:my-0 font-medium" routerLink="/lab-pending">
          <fa-icon [icon]="faFlask" size="xl"></fa-icon>
        </a>

        <a class="my-1 text-sm text-gray-700  hover:text-indigo-500 md:mx-2 md:my-0 font-medium" routerLink="/calendar">
          <fa-icon [icon]="faCalendarDay" size="xl"></fa-icon>
        </a>
        <span class="block text-2xl">
          |
        </span>
      </div>

      <div class="flex items-center">
        <!-- <a class="relative text-gray-700 hover:text-gray-600 mx-1" href="#">
          <fa-icon [icon]="faBell" [styles]="{'color': '#3B82F6'}" size="lg"></fa-icon>
          <span class="absolute top-0 left-0 rounded-full bg-red-600 text-white p-1 text-xs"></span>
        </a> -->

        <!-- <div class="flex justify-center md:block leading-tight mx-2 my-1">
          <div class="inline-flex overflow-hidden relative justify-center items-center w-14 h-14 bg-gray-100 rounded-full dark:bg-gray-600">
            <span class="font-medium text-gray-600 dark:text-gray-300">{{ getInitials(user?.first_name+' '+user?.last_name) }}</span>
          </div>
        </div> -->

        <div class="flex justify-center md:block leading-tight mx-2 my-1">

          <span class="block text-blue-500 font-medium">
            {{ user?.first_name }} {{ user?.middle_name }} {{ user?.last_name }} {{ user?.suffix_name }}
          </span>
          <span class="block text-xs font-semibold">
            {{ user?.facility.facility_name }}
          </span>
        </div>

        <div class="relative inline-block text-left">
          <div>
            <button type="button" (click)="toggleMenu()" class="rounded-full inline-flex w-full justify-center border border-gray-300 bg-white text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-100 items-center" id="menu-button" aria-expanded="true" aria-haspopup="true">

              <svg class="m-1 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
              </svg>
            </button>
          </div>

          <div *ngIf="showMenu" class="absolute right-0 z-10 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none" role="menu" aria-orientation="vertical" aria-labelledby="menu-button" tabindex="-1">
            <div class="py-1 " role="none" (blur)="toggleMenu()" >
              <button *ngFor="let menu of user_menu" (click)="navigateTo(menu.location)" class="text-left w-full text-gray-700 block px-4 py-2 text-sm hover:bg-gray-100 hover:text-gray-900" role="menuitem" tabindex="-1" id="menu-item-0">
                <fa-icon [icon]="menu.icon"></fa-icon>
                {{ menu.name }}
              </button>

              <button type="button" class="text-left w-full text-gray-700 block px-4 py-2 text-sm hover:bg-gray-100 hover:text-gray-900" (click)="logout()" role="menuitem" tabindex="-1" id="menu-item-2">
                <fa-icon [icon]="faRightFromBracket"></fa-icon>
                Sign out
              </button>
            </div>
          </div>
        </div>


        <div class="flex md:hidden">
          <button type="button" class="text-gray-500 hover:text-gray-600 focus:outline-none focus:text-gray-600" aria-label="toggle menu">
            <svg viewBox="0 0 24 24" class="h-6 w-6 fill-current">
              <path fill-rule="evenodd" d="M4 5h16a1 1 0 0 1 0 2H4a1 1 0 1 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2z"></path>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>
</nav>
