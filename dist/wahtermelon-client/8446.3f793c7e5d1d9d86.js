"use strict";(self.webpackChunkwahtermelon_client=self.webpackChunkwahtermelon_client||[]).push([[8446],{8446:(Y,g,r)=>{r.r(g),r.d(g,{FeedbackModule:()=>U});var u=r(6814),d=r(3602),l=r(590),e=r(5879),m=r(265),a=r(6223),_=r(5597),x=r(1449),p=r(6321),h=r(4825),b=r(8180);function w(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",18),e.NdJ("click",function(){const c=e.CHM(t).$implicit,f=e.oxw(3);return e.KtG(f.logScore(c))}),e._UZ(1,"fa-icon",19),e.qZA()}if(2&n){const t=s.$implicit,o=e.oxw(3);e.xp6(1),e.Tol(o.feedback_answers[o.question_list[o.question_index].column_name]&&o.feedback_answers[o.question_list[o.question_index].column_name]===t&&(1===t?"text-white bg-red-500":2===t?"text-white bg-yellow-500":"text-white bg-green-600")),e.Q6J("icon",1===t?o.faFaceFrown:2===t?o.faFaceMeh:o.faFaceLaughBeam)}}function y(n,s){if(1&n&&(e.TgZ(0,"div",16),e.YNc(1,w,2,3,"button",17),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.question_score)}}function F(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",16)(1,"textarea",20),e.NdJ("ngModelChange",function(i){e.CHM(t);const c=e.oxw(2);return e.KtG(c.feedback_answers.remarks=i)}),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngModel",t.feedback_answers.remarks)}}function k(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",4),e._uU(2," Client Feedback "),e.qZA(),e.TgZ(3,"div",5)(4,"div",6)(5,"div",7),e._uU(6),e.qZA(),e.YNc(7,y,2,1,"div",8),e.YNc(8,F,2,1,"div",9),e.qZA(),e.TgZ(9,"div",10)(10,"button",11),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.previousQuestion())}),e._UZ(11,"fa-icon",12),e._uU(12," Previous "),e.qZA(),e.TgZ(13,"div",13),e._uU(14),e.qZA(),e.TgZ(15,"button",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.question_index===i.question_length-1?i.onSubmit():i.nextQuestion())}),e._uU(16),e._UZ(17,"fa-icon",15),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.hij(" ",t.question_list[t.question_index].question," "),e.xp6(1),e.Q6J("ngIf","remarks"!==t.question_list[t.question_index].column_name),e.xp6(1),e.Q6J("ngIf","remarks"===t.question_list[t.question_index].column_name),e.xp6(2),e.Q6J("disabled",0===t.question_index),e.xp6(1),e.Q6J("icon",t.faArrowLeft),e.xp6(3),e.AsE(" ",t.question_index+1,"/",t.question_length," "),e.xp6(1),e.Q6J("disabled",t.is_saving)("disabled",!t.feedback_answers[t.question_list[t.question_index].column_name]&&"remarks"!==t.question_list[t.question_index].column_name),e.xp6(1),e.hij(" ",t.question_index===t.question_length-1?t.is_saving?"Saving":"Submit":"Next"," "),e.xp6(1),e.Q6J("icon",t.question_index===t.question_length-1?t.is_saving?t.faCircleNotch:t.faSave:t.faArrowRight)("spin",t.is_saving)}}function C(n,s){if(1&n&&(e.TgZ(0,"div",21)(1,"span"),e._uU(2,"Maraming salamat sa iyong kooperasayon. "),e._UZ(3,"br"),e._uU(4),e.qZA()()),2&n){const t=e.oxw();e.xp6(4),e.hij(" Redirecting in ",t.countdown," secs")}}function Z(n,s){if(1&n&&(e.TgZ(0,"div",22)(1,"div",23),e._UZ(2,"fa-icon",15),e.qZA(),e.TgZ(3,"div",24),e._uU(4," Loading questions... "),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("icon",t.faCircleNotch)("spin",!0)}}let q=(()=>{var n;class s{onSubmit(){this.is_saving=!0,this.http.post("consultation/feedback",this.feedback_answers).subscribe({next:o=>{console.log(o),this.survey_completed=!0,this.is_saving=!1,this.startCountdown()},error:o=>{this.http.showError(o.error.message,"Consult Feedback")}})}startCountdown(){(function v(n=0,s=p.z){return n<0&&(n=0),(0,h.H)(n,n,s)})(1e3).pipe((0,b.q)(5)).subscribe({next:i=>{this.countdown=5-(i+1)},complete:()=>{this.toggleSurveyForm.emit()}})}logScore(o){this.feedback_answers[this.question_list[this.question_index].column_name]=o}previousQuestion(){this.question_index-=1}nextQuestion(){this.question_index+=1}loadLibraries(){this.http.get("libraries/feedback-question").subscribe({next:o=>{console.log(o.data),this.question_list=o.data,this.question_length=Object.keys(this.question_list).length,this.show_form=!0},error:o=>{this.http.showError(o.error.message,"Feedback Questions")}})}constructor(o,i){this.http=o,this.router=i,this.toggleSurveyForm=new e.vpe,this.faCircleNotch=l.IJ7,this.faSave=x.r6l,this.faArrowRight=l.eFW,this.faArrowLeft=l.acZ,this.faFaceFrown=l.qfV,this.faFaceLaughBeam=l.Flz,this.faFaceMeh=l.FRD,this.countdown=5,this.show_form=!1,this.question_length=0,this.question_index=0,this.question_score=[1,2,3],this.survey_completed=!1,this.is_saving=!1}ngOnInit(){this.feedback_answers={consult_id:this.consultationId,overall_score:null,cleanliness_score:null,behavior_score:null,time_score:null,quality_score:null,completeness_score:null,remarks:null},this.loadLibraries()}}return(n=s).\u0275fac=function(o){return new(o||n)(e.Y36(m.O),e.Y36(d.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-survey-form"]],inputs:{consultationId:"consultationId"},outputs:{toggleSurveyForm:"toggleSurveyForm"},decls:3,vars:3,consts:[["class","flex flex-col w-auto h-5/6 m-10 border border-gray-100 shadow-lg rounded-2xl",4,"ngIf"],["class","flex flex-col w-full h-full justify-center items-center text-center text-3xl bg-blue-500 font-semibold text-white",4,"ngIf"],["class","grid grid-cols-1 w-full my-24 text-center text-3xl",4,"ngIf"],[1,"flex","flex-col","w-auto","h-5/6","m-10","border","border-gray-100","shadow-lg","rounded-2xl"],[1,"bg-blue-500","h-16","text-2xl","p-4","font-semibold","text-white","uppercase","rounded-t-2xl"],[1,"flex","flex-col","h-full"],[1,"flex-grow","grid","grid-cols-1","mb-10","mx-10"],[1,"text-3xl","font-semibold","text-center","my-auto"],["class","grid grid-cols-3",4,"ngIf"],["class","grid grid-cols-3 ",4,"ngIf"],[1,"grid","grid-cols-3","m-10"],[1,"bg-gray-300","text-gray-500","rounded-md","h-16","disabled:opacity-25","text-xl",3,"disabled","click"],[3,"icon"],[1,"text-2xl","text-center","mt-3"],[1,"bg-blue-500","text-white","rounded-md","h-16","text-xl","disabled:opacity-25",3,"disabled","click"],[3,"icon","spin"],[1,"grid","grid-cols-3"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"text-8xl","px-10","py-6","rounded-2xl","text-gray-100","bg-gray-300",3,"icon"],[1,"input","col-span-3","text-xl",3,"ngModel","ngModelChange"],[1,"flex","flex-col","w-full","h-full","justify-center","items-center","text-center","text-3xl","bg-blue-500","font-semibold","text-white"],[1,"grid","grid-cols-1","w-full","my-24","text-center","text-3xl"],[1,"flex","justify-center","text-blue-500"],[1,"flex","justify-center"]],template:function(o,i){1&o&&(e.YNc(0,k,18,12,"div",0),e.YNc(1,C,5,1,"div",1),e.YNc(2,Z,5,2,"div",2)),2&o&&(e.Q6J("ngIf",i.show_form&&!i.survey_completed),e.xp6(1),e.Q6J("ngIf",i.show_form&&i.survey_completed),e.xp6(1),e.Q6J("ngIf",!i.show_form))},dependencies:[u.sg,u.O5,a.Fj,a.JJ,a.On,_.BN]}),s})();function T(n,s){1&n&&(e.TgZ(0,"span"),e._uU(1,"Invalid input, or visit already has recorded feedback."),e.qZA())}function I(n,s){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t)}}function J(n,s){if(1&n&&e._UZ(0,"fa-icon",16),2&n){const t=e.oxw(3);e.Q6J("icon",t.faArrowLeft)}}function S(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){const c=e.CHM(t).$implicit,f=e.oxw(2);return e.KtG(f.concat(c))}),e.YNc(1,I,2,1,"span",12),e.YNc(2,J,1,1,"fa-icon",15),e.qZA()}if(2&n){const t=s.$implicit;e.Tol("clear"===t?"bg-rose-500":"bg-sky-500"),e.xp6(1),e.Q6J("ngIf","delete"!==t),e.xp6(1),e.Q6J("ngIf","delete"===t)}}function A(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",2)(1,"div",3)(2,"a",4),e._UZ(3,"img",5),e.qZA()(),e.TgZ(4,"div",6)(5,"div",7),e._UZ(6,"input",8),e.TgZ(7,"input",9),e.NdJ("ngModelChange",function(i){e.CHM(t);const c=e.oxw();return e.KtG(c.consultationId=i)}),e.qZA(),e.TgZ(8,"button",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.checkVisitFeedback())}),e._uU(9," OK "),e.qZA()(),e.TgZ(10,"div",11),e.YNc(11,T,2,0,"span",12),e.qZA(),e.YNc(12,S,3,4,"button",13),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(7),e.Q6J("ngModel",t.consultationId),e.xp6(4),e.Q6J("ngIf",t.show_invalid),e.xp6(1),e.Q6J("ngForOf",t.numbers)}}function M(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"app-survey-form",17),e.NdJ("toggleSurveyForm",function(i){e.CHM(t);const c=e.oxw();return e.KtG(c.toggleSurveyForm(i))}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("consultationId",t.consultationId)}}const N=[{path:"",component:(()=>{var n;class s{concat(o){"number"==typeof o&&(this.consultationId=this.consultationId+""+o),"delete"===o&&(this.consultationId=this.consultationId.substring(0,this.consultationId.length-1)),"clear"===o&&(this.consultationId="")}checkVisitFeedback(){this.show_invalid=!1,this.show_survey=!1,this.http.get("consultation/records/"+this.consultationId).subscribe({next:o=>{o.for_feedback?this.show_survey=!0:this.show_invalid=!0},error:()=>{this.show_invalid=!0}})}toggleSurveyForm(){console.log("test"),this.consultationId="",this.show_survey=!1}constructor(o){this.http=o,this.faArrowLeft=l.acZ,this.numbers=[1,2,3,4,5,6,7,8,9,"delete",0,"clear"],this.consultationId="",this.show_survey=!1,this.show_invalid=!1}}return(n=s).\u0275fac=function(o){return new(o||n)(e.Y36(m.O))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-feedback"]],decls:2,vars:2,consts:[["class","grid grid-cols-1 gap-5 h-dvh",4,"ngIf"],[3,"consultationId","toggleSurveyForm",4,"ngIf"],[1,"grid","grid-cols-1","gap-5","h-dvh"],[1,"flex","justify-center","align-middle"],["routerLink","/"],["src","./assets/img/wah_icon.png",1,"rounded-full","w-32","h-32","mx-auto"],[1,"grid","grid-cols-3","gap-6","h-5/6","font-semibold","mx-20"],[1,"col-span-3","flex","mb-5"],["type","text","placeholder","Visit No.","disabled","",1,"w-1/5","text-center","rounded-l-lg","text-2xl","disabled:bg-gray-200"],["type","text","readonly","",1,"w-full","text-center","text-4xl",3,"ngModel","ngModelChange"],[1,"bg-sky-500","rounded-r-lg","h-full","w-28","text-white","text-2xl",3,"click"],[1,"text-red-500","col-span-3","flex","justify-center","h-8"],[4,"ngIf"],["class","border-2 rounded-lg text-white w-full h-full text-center text-4xl py-5",3,"class","click",4,"ngFor","ngForOf"],[1,"border-2","rounded-lg","text-white","w-full","h-full","text-center","text-4xl","py-5",3,"click"],[3,"icon",4,"ngIf"],[3,"icon"],[3,"consultationId","toggleSurveyForm"]],template:function(o,i){1&o&&(e.YNc(0,A,13,3,"div",0),e.YNc(1,M,1,1,"app-survey-form",1)),2&o&&(e.Q6J("ngIf",!i.show_survey),e.xp6(1),e.Q6J("ngIf",i.show_survey))},dependencies:[u.sg,u.O5,d.rH,a.Fj,a.JJ,a.On,_.BN,q]}),s})()}];let Q=(()=>{var n;class s{}return(n=s).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[d.Bz.forChild(N),d.Bz]}),s})(),U=(()=>{var n;class s{}return(n=s).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[u.ez,Q,a.u5,_.uH]}),s})()}}]);