"use strict";(self.webpackChunkwahtermelon_client=self.webpackChunkwahtermelon_client||[]).push([[813],{1813:(W,f,_)=>{_.r(f),_.d(f,{FacilityConfigModule:()=>R});var d=_(6814),b=_(3602),g=_(590),t=_(5879),u=_(265),m=_(2425),r=_(6223),p=_(5597),h=_(1449);function y(a,i){if(1&a&&(t.TgZ(0,"option",14),t._uU(1),t.qZA()),2&a){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function C(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"tr",22)(1,"td",23)(2,"span",24),t._uU(3),t.qZA(),t._UZ(4,"br"),t.TgZ(5,"span",25),t._uU(6),t.qZA()(),t.TgZ(7,"td",26),t._uU(8),t.qZA(),t.TgZ(9,"td")(10,"input",27),t.NdJ("ngModelChange",function(n){const c=t.CHM(e).index,l=t.oxw(3);return t.KtG(l.catchment_barangays[l.selected_year].data[c].population=n)}),t.qZA()(),t.TgZ(11,"td")(12,"input",27),t.NdJ("ngModelChange",function(n){const c=t.CHM(e).index,l=t.oxw(3);return t.KtG(l.catchment_barangays[l.selected_year].data[c].population_opt=n)}),t.qZA()(),t.TgZ(13,"td")(14,"input",27),t.NdJ("ngModelChange",function(n){const c=t.CHM(e).index,l=t.oxw(3);return t.KtG(l.catchment_barangays[l.selected_year].data[c].population_wra=n)}),t.qZA()(),t.TgZ(15,"td")(16,"input",27),t.NdJ("ngModelChange",function(n){const c=t.CHM(e).index,l=t.oxw(3);return t.KtG(l.catchment_barangays[l.selected_year].data[c].household=n)}),t.qZA()()()}if(2&a){const e=i.$implicit,o=i.index,n=t.oxw(3);t.xp6(3),t.Oqu(e.barangay.name),t.xp6(3),t.hij("(",e.barangay.code,")"),t.xp6(2),t.Oqu(e.year),t.xp6(2),t.Q6J("ngModel",n.catchment_barangays[n.selected_year].data[o].population),t.xp6(2),t.Q6J("ngModel",n.catchment_barangays[n.selected_year].data[o].population_opt),t.xp6(2),t.Q6J("ngModel",n.catchment_barangays[n.selected_year].data[o].population_wra),t.xp6(2),t.Q6J("ngModel",n.catchment_barangays[n.selected_year].data[o].household)}}function x(a,i){1&a&&(t.TgZ(0,"tr")(1,"td",28),t._uU(2,"No records to show"),t.qZA()())}function Z(a,i){if(1&a&&(t.TgZ(0,"tbody"),t.YNc(1,C,17,7,"tr",21),t.YNc(2,x,3,0,"tr",20),t.qZA()),2&a){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.catchment_barangays[e.selected_year].data),t.xp6(1),t.Q6J("ngIf",0===e.catchment_barangays[e.selected_year].data.length)}}function T(a,i){if(1&a&&(t.TgZ(0,"table",15)(1,"thead")(2,"tr",16)(3,"th",17),t._uU(4,"BRGY NAME "),t._UZ(5,"br"),t._uU(6,"(CODE)"),t.qZA(),t.TgZ(7,"th",18),t._uU(8,"YEAR"),t.qZA(),t.TgZ(9,"th",19),t._uU(10,"POPULATION"),t.qZA(),t.TgZ(11,"th",19),t._uU(12,"OPT"),t.qZA(),t.TgZ(13,"th",19),t._uU(14,"WRA"),t.qZA(),t.TgZ(15,"th",19),t._uU(16,"HOUSEHOLD"),t.qZA()()(),t.YNc(17,Z,3,2,"tbody",20),t.qZA()),2&a){const e=t.oxw();t.xp6(17),t.Q6J("ngIf",e.catchment_barangays[e.selected_year])}}function v(a,i){if(1&a&&(t.TgZ(0,"div",29)(1,"div",30),t._UZ(2,"fa-icon",31),t.qZA(),t.TgZ(3,"div",32),t._uU(4," Loading... "),t.qZA()()),2&a){const e=t.oxw();t.xp6(2),t.Q6J("icon",e.faCircleNotch)}}function A(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"div",33)(1,"button",34),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.onSubmit())}),t._UZ(2,"fa-icon",35),t._uU(3),t.qZA()()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("disabled",e.is_saving||!e.show_form),t.xp6(1),t.Q6J("icon",e.is_saving?e.faCircleNotch:e.faSave)("spin",e.is_saving),t.xp6(1),t.hij(" ",e.is_saving?"Updating":"Update"," ")}}function w(a,i){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&a){const e=i.$implicit,o=i.last;t.xp6(1),t.AsE(" ",e.barangay.name,"",o?"":", "," ")}}function q(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"fa-icon",42),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,s=t.oxw(2);return t.KtG(s.editPop(n.key))}),t.qZA()}if(2&a){const e=t.oxw(3);t.Q6J("icon",e.faEdit)}}function J(a,i){if(1&a&&(t.TgZ(0,"tr",22)(1,"td",23)(2,"span",24),t._uU(3),t.qZA(),t._UZ(4,"br"),t.qZA(),t.TgZ(5,"td",26),t._uU(6),t.qZA(),t.TgZ(7,"td",26),t._uU(8),t.qZA(),t.TgZ(9,"td",26),t._uU(10),t.qZA(),t.TgZ(11,"td",26),t._uU(12),t.qZA(),t.TgZ(13,"td"),t.YNc(14,w,2,2,"span",40),t.qZA(),t.TgZ(15,"td",26),t.YNc(16,q,1,1,"fa-icon",41),t.qZA()()),2&a){const e=i.$implicit,o=t.oxw(2);t.xp6(3),t.Oqu(e.key),t.xp6(3),t.Oqu(e.value.total_population),t.xp6(2),t.Oqu(e.value.total_population_opt),t.xp6(2),t.Oqu(e.value.total_population_wra),t.xp6(2),t.Oqu(e.value.total_household),t.xp6(2),t.Q6J("ngForOf",e.value.data),t.xp6(2),t.Q6J("ngIf",o.selected_year!==e.key)}}function F(a,i){if(1&a&&(t.TgZ(0,"table",15)(1,"thead")(2,"tr",36)(3,"th",37),t._uU(4,"YEAR"),t.qZA(),t.TgZ(5,"th",37),t._uU(6,"POPULATION"),t.qZA(),t.TgZ(7,"th",37),t._uU(8,"OPT"),t.qZA(),t.TgZ(9,"th",37),t._uU(10,"WRA"),t.qZA(),t.TgZ(11,"th",37),t._uU(12,"HOUSEHOLD"),t.qZA(),t.TgZ(13,"th",38),t._uU(14,"BARANGAY LIST"),t.qZA(),t.TgZ(15,"th",39),t._uU(16,"ACTION"),t.qZA()()(),t.TgZ(17,"tbody"),t.YNc(18,J,17,7,"tr",21),t.ALo(19,"keyvalue"),t.qZA()()),2&a){const e=t.oxw();t.xp6(18),t.Q6J("ngForOf",t.lcZ(19,1,e.catchment_population))}}function N(a,i){if(1&a&&(t.TgZ(0,"div",43)(1,"div",44),t._UZ(2,"fa-icon",31),t.qZA(),t.TgZ(3,"div",32),t._uU(4," Loading... "),t.qZA()()),2&a){const e=t.oxw();t.xp6(2),t.Q6J("icon",e.faCircleNotch)}}let U=(()=>{var a;class i{onSubmit(){this.is_saving=!0,this.http.post("settings/catchment-barangay",{year:this.selected_year,barangay:this.catchment_barangays[this.selected_year].data}).subscribe({next:n=>{this.toastr.success("Successfully recorded","Population"),this.is_saving=!1,this.updateData()},error:n=>console.log(n)})}editPop(o){this.selected_year!==o&&(this.selected_year=o,this.reloadData())}updateData(){this.show_pop=!1,this.getPopulations()}reloadData(){this.show_form=!1,this.getCatchmentBarangay.emit(this.selected_year)}getPopulations(){this.show_pop=!1,this.http.get("settings/catchment-barangay").subscribe({next:o=>{this.catchment_population=o,this.show_pop=!0},error:o=>console.log(o)})}constructor(o,n){this.http=o,this.toastr=n,this.getCatchmentBarangay=new t.vpe,this.faSave=h.r6l,this.faCircleNotch=g.IJ7,this.faEdit=h.Xcf,this.years=[],this.barangay_pop=[],this.is_saving=!1,this.show_form=!1,this.show_pop=!1}ngOnChanges(o){this.catchment_barangays&&(this.show_form=!0)}ngOnInit(){this.selected_year=this.current_year,this.getPopulations();for(let o=Number(this.current_year);o>2017;o--)this.years.push(o)}}return(a=i).\u0275fac=function(o){return new(o||a)(t.Y36(u.O),t.Y36(m._W))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-catchment-population"]],inputs:{catchment_barangays:"catchment_barangays",current_year:"current_year"},outputs:{getCatchmentBarangay:"getCatchmentBarangay"},features:[t.TTD],decls:18,vars:7,consts:[[1,"grid","grid-cols-1","mt-5"],[1,"mb-5","border","border-slate-200","shadow-md","rounded-xl"],[1,"bg-blue-500","rounded-t-xl","p-3","text-white","font-semibold","flex","justify-between"],[1,"pt-1"],["name","selected_year","id","selected_year",1,"border","border-slate","rounded-md","text-sm","py-1","text-gray-800","w-28",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[1,"h-[400px]","overflow-y-auto","overflow-x-auto"],["class","table-fixed w-full",4,"ngIf"],["class","grid grid-cols-1 mt-20",4,"ngIf"],["class","rounded-b-xl p-3 text-end border-t border-slate-300",4,"ngIf"],[1,"border","border-slate-200","shadow-md","rounded-xl"],[1,"bg-blue-500","rounded-t-xl","p-3","text-white","font-semibold"],[1,"overflow-y-auto","overflow-x-auto"],["class","grid grid-cols-1 my-20",4,"ngIf"],[3,"value"],[1,"table-fixed","w-full"],[1,"border-b","border-slate-200","bg-gray-100","text-xs","sticky","top-0"],[1,"w-36","h-12"],[1,"w-24"],[1,"w-36"],[4,"ngIf"],["class","mb-2 border-b border-slate-100",4,"ngFor","ngForOf"],[1,"mb-2","border-b","border-slate-100"],[1,"px-3","text-center"],[1,"font-semibold"],[1,"italic"],[1,"text-center"],["type","number",1,"input",3,"ngModel","ngModelChange"],["colspan","6",1,"text-center","italic","py-5"],[1,"grid","grid-cols-1","mt-20"],[1,"flex","justify-center","text-blue-500","text-xl"],["spin","true",3,"icon"],[1,"flex","justify-center"],[1,"rounded-b-xl","p-3","text-end","border-t","border-slate-300"],["type","button",1,"btn-save",3,"disabled","click"],[1,"pr-2",3,"icon","spin"],[1,"border-b","border-slate-200","bg-gray-100","text-xs"],[1,"w-20"],[1,"w-44"],[1,"w-12"],[4,"ngFor","ngForOf"],["class","text-orange-500 hover:cursor-pointer",3,"icon","click",4,"ngIf"],[1,"text-orange-500","hover:cursor-pointer",3,"icon","click"],[1,"grid","grid-cols-1","my-20"],[1,"flex","justify-center","text-blue-500"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t._uU(4,"Update Population"),t.qZA(),t.TgZ(5,"div")(6,"select",4),t.NdJ("ngModelChange",function(c){return n.selected_year=c})("change",function(){return n.reloadData()}),t.YNc(7,y,2,2,"option",5),t.qZA()()(),t.TgZ(8,"div",6),t.YNc(9,T,18,1,"table",7),t.YNc(10,v,5,1,"div",8),t.qZA(),t.YNc(11,A,4,4,"div",9),t.qZA(),t.TgZ(12,"div",10)(13,"div",11),t._uU(14," Catchment Population "),t.qZA(),t.TgZ(15,"div",12),t.YNc(16,F,20,3,"table",7),t.YNc(17,N,5,1,"div",13),t.qZA()()()),2&o&&(t.xp6(6),t.Q6J("ngModel",n.selected_year),t.xp6(1),t.Q6J("ngForOf",n.years),t.xp6(2),t.Q6J("ngIf",n.show_form),t.xp6(1),t.Q6J("ngIf",!n.show_form),t.xp6(1),t.Q6J("ngIf",n.catchment_barangays[n.selected_year]&&n.catchment_barangays[n.selected_year].data.length>0),t.xp6(5),t.Q6J("ngIf",n.show_pop),t.xp6(1),t.Q6J("ngIf",!n.show_pop))},dependencies:[d.sg,d.O5,r.YN,r.Kr,r.Fj,r.wV,r.EJ,r.JJ,r.On,p.BN,d.Nd]}),i})();var M=_(9315);function O(a,i){if(1&a&&(t.TgZ(0,"option",25),t._uU(1),t.qZA()),2&a){const e=i.$implicit;t.Q6J("value",e.id),t.xp6(1),t.AsE("",e.last_name,", ",e.first_name,"")}}function Q(a,i){if(1&a&&(t.TgZ(0,"option",25),t._uU(1),t.qZA()),2&a){const e=i.$implicit;t.Q6J("value",e.barangay.code),t.xp6(1),t.Oqu(e.barangay.name)}}function B(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"div",26)(1,"input",27),t.NdJ("ngModelChange",function(n){const c=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.selected_barangays[c.id]=n)}),t.qZA(),t.TgZ(2,"label",28),t._uU(3),t.qZA()()}if(2&a){const e=i.$implicit,o=t.oxw();t.xp6(1),t.Q2q("id","selected_barangays",e.id,""),t.Q6J("ngModel",o.selected_barangays[e.id]),t.xp6(1),t.Q2q("for","selected_barangays",e.id,""),t.xp6(1),t.Oqu(e.barangay.name)}}function P(a,i){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&a){const e=i.$implicit;t.xp6(1),t.hij("",e.barangay.name,", ")}}function I(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"tr",29)(1,"td",30),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t.YNc(8,P,2,1,"span",31),t.qZA(),t.TgZ(9,"td",32)(10,"fa-icon",33),t.NdJ("click",function(){const s=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.editBhs(s))}),t.qZA()()()}if(2&a){const e=i.$implicit,o=t.oxw();t.xp6(2),t.hij(" ",e.bhs_name," "),t.xp6(2),t.AsE(" ",e.assigned_user.last_name,", ",e.assigned_user.first_name," "),t.xp6(2),t.hij(" ",e.barangay.name," "),t.xp6(2),t.Q6J("ngForOf",e.bhs_barangay),t.xp6(2),t.Q6J("icon",o.faEdit)}}let Y=(()=>{var a;class i{editBhs(o){this.bhs=o,this.bhs.assigned_user_id=o.assigned_user.id,this.bhs.barangay_code=o.barangay.code,Object.entries(o.bhs_barangay).forEach(([n,s],c)=>{this.selected_barangays[s.id]=!0})}onSubmit(){this.is_loading=!0;let o=[];if(Object.entries(this.selected_barangays).forEach(([n,s],c)=>{s&&o.push({settings_catchment_barangay_id:n})}),o.length>0){let n;this.bhs.barangay=o,n=this.bhs.id?this.http.update("settings/bhs/",this.bhs.id,this.bhs):this.http.post("settings/bhs",this.bhs),n.subscribe({next:()=>{this.toastr.success("Successfully recorded","BHS"),this.loadData()},error:s=>console.log(s)})}else this.is_loading=!1}loadData(){const o=this.http.get("settings/bhs"),n=this.http.get("users",{params:{facility_code:this.facility_code}});(0,M.D)([o,n]).subscribe({next:([s,c])=>{this.facility_bhs=s.data,this.rhu_staffs=c.data,this.is_loading=!1},error:s=>console.log(s)})}getStaff(){this.http.get("users",{params:{facility_code:this.facility_code}}).subscribe({next:o=>{this.rhu_staffs=o.data},error:o=>console.log(o)})}constructor(o,n){this.http=o,this.toastr=n,this.faSave=h.r6l,this.faCircleNotch=g.IJ7,this.faEdit=h.Xcf,this.faTrashCan=g.Vui,this.living_arrangements=[],this.is_loading=!1,this.bhs={id:null,assigned_user_id:null,bhs_name:null,barangay_code:null,barangay:[]},this.selected_barangays=[],this.rhu_staffs=[],this.facility_bhs=[]}ngOnInit(){this.loadData()}}return(a=i).\u0275fac=function(o){return new(o||a)(t.Y36(u.O),t.Y36(m._W))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-catchment-bhs"]],inputs:{catchment_barangays:"catchment_barangays",facility_code:"facility_code",selected_year:"selected_year"},decls:43,vars:11,consts:[[1,"grid","grid-cols-6","gap-5","mt-5"],[1,"col-span-2","grid","grid-cols-1","border","border-slate-200","shadow-md","rounded-lg","p-5"],["for","bhs_name",1,"font-semibold"],["type","text","name","bhs_name","id","bhs_name",1,"input",3,"ngModel","ngModelChange"],[1,"mt-5"],["for","selected_staff",1,"font-semibold"],["name","selected_staff","id","selected_staff",1,"input",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["for","brgy_location",1,"font-semibold"],["name","brgy_location","id","brgy_location",1,"input",3,"ngModel","ngModelChange"],[1,"my-5"],[1,"font-semibold"],["class","ml-5",4,"ngFor","ngForOf"],[1,"text-end","border-t","border-slate-300","p-3","-mx-5","-mb-5"],["type","button",1,"btn-save",3,"disabled","click"],[1,"pr-2",3,"icon","spin"],[1,"col-span-4","border","border-slate-200","shadow-md","rounded-lg"],[1,"p-3","text-white","rounded-t-lg","bg-blue-500"],[1,"overflow-y-auto","overflow-x-auto","h-[500px]"],[1,"table-fixed","w-full"],[1,"border-b","border-slate-200","bg-gray-100","text-xs","sticky","top-0"],[1,"w-36","h-12"],[1,"w-24"],[1,"w-36"],["class","mb-2 border-b border-slate-100",4,"ngFor","ngForOf"],[3,"value"],[1,"ml-5"],["type","checkbox",1,"input-checkbox","mr-3",3,"ngModel","ngModelChange"],[1,"select-none"],[1,"mb-2","border-b","border-slate-100"],[1,"pl-2","align-top"],[4,"ngFor","ngForOf"],[1,"text-center"],[1,"text-orange-500","pr-5","hover:cursor-pointer",3,"icon","click"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div")(3,"label",2),t._uU(4,"BHS Name"),t.qZA(),t.TgZ(5,"input",3),t.NdJ("ngModelChange",function(c){return n.bhs.bhs_name=c}),t.qZA()(),t.TgZ(6,"div",4)(7,"label",5),t._uU(8,"Assigned Midwife/Staff"),t.qZA(),t.TgZ(9,"select",6),t.NdJ("ngModelChange",function(c){return n.bhs.assigned_user_id=c}),t.YNc(10,O,2,3,"option",7),t.qZA()(),t.TgZ(11,"div",4)(12,"label",8),t._uU(13,"BHS Location"),t.qZA(),t.TgZ(14,"select",9),t.NdJ("ngModelChange",function(c){return n.bhs.barangay_code=c}),t.YNc(15,Q,2,2,"option",7),t.qZA()(),t.TgZ(16,"div",10)(17,"div",11),t._uU(18,"Catchment Barangay"),t.qZA(),t.YNc(19,B,4,4,"div",12),t.qZA(),t.TgZ(20,"div",13)(21,"button",14),t.NdJ("click",function(){return n.onSubmit()}),t._UZ(22,"fa-icon",15),t._uU(23),t.qZA()()(),t.TgZ(24,"div",16)(25,"div",17),t._uU(26," Barangay Health Stations "),t.qZA(),t.TgZ(27,"div",18)(28,"table",19)(29,"thead")(30,"tr",20)(31,"th",21),t._uU(32,"BHS NAME"),t.qZA(),t.TgZ(33,"th",22),t._uU(34,"ASSIGNED STAFF"),t.qZA(),t.TgZ(35,"th",23),t._uU(36,"BHS LOCATION"),t.qZA(),t.TgZ(37,"th",23),t._uU(38,"CATCHMENT BARANGAY"),t.qZA(),t.TgZ(39,"th",23),t._uU(40,"ACTION"),t.qZA()()(),t.TgZ(41,"tbody"),t.YNc(42,I,11,6,"tr",24),t.qZA()()()()()),2&o&&(t.xp6(5),t.Q6J("ngModel",n.bhs.bhs_name),t.xp6(4),t.Q6J("ngModel",n.bhs.assigned_user_id),t.xp6(1),t.Q6J("ngForOf",n.rhu_staffs),t.xp6(4),t.Q6J("ngModel",n.bhs.barangay_code),t.xp6(1),t.Q6J("ngForOf",n.catchment_barangays[n.selected_year].data),t.xp6(4),t.Q6J("ngForOf",n.catchment_barangays[n.selected_year].data),t.xp6(2),t.Q6J("disabled",n.is_loading),t.xp6(1),t.Q6J("icon",n.is_loading?n.faCircleNotch:n.faSave)("spin",n.is_loading),t.xp6(1),t.hij(" ",n.is_loading?n.bhs.id?"Updating":"Saving":n.bhs.id?"Update":"Save"," "),t.xp6(19),t.Q6J("ngForOf",n.facility_bhs))},dependencies:[d.sg,r.YN,r.Kr,r.Fj,r.Wl,r.EJ,r.JJ,r.On,p.BN]}),i})();function S(a,i){if(1&a&&(t.TgZ(0,"option",15),t._uU(1),t.qZA()),2&a){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function E(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"div",19)(1,"input",20),t.NdJ("ngModelChange",function(n){const c=t.CHM(e).$implicit,l=t.oxw(3);return t.KtG(l.selected_catchment[c.code]=n)}),t.qZA(),t.TgZ(2,"label",21),t._uU(3),t.qZA()()}if(2&a){const e=i.$implicit,o=t.oxw(3);t.xp6(1),t.Q2q("id","selected_catchment",e.code,""),t.Q6J("ngModel",o.selected_catchment[e.code]),t.xp6(1),t.Q2q("for","selected_catchment",e.code,""),t.xp6(1),t.Oqu(e.name)}}function k(a,i){if(1&a&&(t.TgZ(0,"div",16)(1,"div",17),t.YNc(2,E,4,4,"div",18),t.qZA()()),2&a){const e=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",e.barangays)}}function H(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"div",22)(1,"button",23),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.onSubmit())}),t._UZ(2,"fa-icon",24),t._uU(3," Save "),t.qZA()()}if(2&a){const e=t.oxw(2);t.xp6(2),t.Q6J("icon",e.faSave)}}function j(a,i){if(1&a&&(t.TgZ(0,"div",25)(1,"div",26),t._UZ(2,"fa-icon",27),t.qZA(),t.TgZ(3,"div",28),t._uU(4),t.qZA()()),2&a){const e=t.oxw(2);t.xp6(2),t.Q6J("icon",e.faCircleNotch),t.xp6(2),t.hij(" Loading ",e.loading_text,"... ")}}function G(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"div",6)(1,"div",7)(2,"div",8)(3,"div",9),t._uU(4,"Catchment Barangay"),t.qZA(),t.TgZ(5,"div")(6,"select",10),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.selected_year=n)})("change",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.getCatchmentBarangay(n.selected_year))}),t.YNc(7,S,2,2,"option",11),t.qZA()()(),t.YNc(8,k,3,1,"div",12),t.YNc(9,H,4,1,"div",13),t.YNc(10,j,5,2,"div",14),t.qZA()()}if(2&a){const e=t.oxw();t.xp6(6),t.Q6J("ngModel",e.selected_year),t.xp6(1),t.Q6J("ngForOf",e.years),t.xp6(1),t.Q6J("ngIf",e.show_form),t.xp6(1),t.Q6J("ngIf",e.show_form),t.xp6(1),t.Q6J("ngIf",!e.show_form)}}function D(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"app-catchment-population",29),t.NdJ("getCatchmentBarangay",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.getCatchmentBarangay(n))}),t.qZA()}if(2&a){const e=t.oxw();t.Q6J("catchment_barangays",e.catchment_barangays)("current_year",e.current_year)("selected_year",e.selected_year)}}function K(a,i){if(1&a&&t._UZ(0,"app-catchment-bhs",30),2&a){const e=t.oxw();t.Q6J("catchment_barangays",e.catchment_barangays)("facility_code",e.facility_code)("selected_year",e.selected_year)}}const $=[{path:"",component:(()=>{var a;class i{switchPage(o){this.pages=o}switchTab(o){this.module=o}onSubmit(){let o=[];Object.entries(this.selected_catchment).forEach(([s,c],l)=>{c&&o.push({barangay_code:s})}),this.http.post("settings/catchment-barangay",{year:this.current_year,barangay:o}).subscribe({next:s=>{this.toastr.success("Successfully recorded","Catchment Barangay"),this.getCatchmentBarangay(this.selected_year)},error:s=>console.log(s)})}getCatchmentBarangay(o){this.loading_text="catchment barangays",this.show_form=!1,this.http.get("settings/catchment-barangay",{params:{"filter[year]":o??this.current_year}}).subscribe({next:n=>{this.catchment_barangays=n,this.catchment_barangays[this.selected_year]&&Object.keys(this.catchment_barangays[this.selected_year].data).length>0?this.loadCatchment(this.catchment_barangays[this.selected_year].data):(this.selected_catchment=[],this.show_form=!0)},error:n=>console.log(n)})}loadCatchment(o){Object.entries(o).forEach(([n,s],c)=>{this.selected_catchment[s.barangay.code]=!0}),this.show_form=!0}loadBarangays(){this.loading_text="barangays",this.http.get("libraries/municipalities/"+this.municipality_code,{params:{include:"barangays"}}).subscribe({next:o=>{this.barangays=o.data.barangays,this.getCatchmentBarangay()},error:o=>console.log(o)})}constructor(o,n){this.http=o,this.toastr=n,this.current_year=(0,d.p6)(new Date,"yyyy","en","Asia/Manila"),this.faSave=g.r6l,this.faCircleNotch=g.IJ7,this.faDoorClosed=g.TH0,this.pages=1,this.module=1,this.show_form=!1,this.barangays=[],this.catchment_barangays=[],this.selected_catchment=[],this.modals=[],this.years=[]}ngOnInit(){let o=this.http.getUserFromJSON().facility;this.municipality_code=o.municipality_code??o.municipality.code,this.facility_code=o.code??o.facility.code,this.loadBarangays(),this.selected_year=this.current_year;for(let n=Number(this.current_year);n>2017;n--)this.years.push(n)}}return(a=i).\u0275fac=function(o){return new(o||a)(t.Y36(u.O),t.Y36(m._W))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-facility-config"]],decls:11,vars:9,consts:[[1,"flex"],[1,"mt-4","flex","flex-row","border-b","border-slate-300","text-xs"],[1,"tabs-main","px-4","uppercase",3,"click"],["class","my-5 w-full border border-gray-200 shadow-md rounded-xl",4,"ngIf"],[3,"catchment_barangays","current_year","selected_year","getCatchmentBarangay",4,"ngIf"],[3,"catchment_barangays","facility_code","selected_year",4,"ngIf"],[1,"my-5","w-full","border","border-gray-200","shadow-md","rounded-xl"],[1,"grid","grid-cols-4","border","border-slate-200","rounded-xl","w-full","shadow-md"],[1,"col-span-4","bg-blue-500","rounded-t-xl","p-3","text-white","font-semibold","flex","justify-between"],[1,"pt-1"],["name","selected_year","id","selected_year",1,"border","border-slate","rounded-md","text-sm","py-1","text-gray-800","w-28",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],["class","p-5 max-h-[600px] col-span-4 overflow-y-auto",4,"ngIf"],["class","col-span-4 rounded-b-xl border-t border-slate-200 text-end",4,"ngIf"],["class","col-span-4 grid grid-cols-1 my-32",4,"ngIf"],[3,"value"],[1,"p-5","max-h-[600px]","col-span-4","overflow-y-auto"],[1,"grid","grid-cols-3","gap-4","w-full"],["class","col-span-1",4,"ngFor","ngForOf"],[1,"col-span-1"],["type","checkbox",1,"input-checkbox",3,"ngModel","ngModelChange"],[1,"pl-2","select-none"],[1,"col-span-4","rounded-b-xl","border-t","border-slate-200","text-end"],[1,"btn-save","m-5","select-none",3,"click"],[1,"pr-2",3,"icon"],[1,"col-span-4","grid","grid-cols-1","my-32"],[1,"flex","justify-center","text-blue-500"],["spin","true",3,"icon"],[1,"flex","justify-center"],[3,"catchment_barangays","current_year","selected_year","getCatchmentBarangay"],[3,"catchment_barangays","facility_code","selected_year"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"nav",1)(2,"button",2),t.NdJ("click",function(){return n.switchPage(1)}),t._uU(3," Catchment Barangays "),t.qZA(),t.TgZ(4,"button",2),t.NdJ("click",function(){return n.switchPage(2)}),t._uU(5," Catchment Population "),t.qZA(),t.TgZ(6,"button",2),t.NdJ("click",function(){return n.switchPage(3)}),t._uU(7," Setup BHS "),t.qZA()()(),t.YNc(8,G,11,5,"div",3),t.YNc(9,D,1,3,"app-catchment-population",4),t.YNc(10,K,1,3,"app-catchment-bhs",5)),2&o&&(t.xp6(2),t.Tol(1===n.pages?"tabs-main-true rounded-t-md":"tabs-main-false"),t.xp6(2),t.Tol(2===n.pages?"tabs-main-true rounded-t-md":"tabs-main-false"),t.xp6(2),t.Tol(3===n.pages?"tabs-main-true rounded-t-md":"tabs-main-false"),t.xp6(2),t.Q6J("ngIf",1===n.pages),t.xp6(1),t.Q6J("ngIf",2===n.pages),t.xp6(1),t.Q6J("ngIf",3===n.pages))},dependencies:[d.sg,d.O5,r.YN,r.Kr,r.Wl,r.EJ,r.JJ,r.On,p.BN,U,Y]}),i})()}];let L=(()=>{var a;class i{}return(a=i).\u0275fac=function(o){return new(o||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[b.Bz.forChild($),b.Bz]}),i})(),R=(()=>{var a;class i{}return(a=i).\u0275fac=function(o){return new(o||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[d.ez,L,r.u5,p.uH]}),i})()}}]);