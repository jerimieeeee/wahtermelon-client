<div class="border border-slate-200 rounded-b-lg" *ngIf="show_form">
  <div class="mx-5 mb-5">
    <div class="mt-1 grid grid-cols-4 gap-x-4 w-full">
      <div class="col-span-4 border-b border-slate-200 w-full my-2 pt-3 font-semibold text-sky-500">
        Physician
      </div>
      <div class="col-span-4 grid grid-cols-1 border-slate-200 shadow-md rounded-md mx-5 mb-5">
        <div class="bg-sky-500 text-white py-1 px-3 rounded-t-md flex justify-between">
          <spa>Medical Consults</spa>
          <button type="button" (click)="toggleModal('medical_consult')" class="bg-white text-sky-500 px-2 rounded text-xs">
            <fa-icon [icon]="faPlus"></fa-icon>
          </button>
        </div>
        <div class="min-h-24">
          <span class="flex italic py-5 justify-center">
            No records to show
          </span>
        </div>
      </div>
    </div>

    <div class="mt-1 grid grid-cols-4 gap-x-4 w-full">
      <div class="col-span-4 border-b border-slate-200 w-full my-2 pt-3 font-semibold text-sky-500">
        Social Worker
      </div>
      <div class="col-span-4 grid grid-cols-1 border-slate-200 shadow-md rounded-md mx-5 mb-5">
        <div class="bg-sky-500 text-white py-1 px-3 rounded-t-md flex justify-between">
          <spa>Home Visits</spa>
          <button type="button" (click)="toggleModal('home_visit')" class="bg-white text-sky-500 px-2 rounded text-xs">
            <fa-icon [icon]="faPlus"></fa-icon>
          </button>
        </div>
        <div class="min-h-24" *ngIf="selected_gbv_case?.gbvIntake.intervention_social_work.length===0">
          <span class="flex italic py-5 justify-center">
            No records to show
          </span>
        </div>

        <table class="m-3" *ngIf="selected_gbv_case?.gbvIntake.intervention_social_work.length>0">
          <thead>
            <tr>
              <td class="w-1/12">

              </td>
              <td class="text-center font-semibold w-4/12 align-top pt-3">
                Visit date<br />
              </td>
              <td class="text-center font-semibold w-7/12 align-top pt-3">
                Social Worker
              </td>
            </tr>
          </thead>
          <tbody>
            <tr class="border-t border-slate-200" *ngFor="let social_work of selected_gbv_case?.gbvIntake.intervention_social_work" >
              <td class="text-center align-top pt-3">
                <fa-icon [icon]="faEdit" (click)="toggleModal('home_visit', social_work)" class="hover:cursor-pointer text-orange-500"></fa-icon>
              </td>
              <td class="text-center align-top pt-3">
                {{ social_work.visit_date | date: 'MM/dd/yyyy'}}
              </td>
              <td class="text-center align-top pt-3">
                {{ social_work.social_worker }}
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="col-span-4 grid grid-cols-1 border-slate-200 shadow-md rounded-md mx-5 mb-5">
        <div class="bg-sky-500 text-white py-1 px-3 rounded-t-md flex justify-between">
          <spa>Placements</spa>
          <button type="button" (click)="toggleModal('placement')" class="bg-white text-sky-500 px-2 rounded text-xs">
            <fa-icon [icon]="faPlus"></fa-icon>
          </button>
        </div>
        <div class="min-h-24" *ngIf="selected_gbv_case?.gbvIntake.intervention_placement.length===0">
          <span class="flex italic py-5 justify-center">
            No records to show
          </span>
        </div>

        <table class="m-3" *ngIf="selected_gbv_case?.gbvIntake.intervention_placement.length>0">
          <thead>
            <tr>
              <td class="w-1/12">

              </td>
              <td class="text-center font-semibold w-4/12 align-top pt-3">
                Placement
              </td>
              <td class="text-center font-semibold w-4/12 align-top pt-3">
                Name and Contact Info
              </td>
              <td class="text-center font-semibold w-7/12 align-top pt-3">
                Date
              </td>
            </tr>
          </thead>
          <tbody>
            <tr class="border-t border-slate-200" *ngFor="let placement of selected_gbv_case?.gbvIntake.intervention_placement" >
              <td class="text-center align-top pt-3">
                <fa-icon [icon]="faEdit" (click)="toggleModal('placement', placement)" class="hover:cursor-pointer text-orange-500"></fa-icon>
              </td>
              <td class="text-center align-top pt-3">
                {{ placement.placement_name }}
              </td>
              <td class="text-center align-top pt-3">
                {{ placement.placement_name }}
              </td>
              <td class="text-center align-top pt-3">
                {{ placement.scheduled_date | date: 'MM/dd/yyyy' }} <br />
                {{ placement.actual_date | date: 'MM/dd/yyyy' }}
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="mt-1 grid grid-cols-4 gap-x-4 w-full">
      <div class="col-span-4 border-b border-slate-200 w-full my-2 pt-3 font-semibold text-sky-500">
        Psychiatry
      </div>
      <div class="col-span-4 grid grid-cols-1 border-slate-200 shadow-md rounded-md mx-5 mb-5">
        <div class="bg-sky-500 text-white py-1 px-3 rounded-t-md flex justify-between">
          <spa>Sessions</spa>
          <button type="button" (click)="toggleModal('session')" class="bg-white text-sky-500 px-2 rounded text-xs">
            <fa-icon [icon]="faPlus"></fa-icon>
          </button>
        </div>
        <div class="min-h-24" *ngIf="selected_gbv_case?.gbvIntake.intervention_psych.length===0">
          <span class="flex italic py-5 justify-center">
            No records to show
          </span>
        </div>

        <table class="m-3" *ngIf="selected_gbv_case?.gbvIntake.intervention_psych.length>0">
          <thead>
            <tr>
              <td class="w-1/12">

              </td>
              <td class="text-center font-semibold w-4/12 align-top pt-3">
                Participant
              </td>
              <td class="text-center font-semibold w-4/12 align-top pt-3">
                Psychiatrist
              </td>
              <td class="text-center font-semibold w-7/12 align-top pt-3">
                Scheduled Date <br />
                Actual Date
              </td>
            </tr>
          </thead>
          <tbody>
            <tr class="border-t border-slate-200" *ngFor="let psych of selected_gbv_case?.gbvIntake.intervention_psych" >
              <td class="text-center align-top pt-3">
                <fa-icon [icon]="faEdit" (click)="toggleModal('session', psych)" class="hover:cursor-pointer text-orange-500"></fa-icon>
              </td>
              <td class="text-center align-top pt-3">
                {{ psych.participant.desc }}
              </td>
              <td class="text-center align-top pt-3">
                {{ psych.md_name }}
              </td>
              <td class="text-center align-top pt-3">
                {{ psych.scheduled_date | date: 'MM/dd/yyyy' }} <br />
                {{ psych.actual_date | date: 'MM/dd/yyyy' }}
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="mt-1 grid grid-cols-4 gap-x-4 w-full">
      <div class="col-span-4 border-b border-slate-200 w-full my-2 pt-3 font-semibold text-sky-500">
        Legal
      </div>
      <div class="col-span-4 grid grid-cols-1 border-slate-200 shadow-md rounded-md mx-5 mb-5">
        <div class="bg-sky-500 text-white py-1 px-3 rounded-t-md flex justify-between">
          <spa>Case Details</spa>
          <button type="button" *ngIf="!selected_gbv_case?.gbvIntake.intervention_legal" (click)="toggleModal('legal_case')" class="bg-white text-sky-500 px-2 rounded text-xs">
            <fa-icon [icon]="faEdit"></fa-icon>
          </button>
        </div>
        <div class="min-h-24" *ngIf="!selected_gbv_case?.gbvIntake.intervention_legal">
          <span class="flex italic py-5 justify-center">
            No records to show
          </span>
        </div>

        <table class="m-3" *ngIf="selected_gbv_case?.gbvIntake.intervention_legal">
          <thead>
            <tr>
              <td class="w-1/12">

              </td>
              <td class="text-center font-semibold w-4/12 align-top pt-3">
                Filed By
              </td>
              <td class="text-center font-semibold w-4/12 align-top pt-3">
                Date of CPU MD Testimony
              </td>
              <td class="text-center font-semibold w-7/12 align-top pt-3">
                Court Details
              </td>
            </tr>
          </thead>
          <tbody>
            <tr class="border-t border-slate-200">
              <td class="text-center">
                <fa-icon [icon]="faEdit" (click)="toggleModal('legal_case', selected_gbv_case?.gbvIntake.intervention_legal)" class="hover:cursor-pointer text-orange-500"></fa-icon>
              </td>
              <td class="text-center align-top pt-3">
                {{ selected_gbv_case?.gbvIntake.intervention_legal.filed_by_name }} <br /><br />

                Relationship to victim survivor: <br />
                {{ selected_gbv_case?.gbvIntake.intervention_legal.relation ? selected_gbv_case?.gbvIntake.intervention_legal.relation.desc : '-' }} <br /><br />

                Filed at: <br />
                {{ selected_gbv_case?.gbvIntake.intervention_legal.filed_location ? selected_gbv_case?.gbvIntake.intervention_legal.filed_location.desc : '-' }}
              </td>
              <td class="text-center align-top pt-3">
                {{ selected_gbv_case?.gbvIntake.intervention_legal.cpumd_testimony_date | date: 'MM/dd/yyyy' }}
              </td>
              <td class="text-center align-top pt-3">
                Criminal Case Number: <br />
                {{ selected_gbv_case?.gbvIntake.intervention_legal.criminal_case_number }} <br /><br />

                Judge: <br />
                {{ selected_gbv_case?.gbvIntake.intervention_legal.judge_name }} <br /><br />


                Court: <br />
                {{ selected_gbv_case?.gbvIntake.intervention_legal.court_name }}<br /><br />

                Fiscal Name: <br />
                {{ selected_gbv_case?.gbvIntake.intervention_legal.fiscal_name }}<br /><br />

                Verdict: <br />
                {{ selected_gbv_case?.gbvIntake.intervention_legal.verdict ? selected_gbv_case?.gbvIntake.intervention_legal.verdict.desc : '-' }}
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="mt-1 grid grid-cols-4 gap-x-4 w-full">
      <div class="col-span-4 border-b border-slate-200 w-full my-2 pt-3 font-semibold text-sky-500">
        Multidisiplinary Case Conferences
      </div>
      <div class="col-span-4 grid grid-cols-1 border-slate-200 shadow-md rounded-md mx-5 mb-5">
        <div class="bg-sky-500 text-white py-1 px-3 rounded-t-md flex justify-between">
          <spa>Case Conference</spa>
          <button type="button" (click)="toggleModal('case_conference')" class="bg-white text-sky-500 px-2 rounded text-xs">
            <fa-icon [icon]="faPlus"></fa-icon>
          </button>
        </div>
        <div class="min-h-24" *ngIf="selected_gbv_case?.gbvIntake.case_conference.length===0">
          <span class="flex italic py-5 justify-center">
            No records to show
          </span>
        </div>

        <table class="m-3" *ngIf="selected_gbv_case?.gbvIntake.case_conference.length>0">
          <thead>
            <tr>
              <td class="w-1/12">

              </td>
              <td class="text-center font-semibold w-3/12 align-top pt-3">
                Date
              </td>
              <td class="text-center font-semibold w-4/12 align-top pt-3">
                Invitees & Concerns
              </td>
              <td class="text-center font-semibold w-4/12 align-top pt-3">
                Mitigating factors & Recommendations
              </td>
            </tr>
          </thead>
          <tbody>
            <tr class="border-t border-slate-200" *ngFor="let conference of selected_gbv_case?.gbvIntake.case_conference" >
              <td class="text-center align-top pt-3">
                <fa-icon [icon]="faEdit" (click)="toggleModal('case_conference', conference)" class="hover:cursor-pointer text-orange-500"></fa-icon>
              </td>
              <td class="text-center align-top pt-3">
                {{ conference.conference_date | date: 'MM/dd/yyyy'}}
              </td>
              <td class="text-left align-top pt-3">
                <div class="mb-5">
                  <span class="italic font-semibold">Invitees</span><br />
                  <span *ngIf="conference.invite.length===0">
                    - <br />
                  </span>
                  <span *ngFor="let invite of conference.invite">
                    - {{ invite.invite.desc }} <br />
                  </span>
                  Remarks: {{ conference.conference_invitee_remarks ?? '-' }}
                </div>
                <div class="mb-5">
                  <span class="italic font-semibold">Concerns</span><br />
                  <span *ngIf="conference.concern.length===0">
                    - <br />
                  </span>
                  <span *ngFor="let concern of conference.concern">
                    - {{ concern.concern.desc }} <br />
                  </span>
                  Remarks: {{ conference.conference_concern_remarks ?? '-' }}
                </div>
              </td>
              <td class="text-left align-top pt-3">
                <div class="mb-5">
                  <span class="italic font-semibold">Mitigating factors</span><br />
                  <span *ngIf="conference.mitigating_factor.length===0">
                    - <br />
                  </span>
                  <span *ngFor="let mitigating_factor of conference.mitigating_factor">
                    - {{ mitigating_factor.mitigating_factor.desc }} <br />
                  </span>
                  Remarks: {{ conference.conference_mitigating_factor_remarks ?? '-' }}
                </div>
                <div class="mb-5">
                  <span class="italic font-semibold">Recommendations</span><br />
                  <span *ngIf="conference.recommendation.length===0">
                    - <br />
                  </span>
                  <span *ngFor="let recommendation of conference.recommendation">
                    - {{ recommendation.recommendation.desc }} <br />
                  </span>
                  Remarks: {{ conference.conference_recommendation_remarks ?? '-' }}
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<app-medical-consult *ngIf="modals['medical_consult']"
  (toggleModal)="toggleModal($event)"
  [selected_data]="selected_data"
  [patient_gbv_intake_id]="selected_gbv_case.gbvIntake.id"
  [patient_id]="patient_id"
></app-medical-consult>

<app-home-visit *ngIf="modals['home_visit']"
  (toggleModal)="toggleModal($event)"
  [selected_data]="selected_data"
  [patient_gbv_intake_id]="selected_gbv_case.gbvIntake.id"
  [patient_id]="patient_id"
></app-home-visit>

<app-placement *ngIf="modals['placement']"
  (toggleModal)="toggleModal($event)"
  [selected_data]="selected_data"
  [patient_gbv_intake_id]="selected_gbv_case.gbvIntake.id"
  [patient_id]="patient_id"
></app-placement>

<app-session *ngIf="modals['session']"
  (toggleModal)="toggleModal($event)"
  [selected_data]="selected_data"
  [patient_gbv_intake_id]="selected_gbv_case.gbvIntake.id"
  [patient_id]="patient_id"
></app-session>

<app-legal-case *ngIf="modals['legal_case']"
  (toggleModal)="toggleModal($event)"
  [selected_data]="selected_data"
  [patient_gbv_intake_id]="selected_gbv_case.gbvIntake.id"
  [patient_id]="patient_id"
></app-legal-case>

<app-case-conference *ngIf="modals['case_conference']"
  (toggleModal)="toggleModal($event)"
  [selected_data]="selected_data"
  [patient_gbv_intake_id]="selected_gbv_case.gbvIntake.id"
  [patient_id]="patient_id"
></app-case-conference>
<!-- <app-family-composition *ngIf="modals['add_family']"
  (toggleModal)="toggleModal($event)"
></app-family-composition> -->
