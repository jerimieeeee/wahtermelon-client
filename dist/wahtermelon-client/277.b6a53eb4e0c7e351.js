"use strict";(self.webpackChunkwahtermelon_client=self.webpackChunkwahtermelon_client||[]).push([[277],{1277:(Q,f,i)=>{i.r(f),i.d(f,{ResetPasswordModule:()=>l});var c=i(6895),u=i(2325),r=i(433),_=i(2687),s=i(1571),w=i(4691),m=i(2216);function x(e,o){1&e&&(s.TgZ(0,"div")(1,"ol",22)(2,"li"),s._uU(3,"Password must have at least 6 characters"),s.qZA(),s.TgZ(4,"li"),s._uU(5,"Password must have at least 1 capital letter"),s.qZA(),s.TgZ(6,"li"),s._uU(7,"Password must have at least 1 small letter"),s.qZA(),s.TgZ(8,"li"),s._uU(9,"Password must have at least 1 number"),s.qZA(),s.TgZ(10,"li"),s._uU(11,"Password must have at least 1 special character"),s.qZA()()())}function h(e,o){if(1&e&&(s.TgZ(0,"div"),s._uU(1),s.qZA()),2&e){const t=s.oxw(3);s.xp6(1),s.hij(" ",t.required_message," ")}}function Z(e,o){1&e&&(s.TgZ(0,"div")(1,"ol",22)(2,"li"),s._uU(3,"Password must have at least 6 characters"),s.qZA(),s.TgZ(4,"li"),s._uU(5,"Password must have at least 1 capital letter"),s.qZA(),s.TgZ(6,"li"),s._uU(7,"Password must have at least 1 small letter"),s.qZA(),s.TgZ(8,"li"),s._uU(9,"Password must have at least 1 number"),s.qZA(),s.TgZ(10,"li"),s._uU(11,"Password must have at least 1 special character"),s.qZA()()())}function T(e,o){if(1&e&&(s.TgZ(0,"div",23),s.YNc(1,h,2,1,"div",14),s.YNc(2,Z,12,0,"div",14),s.qZA()),2&e){const t=s.oxw(2);s.xp6(1),s.Q6J("ngIf",null==t.f.password.errors?null:t.f.password.errors.required),s.xp6(1),s.Q6J("ngIf",null==t.f.password.errors?null:t.f.password.errors.pattern)}}function b(e,o){1&e&&(s.TgZ(0,"div",23)(1,"div"),s._uU(2," Password does not match "),s.qZA()())}function C(e,o){if(1&e&&(s.TgZ(0,"div"),s._uU(1),s.qZA()),2&e){const t=s.oxw(3);s.xp6(1),s.hij(" ",t.required_message," ")}}function P(e,o){if(1&e&&(s.TgZ(0,"div",23),s.YNc(1,C,2,1,"div",14),s.qZA()),2&e){const t=s.oxw(2);s.xp6(1),s.Q6J("ngIf",null==t.f.password_confirmation.errors?null:t.f.password_confirmation.errors.required)}}function y(e,o){if(1&e&&(s.TgZ(0,"li"),s._uU(1),s.qZA()),2&e){const t=o.$implicit;s.xp6(1),s.AsE("",t.key,": ",t.value,"")}}function A(e,o){if(1&e&&(s.TgZ(0,"div",24)(1,"ul",25),s.YNc(2,y,2,2,"li",26),s.ALo(3,"keyvalue"),s.qZA()()),2&e){const t=s.oxw(2);s.xp6(2),s.Q6J("ngForOf",s.lcZ(3,1,t.submit_errors))}}function q(e,o){if(1&e&&s._UZ(0,"fa-icon",27),2&e){const t=s.oxw(2);s.Q6J("icon",t.faSpinner)}}const g=function(e){return{"text-red-500":e}},v=function(e){return{"invalid-input":e}};function J(e,o){if(1&e){const t=s.EpF();s.TgZ(0,"div",5)(1,"div",6)(2,"span"),s._uU(3,"Create new password"),s.qZA(),s.TgZ(4,"form",7),s.NdJ("ngSubmit",function(){s.CHM(t);const n=s.oxw();return s.KtG(n.onSubmit())}),s.TgZ(5,"div",8)(6,"label",9),s._uU(7,"Password"),s.qZA(),s.TgZ(8,"div",10),s._UZ(9,"input",11),s.TgZ(10,"button",12),s.NdJ("click",function(){s.CHM(t);const n=s.oxw();return s.KtG(n.show_pass=!n.show_pass)}),s._UZ(11,"fa-icon",13),s.qZA()(),s.YNc(12,x,12,0,"div",14),s.YNc(13,T,3,2,"div",15),s.qZA(),s.TgZ(14,"div"),s._uU(15),s.TgZ(16,"label",16),s._uU(17,"Password Confirmation"),s.qZA(),s._UZ(18,"input",17),s.YNc(19,b,3,0,"div",15),s.YNc(20,P,2,1,"div",15),s.qZA(),s.YNc(21,A,4,3,"div",18),s.TgZ(22,"div",19)(23,"button",20),s.YNc(24,q,1,1,"fa-icon",21),s._uU(25),s.qZA()()()()()}if(2&e){const t=s.oxw();s.xp6(4),s.Q6J("formGroup",t.userForm),s.xp6(2),s.Q6J("ngClass",s.VKq(19,g,t.is_saving&&t.f.password.errors)),s.xp6(3),s.Q6J("type",t.show_pass?"text":"password")("ngClass",s.VKq(21,v,t.is_saving&&t.f.password.errors)),s.xp6(2),s.Q6J("icon",t.show_pass?t.faEyeSlash:t.faEye),s.xp6(1),s.Q6J("ngIf",!t.is_saving),s.xp6(1),s.Q6J("ngIf",t.is_saving&&t.f.password.errors),s.xp6(2),s.lnq(" test ",t.passwordMatchError," ",t.userForm.invalid," ",!t.f.password_confirmation.dirty," "),s.xp6(1),s.Q6J("ngClass",s.VKq(23,g,t.is_saving&&t.f.password_confirmation.errors)),s.xp6(2),s.Q6J("type",t.show_pass?"text":"password")("ngClass",s.VKq(25,v,t.is_saving&&t.f.password_confirmation.errors)),s.xp6(1),s.Q6J("ngIf",t.passwordMatchError),s.xp6(1),s.Q6J("ngIf",t.is_saving&&t.f.password_confirmation.errors),s.xp6(1),s.Q6J("ngIf",t.submit_errors),s.xp6(2),s.Q6J("disabled",t.passwordMatchError||t.userForm.invalid||!t.f.password_confirmation.dirty),s.xp6(1),s.Q6J("ngIf",t.is_saving),s.xp6(1),s.hij(" ",t.is_saving?"Updating":"Change password"," ")}}function U(e,o){if(1&e&&(s.TgZ(0,"div",33)(1,"span"),s._uU(2,"Your password was successfully updated! Attempting to login... "),s.qZA(),s._UZ(3,"fa-icon",34),s.qZA()),2&e){const t=s.oxw(2);s.xp6(3),s.Q6J("icon",t.faSpinner)}}function I(e,o){1&e&&(s.TgZ(0,"div",33),s._uU(1," Login attempt failed. Try login in using the login page. "),s.qZA())}function R(e,o){if(1&e){const t=s.EpF();s.TgZ(0,"div",28),s.YNc(1,U,4,1,"div",29),s.YNc(2,I,2,0,"div",29),s.TgZ(3,"div",30)(4,"button",31),s.NdJ("click",function(){s.CHM(t);const n=s.oxw();return s.KtG(n.backToLogin())}),s._UZ(5,"fa-icon",32),s._uU(6," Back to login"),s.qZA()()()}if(2&e){const t=s.oxw();s.xp6(1),s.Q6J("ngIf",!t.attempt_error),s.xp6(1),s.Q6J("ngIf",t.attempt_error),s.xp6(3),s.Q6J("icon",t.faArrowLeft)}}class p{onSubmit(){console.log(this.userForm),this.is_saving=!0,this.userForm.valid?this.http.post("reset-password",this.userForm.value).subscribe({next:o=>{this.is_saving=!1,this.is_updated=!0,this.attemptLogin()},error:o=>{console.log(o),this.submit_errors=o.error.errors}}):this.is_saving=!1}attemptLogin(){this.http.login(this.userForm.value).subscribe({next:o=>{localStorage.setItem("access_token",o.access_token),this.http.saveUserToLocalStorage(o.user),this.is_saving=!1,this.router.navigate(["/"])},error:o=>{console.log(o),this.is_saving=!1,this.attempt_error=!0},complete:()=>{}})}backToLogin(){this.router.navigate(["/"])}get passwordMatchError(){return this.userForm.controls.password.value!=this.userForm.controls.password_confirmation.value&&this.userForm.get("password_confirmation")?.dirty}constructor(o,t,a,n){this.http=o,this.router=t,this.formBuilder=a,this.route=n,this.faEyeSlash=_.Aq,this.faEye=_.Mdf,this.faSpinner=_.LM3,this.faArrowLeft=_.acZ,this.is_saving=!1,this.show_pass=!1,this.is_updated=!1,this.attempt_error=!1,this.userForm=new r.cw({email:new r.NI(""),password:new r.NI(""),password_confirmation:new r.NI(""),token:new r.NI("")})}get f(){return this.userForm.controls}ngOnInit(){let o,t;this.route.queryParamMap.subscribe(a=>{o=a.get("email"),t=a.get("token")}),this.userForm=this.formBuilder.nonNullable.group({email:[o],password:["",[r.kI.required,r.kI.pattern("^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-_]).{6,}$")]],password_confirmation:["",r.kI.required],token:[t]})}}p.\u0275fac=function(o){return new(o||p)(s.Y36(w.O),s.Y36(u.F0),s.Y36(r.qu),s.Y36(u.gz))},p.\u0275cmp=s.Xpm({type:p,selectors:[["app-reset-password"]],decls:6,vars:3,consts:[[1,"flex","w-full","justify-center"],[1,"w-2/6","rounded-lg","mt-36"],[1,"flex","text-gray-700","text-xl","font-semibold","p-5","justify-center"],["class","flex text-gray-700",4,"ngIf"],["class","grid grid-cols-1 text-gray-700 justify-center",4,"ngIf"],[1,"flex","text-gray-700"],[1,"p-5","w-full"],[3,"formGroup","ngSubmit"],[1,"mt-5"],["for","password",1,"input-label",3,"ngClass"],[1,"relative","rounded-md"],["name","password","id","password","tabindex","1","formControlName","password",1,"input",3,"type","ngClass"],["type","button",1,"absolute","inset-y-0","right-0","flex","items-center","pr-2","text-gray-500",3,"click"],[3,"icon"],[4,"ngIf"],["class","invalid-alert",4,"ngIf"],["for","password_confirmation",1,"input-label",3,"ngClass"],["name","password_confirmation","id","password_confirmation","tabindex","2","formControlName","password_confirmation",1,"input",3,"type","ngClass"],["class","bg-red-200 p-2 w-full rounded-md border border-red-300 text-sm mt-5",4,"ngIf"],[1,"w-full","pt-3"],["tabindex","3","type","submit",1,"btn-save","w-full","disabled:bg-gray-400",3,"disabled"],["class","pr-2","spin","true",3,"icon",4,"ngIf"],[1,"list-disc","pl-5","text-sm"],[1,"invalid-alert"],[1,"bg-red-200","p-2","w-full","rounded-md","border","border-red-300","text-sm","mt-5"],[1,"list-disc","pl-5"],[4,"ngFor","ngForOf"],["spin","true",1,"pr-2",3,"icon"],[1,"grid","grid-cols-1","text-gray-700","justify-center"],["class","flex justify-center",4,"ngIf"],[1,"flex","justify-center","mt-3"],["type","button",1,"btn-save",3,"click"],[1,"pr-2",3,"icon"],[1,"flex","justify-center"],["spin","true",1,"pl-2","text-blue-500","font-semibold",3,"icon"]],template:function(o,t){1&o&&(s.TgZ(0,"div",0)(1,"div",1)(2,"div",2),s._uU(3),s.qZA(),s.YNc(4,J,26,27,"div",3),s.YNc(5,R,7,3,"div",4),s.qZA()()),2&o&&(s.xp6(3),s.hij(" ",t.is_updated?"Password changed":"Change Password"," "),s.xp6(1),s.Q6J("ngIf",!t.is_updated),s.xp6(1),s.Q6J("ngIf",t.is_updated))},dependencies:[c.mk,c.sg,c.O5,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,m.BN,c.Nd]});const N=[{path:"",component:p}];class d{}d.\u0275fac=function(o){return new(o||d)},d.\u0275mod=s.oAB({type:d}),d.\u0275inj=s.cJS({imports:[u.Bz.forChild(N),u.Bz]});class l{}l.\u0275fac=function(o){return new(o||l)},l.\u0275mod=s.oAB({type:l}),l.\u0275inj=s.cJS({imports:[c.ez,d,r.UX,r.u5,m.uH]})}}]);