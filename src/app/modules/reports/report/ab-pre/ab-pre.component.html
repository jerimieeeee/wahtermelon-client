<div *ngIf="show_stats" class="grid grid-cols-1 w-full">
  <div class="flex justify-between w-full text-blue-500 font-semibold text-lg  p-3" >
    <span>
      <button type="button" class="text-2xl" (click)="exportX()">
        <fa-icon [icon]="faFileExcel" class="text-green-700"></fa-icon>
      </button>
    </span>
  </div>

  <div class="w-auto flex justify-center text-center text-sm font-semibold">
    REPUBLIC OF THE PHILIPPINES <br />
    DEPARTMENT OF HEALTH <br />
    Wireless Access for Health <br />
    Rabies and Bite Victim Report Form <br />
  </div>

  <th class="text-base font-medium text-gray-900 text-center align-top">
    {{
       this.reportForm.value.quarter === '1' ? '1st Quarter' :
       this.reportForm.value.quarter === '2' ? '2nd Quarter' :
       this.reportForm.value.quarter === '3' ? '3rd Quarter' :
       this.reportForm.value.quarter === '4' ? '4th Quarter' :
       ''
    }}

    ({{ this.reportForm.value.year }})

  </th>

  <table class="ab-quarterly-report w-[330.2mm] border border-gray-400 select-none" id="reportForm">
    <thead class="text-xs px-1.5">
      <tr>
        <th class="pt-2 pb-4 px-3" rowspan="3">
          {{ this.reportFlag === '1' ? 'MUN/CITY' : 'BARANGAY' }}
        </th>
        <th class="w-20" rowspan="3">Total Population</th>
        <th colspan="11">Animal Bite Victims</th>
        <th rowspan="2" colspan="2">PREP</th>
        <th rowspan="3">Tandok</th>
        <th rowspan="2" colspan="2">Human Rabies</th>
        <th rowspan="2" colspan="4">PEP</th>
        <th rowspan="2" colspan="4">Biting Animals</th>
        <th rowspan="2" colspan="4">PEP Coverage</th>
      </tr>
      <tr>
        <th colspan="3">Sex</th>
        <th colspan="3">Age</th>
        <th colspan="5">Category</th>
      </tr>
      <tr class="text-center text-xs font-bold px-1.5">
        <td class="pt-2 pb-4 w-10">Male</td>
        <td class="w-10">Female</td>
        <td class="w-10">Total</td>
        <td class="w-10"><15</td>
        <td class="w-10">>15</td>
        <td class="w-10">Total</td>
        <td class="w-10">Cat I</td>
        <td class="w-10">Cat II</td>
        <td class="w-10">Cat III</td>
        <td class="w-10">Total <br />(CII+CIII)</td>
        <td class="w-10">Total</td>
        <td class="w-10">Total</td>
        <td class="w-10">D0, D7, D21</td>
        <td class="w-10">No.</td>
        <td class="w-10">PR</td>
        <td class="w-10">D0, D3, D7</td>
        <td class="w-10">TCV</td>
        <td class="w-10">HRIG</td>
        <td class="w-10">ERIG</td>
        <td class="w-10">Dog</td>
        <td class="w-10">Cat</td>
        <td class="w-10">Others</td>
        <td class="w-10">Total</td>
        <td class="w-20">Total # of registered Cat 2 and Cat 3 of the previous quarter</td>
        <td class="w-20">Completed (previous)</td>
        <td class="w-10">%TCV</td>
        <td class="w-10">%RIG</td>
      </tr>
    </thead>
    <tbody>
      <tr class="text-center text-xs" *ngFor="let item of stats|keyvalue">
        <td class="pt-2 pb-4 text-sm text-left font-bold">{{ item.key }}</td>
        <ng-container class="text-center text-sm" *ngFor="let data of item.value">
          <td>{{ data.population | number }}</td>
          <td (click)="data.male > 0 && showNameList('male', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.male > 0}">{{ data.male | number }}</td>
          <td (click)="data.female > 0 && showNameList('female', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.female > 0}">{{ data.female | number }}</td>
          <td (click)="data.male_female_total > 0 && showNameList('male_female_total', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.male_female_total > 0}">{{ data.male_female_total | number }}</td>
          <td (click)="data.less_than_15 > 0 && showNameList('less_than_15', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.less_than_15 > 0}">{{ data.less_than_15 | number }}</td>
          <td (click)="data.greater_than_15 > 0 && showNameList('greater_than_15', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.greater_than_15 > 0}">{{ data.greater_than_15 | number }}</td>
          <td (click)="data.less_than_and_greater_than_15 > 0 && showNameList('less_than_and_greater_than_15', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.less_than_and_greater_than_15 > 0}">{{ data.less_than_and_greater_than_15 | number }}</td>
          <td (click)="data.category1 > 0 && showNameList('category1', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.category1 > 0}">{{ data.category1 | number }}</td>
          <td (click)="data.category2 > 0 && showNameList('category2', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.category2 > 0}">{{ data.category2 | number }}</td>
          <td (click)="data.category3 > 0 && showNameList('category3', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.category3 > 0}">{{ data.category3 | number }}</td>
          <td (click)="data.total_cat2_and_cat3 > 0 && showNameList('total_cat2_and_cat3', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.total_cat2_and_cat3 > 0}">{{ data.total_cat2_and_cat3 | number }}</td>
          <td (click)="data.total_cat1_cat2_cat3 > 0 && showNameList('total_cat1_cat2_cat3', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.total_cat1_cat2_cat3 > 0}">{{ data.total_cat1_cat2_cat3 | number }}</td>
          <td (click)="data.prep_total > 0 && showNameList('prep_total', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.prep_total > 0}">{{ data.prep_total | number }}</td>
          <td (click)="data.prep_completed > 0 && showNameList('prep_completed', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.prep_completed > 0}">{{ data.prep_completed | number }}</td>
          <td (click)="data.tandok > 0 && showNameList('tandok', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.tandok > 0}">{{ data.tandok | number }}</td>
          <td></td>
          <td></td>
          <td (click)="data.pep_completed > 0 && showNameList('pep_completed', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.pep_completed > 0}">{{ data.pep_completed | number }}</td>
          <td (click)="data.tcv > 0 && showNameList('tcv', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.tcv > 0}">{{ data.tcv | number }}</td>
          <td (click)="data.HRIG > 0 && showNameList('HRIG', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.HRIG > 0}">{{ data.HRIG | number }}</td>
          <td (click)="data.ERIG > 0 && showNameList('ERIG', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.ERIG > 0}">{{ data.ERIG }}</td>
          <td (click)="data.dog > 0 && showNameList('dog', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.dog > 0}">{{ data.dog | number }}</td>
          <td (click)="data.cat > 0 && showNameList('cat', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.cat > 0}">{{ data.cat | number }}</td>
          <td (click)="data.others > 0 && showNameList('others', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.others > 0}">{{ data.others | number }}</td>
          <td (click)="data.total_biting_animal > 0 && showNameList('total_biting_animal', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.total_biting_animal > 0}">{{ data.total_biting_animal | number }}</td>
          <td (click)="data.total_cat2_and_cat3_previous_quarter > 0 && showNameList('total_cat2_and_cat3_previous_quarter', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.total_cat2_and_cat3_previous_quarter > 0}">{{ data.total_cat2_and_cat3_previous_quarter | number }}</td>
          <td (click)="data.pep_completed_previous > 0 && showNameList('pep_completed_previous', 'catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.pep_completed_previous > 0}">{{ data.pep_completed_previous | number }}</td>
          <td></td>
          <td></td>
        </ng-container>
      </tr>
      <td class="pt-2 pb-4 font-bold text-center bg-gray-400" colspan="30">
        OTHERS {{ reportFlag == '1' ? '(PROVINCES)' : '(MUNICIPALITIES)' }}
      </td>
      <tr class="text-xs text-center" *ngFor="let item_others of stats_others|keyvalue">
        <td class="pt-2 pb-4 font-bold text-sm text-left">{{ item_others.key }}</td>
        <ng-container class="text-center" *ngFor="let data of item_others.value">
          <td>{{ data.population | number }}</td>
          <td (click)="data.male > 0 && showNameList('male', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.male > 0}">{{ data.male | number }}</td>
          <td (click)="data.female > 0 && showNameList('female', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.female > 0}">{{ data.female | number }}</td>
          <td (click)="data.male_female_total > 0 && showNameList('male_female_total', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.male_female_total > 0}">{{ data.male_female_total | number }}</td>
          <td (click)="data.less_than_15 > 0 && showNameList('less_than_15', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.less_than_15 > 0}">{{ data.less_than_15 | number }}</td>
          <td (click)="data.greater_than_15 > 0 && showNameList('greater_than_15', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.greater_than_15 > 0}">{{ data.greater_than_15 | number }}</td>
          <td (click)="data.less_than_and_greater_than_15 > 0 && showNameList('less_than_and_greater_than_15', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.less_than_and_greater_than_15 > 0}">{{ data.less_than_and_greater_than_15 | number }}</td>
          <td (click)="data.category1 > 0 && showNameList('category1', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.category1 > 0}">{{ data.category1 | number }}</td>
          <td (click)="data.category2 > 0 && showNameList('category2', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.category2 > 0}">{{ data.category2 | number }}</td>
          <td (click)="data.category3 > 0 && showNameList('category3', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.category3 > 0}">{{ data.category3 | number }}</td>
          <td (click)="data.total_cat2_and_cat3 > 0 && showNameList('total_cat2_and_cat3', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.total_cat2_and_cat3 > 0}">{{ data.total_cat2_and_cat3 | number }}</td>
          <td (click)="data.total_cat1_cat2_cat3 > 0 && showNameList('total_cat1_cat2_cat3', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.total_cat1_cat2_cat3 > 0}">{{ data.total_cat1_cat2_cat3 | number }}</td>
          <td (click)="data.prep_total > 0 && showNameList('prep_total', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.prep_total > 0}">{{ data.prep_total | number }}</td>
          <td (click)="data.prep_completed > 0 && showNameList('prep_completed', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.prep_completed > 0}">{{ data.prep_completed | number }}</td>
          <td (click)="data.tandok > 0 && showNameList('tandok', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.tandok > 0}">{{ data.tandok | number }}</td>
          <td></td>
          <td></td>
          <td (click)="data.pep_completed > 0 && showNameList('pep_completed', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.pep_completed > 0}">{{ data.pep_completed | number }}</td>
          <td (click)="data.tcv > 0 && showNameList('tcv', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.tcv > 0}">{{ data.tcv | number }}</td>
          <td (click)="data.HRIG > 0 && showNameList('HRIG', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.HRIG > 0}">{{ data.HRIG | number }}</td>
          <td (click)="data.ERIG > 0 && showNameList('ERIG', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.ERIG > 0}">{{ data.ERIG | number }}</td>
          <td (click)="data.dog > 0 && showNameList('dog', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.dog > 0}">{{ data.dog | number }}</td>
          <td (click)="data.cat > 0 && showNameList('cat', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.cat > 0}">{{ data.cat | number }}</td>
          <td (click)="data.others > 0 && showNameList('others', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.others > 0}">{{ data.others | number }}</td>
          <td (click)="data.total_biting_animal > 0 && showNameList('total_biting_animal', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.total_biting_animal > 0}">{{ data.total_biting_animal | number }}</td>
          <td (click)="data.total_cat2_and_cat3_previous_quarter > 0 && showNameList('total_cat2_and_cat3_previous_quarter', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.total_cat2_and_cat3_previous_quarter > 0}">{{ data.total_cat2_and_cat3_previous_quarter | number }}</td>
          <td (click)="data.pep_completed_previous > 0 && showNameList('pep_completed_previous', 'non-catchment', data.code)" [ngClass]="{'cursor-pointer text-blue-500 font-semibold': data.pep_completed_previous > 0}">{{ data.pep_completed_previous | number }}</td>
          <td></td>
          <td></td>
        </ng-container>
    </tbody>
  </table>
</div>

<app-show-name-list
  *ngIf="openList"
  (toggleModal)="toggleModal()"
  [name_list_params]="name_list_params"
  [selectedBrgy]="selectedBrgy"
  [selectedCode]="selectedCode"
  [reportForm]="reportForm"
  [url]="url"
  [loc]="'itr'"
></app-show-name-list>
