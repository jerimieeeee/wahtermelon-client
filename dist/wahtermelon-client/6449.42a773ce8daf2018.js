"use strict";(self.webpackChunkwahtermelon_client=self.webpackChunkwahtermelon_client||[]).push([[6449],{6449:(tn,R,l)=>{l.r(R),l.d(R,{TbdotsModule:()=>We});var m=l(177),C=l(2517),p=l(5383),t=l(4438),h=l(3318),b=l(60),y=l(9217),j=l(9596),M=l(8588),w=l(2505),$=l(2038),E=l(9932),I=l(2101),s=l(9417),X=l(7468),v=l(5794),Y=l(3825);function H(n,a){if(1&n&&(t.j41(0,"option",20),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.Y8G("value",e.code),t.R7$(),t.JRh(e.desc)}}function S(n,a){if(1&n){const e=t.RV6();t.j41(0,"button",21),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.clearPreviousTreatmentForm())}),t.nrm(1,"fa-icon",13),t.EFF(2," Cancel "),t.k0s()}if(2&n){const e=t.XpG(2);t.R7$(),t.Y8G("icon",e.faXmark)}}function P(n,a){if(1&n){const e=t.RV6();t.j41(0,"tr",22)(1,"td",23),t.EFF(2),t.k0s(),t.j41(3,"td",23),t.EFF(4),t.nI1(5,"date"),t.k0s(),t.j41(6,"td",23)(7,"fa-icon",24),t.bIt("click",function(){const o=t.eBV(e).$implicit,r=t.XpG(2);return t.Njj(r.editPreviousTreatment(o))}),t.k0s(),t.j41(8,"fa-icon",25),t.bIt("click",function(){const o=t.eBV(e).$implicit,r=t.XpG(2);return t.Njj(r.toggleModal("delete-item",o))}),t.k0s()()()}if(2&n){const e=a.$implicit,i=t.XpG(2);t.R7$(2),t.SpI(" ",e.outcome.desc," "),t.R7$(2),t.SpI(" ",t.brH(5,4,e.treatment_date,"MM/dd/yyyy","Asia/Manila")," "),t.R7$(3),t.Y8G("icon",i.faEdit),t.R7$(),t.Y8G("icon",i.faTrashCan)}}function O(n,a){if(1&n){const e=t.RV6();t.j41(0,"div",2)(1,"div",3),t.EFF(2," History of TB Treatment "),t.k0s(),t.j41(3,"div",4)(4,"form",5),t.bIt("ngSubmit",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.savePreviousTreatment())}),t.j41(5,"div",6)(6,"div")(7,"label",7),t.EFF(8,"Treatment Outcome"),t.k0s(),t.j41(9,"select",8),t.DNE(10,H,2,2,"option",9),t.k0s()(),t.j41(11,"div")(12,"label",10),t.EFF(13,"Treatment Date"),t.k0s(),t.nrm(14,"input",11),t.k0s(),t.j41(15,"div")(16,"button",12),t.nrm(17,"fa-icon",13),t.EFF(18),t.k0s(),t.DNE(19,S,3,1,"button",14),t.k0s()()(),t.j41(20,"div",15)(21,"table",16)(22,"thead",17)(23,"tr")(24,"th",18),t.EFF(25,"Treatment Outcome"),t.k0s(),t.j41(26,"th",18),t.EFF(27,"Treatment Date"),t.k0s(),t.j41(28,"th",18),t.EFF(29,"Action"),t.k0s()()(),t.j41(30,"tbody"),t.DNE(31,P,9,8,"tr",19),t.k0s()()()()()}if(2&n){const e=t.XpG();t.R7$(4),t.Y8G("formGroup",e.previousTreatmentForm),t.R7$(6),t.Y8G("ngForOf",e.treatment_outcomes),t.R7$(4),t.Y8G("max",e.max_date),t.R7$(3),t.Y8G("icon",e.previousTreatmentForm.value.id?e.faEdit:e.faAdd),t.R7$(),t.SpI(" ",e.previousTreatmentForm.value.id?"Update":"Add"," "),t.R7$(),t.Y8G("ngIf",e.previousTreatmentForm.value.id),t.R7$(12),t.Y8G("ngForOf",e.previous_treatments)("ngForTrackBy",e.identify)}}function q(n,a){if(1&n&&(t.j41(0,"option",20),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.Y8G("value",e.code),t.R7$(),t.JRh(e.desc)}}function V(n,a){if(1&n&&(t.j41(0,"option",20),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.Y8G("value",e.code),t.R7$(),t.JRh(e.desc)}}function J(n,a){if(1&n&&(t.j41(0,"option",20),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.Y8G("value",e.code),t.R7$(),t.JRh(e.desc)}}function B(n,a){if(1&n&&(t.j41(0,"option",55),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.Y8G("ngValue","N"===e.code?0:1),t.R7$(),t.JRh(e.desc)}}function A(n,a){if(1&n&&(t.j41(0,"option",55),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.Y8G("ngValue","N"===e.code?0:1),t.R7$(),t.JRh(e.desc)}}function U(n,a){if(1&n&&(t.j41(0,"div",56),t.nrm(1,"input",57),t.j41(2,"label",58),t.EFF(3),t.k0s()()),2&n){const e=a.$implicit;t.R7$(),t.Y8G("id",e.code)("formControlName",e.code),t.R7$(),t.BMQ("for",e.code),t.R7$(),t.JRh(e.desc)}}function L(n,a){if(1&n&&(t.j41(0,"option",20),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.Y8G("value",e.code),t.R7$(),t.JRh(e.desc)}}function z(n,a){if(1&n&&(t.j41(0,"div")(1,"label"),t.EFF(2),t.k0s(),t.j41(3,"select",59),t.DNE(4,L,2,2,"option",9),t.k0s()()),2&n){const e=a.$implicit,i=t.XpG(2);t.R7$(),t.BMQ("for",e.code),t.R7$(),t.JRh(e.desc),t.R7$(),t.Y8G("id",e.code)("formControlName",e.code),t.R7$(),t.Y8G("ngForOf",i.pe_answers)}}function Q(n,a){if(1&n&&(t.j41(0,"div",60),t.nrm(1,"input",57),t.j41(2,"label",58),t.EFF(3),t.k0s()()),2&n){const e=a.$implicit,i=a.index;t.R7$(),t.Y8G("id","risk_factor"+(i+1))("formControlName","risk_factor"+(i+1)),t.R7$(),t.BMQ("for","risk_factor"+(i+1)),t.R7$(),t.JRh(e.desc)}}function Z(n,a){if(1&n&&t.nrm(0,"fa-icon",65),2&n){const e=t.XpG(3);t.Y8G("icon",e.faSave)}}function W(n,a){if(1&n&&t.nrm(0,"fa-icon",66),2&n){const e=t.XpG(3);t.Y8G("icon",e.faSpinner)}}function K(n,a){if(1&n&&(t.j41(0,"div",61)(1,"button",62),t.DNE(2,Z,1,1,"fa-icon",63)(3,W,1,1,"fa-icon",64),t.EFF(4),t.k0s()()),2&n){const e=t.XpG(2);t.R7$(),t.Y8G("disabled",e.casefindingForm.invalid||e.is_saving),t.R7$(),t.Y8G("ngIf",!e.is_saving),t.R7$(),t.Y8G("ngIf",e.is_saving),t.R7$(),t.SpI(" ",e.casefindingForm.value.id?e.is_saving?"Updating":"Update":e.is_saving?"Saving":"Save"," ")}}function tt(n,a){if(1&n){const e=t.RV6();t.j41(0,"div",2)(1,"div",3),t.EFF(2," Case Findings "),t.k0s(),t.j41(3,"div",26)(4,"form",27),t.bIt("ngSubmit",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.saveCaseFindings())}),t.j41(5,"div",28)(6,"div",29),t.EFF(7," Registration Details "),t.k0s(),t.j41(8,"div",6)(9,"div")(10,"label",30),t.EFF(11,"Patient Source"),t.k0s(),t.j41(12,"select",31),t.DNE(13,q,2,2,"option",9),t.k0s()(),t.j41(14,"div")(15,"label",32),t.EFF(16,"Registration Group"),t.k0s(),t.j41(17,"select",33),t.DNE(18,V,2,2,"option",9),t.k0s()(),t.j41(19,"div")(20,"label",34),t.EFF(21,"Consultation Date"),t.k0s(),t.nrm(22,"input",35),t.k0s()()(),t.j41(23,"div",36)(24,"div",37),t.EFF(25," Screening Data "),t.k0s(),t.j41(26,"div",6)(27,"div")(28,"label",38),t.EFF(29,"Previous TB Treatment"),t.k0s(),t.j41(30,"select",39),t.DNE(31,J,2,2,"option",9),t.k0s()(),t.j41(32,"div")(33,"label",40),t.EFF(34,"Exposure to TB"),t.k0s(),t.j41(35,"select",41),t.DNE(36,B,2,2,"option",42),t.k0s()(),t.j41(37,"div")(38,"label",43),t.EFF(39,"Presumptive DR-TB"),t.k0s(),t.j41(40,"select",44),t.DNE(41,A,2,2,"option",42),t.k0s()()()(),t.j41(42,"div",36)(43,"div",37),t.EFF(44," Symptoms "),t.k0s(),t.j41(45,"div",45),t.DNE(46,U,4,4,"div",46),t.k0s(),t.j41(47,"div",47)(48,"label",48),t.EFF(49,"Symptoms Remarks"),t.k0s(),t.nrm(50,"input",49),t.k0s()(),t.j41(51,"div",36)(52,"div",37),t.EFF(53," Physical Exam "),t.k0s(),t.j41(54,"div",50),t.DNE(55,z,5,5,"div",51),t.k0s()(),t.j41(56,"div",36)(57,"div",37),t.EFF(58," Risk Factor "),t.k0s(),t.j41(59,"div",52),t.DNE(60,Q,4,4,"div",53),t.k0s()(),t.DNE(61,K,5,4,"div",54),t.k0s()()()}if(2&n){const e=t.XpG();t.R7$(4),t.Y8G("formGroup",e.casefindingForm),t.R7$(9),t.Y8G("ngForOf",e.patient_sources),t.R7$(5),t.Y8G("ngForOf",e.reg_groups),t.R7$(4),t.Y8G("max",e.max_date),t.R7$(9),t.Y8G("ngForOf",e.previous_tb_treatments),t.R7$(5),t.Y8G("ngForOf",e.answers_yn),t.R7$(5),t.Y8G("ngForOf",e.answers_yn),t.R7$(5),t.Y8G("ngForOf",e.symptoms),t.R7$(9),t.Y8G("ngForOf",e.pes),t.R7$(5),t.Y8G("ngForOf",e.risk_factors),t.R7$(),t.Y8G("ngIf",!e.selected_tb_consult||0===e.selected_tb_consult.treatment_done)}}function et(n,a){if(1&n){const e=t.RV6();t.j41(0,"app-delete-item",67),t.bIt("toggleModal",function(o){t.eBV(e);const r=t.XpG();return t.Njj(r.toggleModal(o))}),t.k0s()}if(2&n){const e=t.XpG();t.Y8G("delete_id",e.delete_id)("delete_desc",e.delete_desc)("url",e.url)}}let nt=(()=>{class n{createForm(){this.previousTreatmentForm=this.formBuilder.nonNullable.group({id:[null],patient_id:[this.patient_id],outcome_code:[null,s.k0.required],treatment_date:[null,s.k0.required]}),this.casefindingForm=this.formBuilder.nonNullable.group({id:[null],patient_id:[this.patient_id],source_code:["",s.k0.required],reg_group_code:["",s.k0.required],consult_date:["",s.k0.required],previous_tb_treatment_code:["",s.k0.required],exposetb_flag:["",s.k0.required],drtb_flag:["",s.k0.required],risk_factor1:[!1],risk_factor2:[!1],risk_factor3:[!1],symptom:this.formBuilder.group({bcpain:[!1],cough:[!1],drest:[!1],dexertion:[!1],fever:[!1],hemoptysis:[!1],nsweats:[!1],pedema:[!1],wloss:[!1]}),symptom_remarks:[null],physical_exam:this.formBuilder.group({abdomen:["ND",s.k0.required],amuscles:["ND",s.k0.required],bcg:["ND",s.k0.required],cardiovascular:["ND",s.k0.required],endocrine:["ND",s.k0.required],extremities:["ND",s.k0.required],ghealth:["ND",s.k0.required],gurinary:["ND",s.k0.required],lnodes:["ND",s.k0.required],neurological:["ND",s.k0.required],oropharynx:["ND",s.k0.required],skin:["ND",s.k0.required],thoraxlungs:["ND",s.k0.required]})}),this.loadPreviousTreatment(),this.loadCaseFinding()}identify(e,i){return i.id}loadPreviousTreatment(){this.http.get("tbdots/patient-tb-history",{params:{patient_id:this.patient_id,per_page:"all"}}).subscribe({next:i=>{this.previous_treatments=i.data},error:i=>console.log(i)})}loadCaseFinding(){if(this.selected_tb_consult){let e=this.selected_tb_consult;this.case_finding_id=e.case_finding.id,this.casefindingForm.patchValue({...e.case_finding}),this.casefindingForm.patchValue({symptom:e.symptom?{...e.symptom}:null,physical_exam:e.physical_exam?{...e.physical_exam}:null,id:e.id,source_code:e.case_finding.source_code.code,reg_group_code:e.case_finding.reg_group.code,previous_tb_treatment_code:e.case_finding.previous_tb_treatment_code.code})}}savePreviousTreatment(){let e;e=this.previousTreatmentForm.value.id?this.http.update("tbdots/patient-tb-history/",this.previousTreatmentForm.value.id,this.previousTreatmentForm.value):this.http.post("tbdots/patient-tb-history",this.previousTreatmentForm.value),e.subscribe({next:i=>{this.loadPreviousTreatment(),this.previousTreatmentForm.reset()},error:i=>console.log(i)})}clearPreviousTreatmentForm(){this.previousTreatmentForm.reset()}editPreviousTreatment(e){this.previousTreatmentForm.patchValue({id:e.id,patient_id:e.patient_id,outcome_code:e.outcome.code,treatment_date:e.treatment_date})}saveCaseFindings(){if(this.is_saving=!0,this.casefindingForm.dirty){let e;e=this.casefindingForm.value.id?this.http.update("tbdots/patient-tb-casefinding/",this.case_finding_id,this.casefindingForm.value):this.http.post("tbdots/patient-tb",this.casefindingForm.value),e.subscribe({next:i=>{this.saveSymptomsPe(this.casefindingForm.value.id?this.casefindingForm.value.id:i.data.patient_tb_id,this.casefindingForm.value.patient_id)},error:i=>{console.log(i),this.is_saving=!1}})}else this.toastr.info("No changes were made."),this.is_saving=!1}saveSymptomsPe(e,i){let o={...this.casefindingForm.value.symptom};o.patient_id=i,o.patient_tb_id=e;const r=this.http.post("tbdots/patient-tb-symptom",o);let _={...this.casefindingForm.value.physical_exam};_.patient_id=i,_.patient_tb_id=e;const c=this.http.post("tbdots/patient-tb-pe",_);(0,X.p)([r,c]).subscribe(([d,g])=>{this.is_saving=!1,this.toastr.success("Case findings was "+(this.casefindingForm.value.id?"updated":"saved")+" successfully","Success"),this.getPatientTbHistory.emit()})}loadLibraries(){this.http.get("tbdots/tb-libraries").subscribe({next:e=>{this.answers_yn=e.tb_answers_yn,this.patient_sources=e.tb_patient_sources,this.pe_answers=e.tb_pe_answers,this.pes=e.tb_pes,this.previous_tb_treatments=e.tb_previous_tb_treatments,this.reg_groups=e.tb_reg_groups,this.risk_factors=e.tb_risk_factors,this.symptoms=e.tb_symptoms,this.treatment_outcomes=e.tb_treatment_outcomes,this.show_form=!0,this.createForm()},error:e=>console.log(e)})}toggleModal(e,i){this.modals[e]=!this.modals[e],"delete-item"===e&&(!0===this.modals[e]?(this.delete_id=i.id,this.delete_desc="Previous Treatment Record",this.url="tbdots/patient-tb-history/"):(this.delete_id=null,this.delete_desc=null,this.url=null,this.loadPreviousTreatment()))}constructor(e,i,o){this.http=e,this.formBuilder=i,this.toastr=o,this.getPatientTbHistory=new t.bkB,this.faSave=p.hSh,this.faAdd=p.vkJ,this.faEdit=p.MT7,this.faXmark=p.Jyw,this.faTrashCan=p.sjs,this.faSpinner=p.z1G,this.is_saving=!1,this.modals=[],this.previousTreatmentForm=new s.gE({id:new s.MJ(""),patient_id:new s.MJ(""),outcome_code:new s.MJ(""),treatment_date:new s.MJ("")}),this.casefindingForm=new s.gE({id:new s.MJ(""),patient_id:new s.MJ(""),patient_source:new s.MJ(""),reg_group:new s.MJ(""),consult_date:new s.MJ(""),previous_tb_treatment:new s.MJ(""),tb_exposure:new s.MJ(""),presumptive_drtb:new s.MJ(""),C:new s.MJ(!1),H:new s.MJ(!1),NC:new s.MJ(!1),symptom:new s.gE({bcpain:new s.MJ(!1),cough:new s.MJ(!1),drest:new s.MJ(!1),dexertion:new s.MJ(!1),fever:new s.MJ(!1),hemoptysis:new s.MJ(!1),nsweats:new s.MJ(!1),pedema:new s.MJ(!1),wloss:new s.MJ(!1)}),symptom_remarks:new s.MJ(""),physical_exam:new s.gE({abdomen:new s.MJ("ND"),amuscles:new s.MJ("ND"),bcg:new s.MJ("ND"),cardiovascular:new s.MJ("ND"),endocrine:new s.MJ("ND"),extremities:new s.MJ("ND"),ghealth:new s.MJ("ND"),gurinary:new s.MJ("ND"),lnodes:new s.MJ("ND"),neurological:new s.MJ("ND"),oropharynx:new s.MJ("ND"),skin:new s.MJ("ND"),thoraxlungs:new s.MJ("ND")})}),this.previous_treatments=[],this.answers_yn=[],this.patient_sources=[],this.pe_answers=[],this.pes=[],this.previous_tb_treatments=[],this.reg_groups=[],this.risk_factors=[],this.symptoms=[],this.treatment_outcomes=[],this.show_form=!1}ngOnInit(){this.loadLibraries()}static{this.\u0275fac=function(i){return new(i||n)(t.rXU(h.k),t.rXU(s.ok),t.rXU(v.tw))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-casefindings"]],inputs:{patient_id:"patient_id",selected_tb_consult:"selected_tb_consult",max_date:"max_date"},outputs:{getPatientTbHistory:"getPatientTbHistory"},standalone:!1,decls:3,vars:3,consts:[["class","m-5 border border-slate-200 rounded-lg",4,"ngIf"],[3,"delete_id","delete_desc","url","toggleModal",4,"ngIf"],[1,"m-5","border","border-slate-200","rounded-lg"],[1,"bg-blue-500","text-white","rounded-t-md","py-2","pl-3","font-semibold"],[1,"m-5"],[1,"grid","grid-cols-3","gap-x-4","w-4/5","mx-auto",3,"ngSubmit","formGroup"],[1,"mx-5","col-span-3","grid","grid-cols-3","gap-x-4"],["for","outcome_code"],["name","outcome_code","id","outcome_code","formControlName","outcome_code",1,"input"],[3,"value",4,"ngFor","ngForOf"],["for","treatment_date"],["type","date","name","treatment_date","id","treatment_date","formControlName","treatment_date",1,"input",3,"max"],["type","submit",1,"bg-blue-500","rounded","text-white","px-5","py-2","mt-7","text-sm"],[3,"icon"],["type","button","class","ml-3 bg-orange-500 rounded text-white px-5 py-2 mt-7 text-sm",3,"click",4,"ngIf"],[1,"w-full","flex","justify-center"],[1,"w-4/5","text-sm","text-left","mt-5","mx-10"],[1,"text-xs","text-white","uppercase","bg-blue-500"],["scope","col",1,"py-3","px-6"],["class","bg-white border-b",4,"ngFor","ngForOf","ngForTrackBy"],[3,"value"],["type","button",1,"ml-3","bg-orange-500","rounded","text-white","px-5","py-2","mt-7","text-sm",3,"click"],[1,"bg-white","border-b"],[1,"py-4","px-6"],[1,"mx-0","my-0","text-orange-400","hover:cursor-pointer","flex-none","mr-2",3,"click","icon"],[1,"mx-0","my-0","text-red-500","hover:cursor-pointer","flex-none","mr-2",3,"click","icon"],[1,"mx-5","mb-5"],[3,"ngSubmit","formGroup"],[1,"grid","grid-cols-3","gap-x-4","w-full"],[1,"col-span-3","border-b","border-slate-200","w-full","my-2","font-semibold","text-sky-500"],["for","source_code"],["name","source_code","id","source_code","formControlName","source_code",1,"input"],["for","reg_group_code"],["name","reg_group_code","id","reg_group_code","formControlName","reg_group_code",1,"input"],["for","consult_date"],["type","date","name","consult_date","id","consult_date","formControlName","consult_date",1,"input",3,"max"],[1,"mt-1","grid","grid-cols-3","gap-x-4","w-full"],[1,"col-span-3","border-b","border-slate-200","w-full","my-2","pt-3","font-semibold","text-sky-500"],["for","previous_tb_treatment_code"],["name","previous_tb_treatment_code","id","previous_tb_treatment_code","formControlName","previous_tb_treatment_code",1,"input"],["for","exposetb_flag"],["name","exposetb_flag","id","exposetb_flag","formControlName","exposetb_flag",1,"input"],[3,"ngValue",4,"ngFor","ngForOf"],["for","drtb_flag"],["name","drtb_flag","id","drtb_flag","formControlName","drtb_flag",1,"input"],["formGroupName","symptom",1,"col-span-3","grid","grid-cols-3","gap-x-4","mx-5"],["class","col-span-1",4,"ngFor","ngForOf"],[1,"col-span-3","mx-5","mt-3"],["for","symptom_remarks"],["type","text","name","symptom_remarks","id","symptom_remarks","formControlName","symptom_remarks",1,"input"],["formGroupName","physical_exam",1,"col-span-3","grid","grid-cols-3","gap-x-4","mx-5"],[4,"ngFor","ngForOf"],[1,"col-span-3","grid","grid-cols-3","gap-x-4","mx-5"],["class","col-span-3",4,"ngFor","ngForOf"],["class","flex justify-center mt-5",4,"ngIf"],[3,"ngValue"],[1,"col-span-1"],["type","checkbox",1,"border","border-slate-500","rounded","mr-3",3,"id","formControlName"],[1,"font-normal"],[1,"input",3,"id","formControlName"],[1,"col-span-3"],[1,"flex","justify-center","mt-5"],["type","submit",1,"btn-save","mr-5","mt-4",3,"disabled"],["class","mr-2",3,"icon",4,"ngIf"],["animation","spin","class","mr-2",3,"icon",4,"ngIf"],[1,"mr-2",3,"icon"],["animation","spin",1,"mr-2",3,"icon"],[3,"toggleModal","delete_id","delete_desc","url"]],template:function(i,o){1&i&&t.DNE(0,O,32,8,"div",0)(1,tt,62,11,"div",0)(2,et,1,3,"app-delete-item",1),2&i&&(t.Y8G("ngIf",o.show_form),t.R7$(),t.Y8G("ngIf",o.show_form),t.R7$(),t.Y8G("ngIf",o.modals["delete-item"]))},dependencies:[m.Sq,m.bT,b.aY,s.qT,s.xH,s.y7,s.me,s.Zm,s.wz,s.BC,s.cb,s.j4,s.JD,s.$R,Y.c,m.vh],styles:[".date-style[_ngcontent-%COMP%], .drop_btn[_ngcontent-%COMP%], li[_ngcontent-%COMP%]{padding-right:12px;padding-left:12px;height:2.25rem;width:100%}.icon-height[_ngcontent-%COMP%]{height:2.25rem}.colButton[_ngcontent-%COMP%]{padding-bottom:-500px}.remarks[_ngcontent-%COMP%]{min-height:6rem;max-height:12rem;width:100%}label[_ngcontent-%COMP%]{padding-top:.15rem;padding-bottom:.25rem;font-size:.875rem;line-height:1.25rem;font-weight:700;-webkit-user-select:none;user-select:none;color:#5c5c5c}label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#5c5c5c}input[type=radio][_ngcontent-%COMP%]:indeterminate + h2[_ngcontent-%COMP%]{color:orange}.containers[_ngcontent-%COMP%]{max-height:100vh}h3[_ngcontent-%COMP%]{color:#5c5c5c;padding-top:.15rem;padding-bottom:.25rem;font-size:.875rem;line-height:1.25rem;font-weight:700}@keyframes _ngcontent-%COMP%_bounce{0%,to{transform:translateY(-5%);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:translateY(5%);animation-timing-function:cubic-bezier(0,0,.2,1)}}@keyframes _ngcontent-%COMP%_type_in{0%{width:0}to{width:100%}}@keyframes _ngcontent-%COMP%_button_in{0%{width:22%}to{width:100%}}@keyframes _ngcontent-%COMP%_type_out{0%{width:100%}to{width:0}}.typed-out[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;animation:_ngcontent-%COMP%_type_in .68s ease-in-out forwards;width:0}.button-out[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;animation:_ngcontent-%COMP%_button_in .68s ease-in-out forwards}.parent[_ngcontent-%COMP%]{width:100%;display:flex;flex-wrap:wrap}.parent[_ngcontent-%COMP%] > .wife[_ngcontent-%COMP%]{flex:1 1 100%}.parent[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:1 1 33.3333%}"]})}}return n})();const u=n=>({"text-red-500":n}),f=n=>({"invalid-input":n});function ot(n,a){if(1&n&&(t.j41(0,"option",20),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.Y8G("value",e.code),t.R7$(),t.JRh(e.desc)}}function it(n,a){if(1&n&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(3);t.R7$(),t.SpI(" ",e.required_message," ")}}function st(n,a){if(1&n&&(t.j41(0,"div",21),t.DNE(1,it,2,1,"div",16),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.Y8G("ngIf",null==e.f.enroll_as_code.errors?null:e.f.enroll_as_code.errors.required)}}function at(n,a){if(1&n&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(3);t.R7$(),t.SpI(" ",e.required_message," ")}}function rt(n,a){1&n&&(t.j41(0,"div"),t.EFF(1," Only letters and numbers are allowed. "),t.k0s())}function _t(n,a){if(1&n&&(t.j41(0,"div",21),t.DNE(1,at,2,1,"div",16)(2,rt,2,0,"div",16),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.Y8G("ngIf",null==e.f.case_number.errors?null:e.f.case_number.errors.required),t.R7$(),t.Y8G("ngIf",null==e.f.case_number.errors?null:e.f.case_number.errors.pattern)}}function ct(n,a){if(1&n&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(3);t.R7$(),t.SpI(" ",e.required_message," ")}}function lt(n,a){if(1&n&&(t.j41(0,"div",21),t.DNE(1,ct,2,1,"div",16),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.Y8G("ngIf",null==e.f.registration_date.errors?null:e.f.registration_date.errors.required)}}function dt(n,a){if(1&n&&(t.j41(0,"option",20),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.Y8G("value",e.code),t.R7$(),t.JRh(e.desc)}}function mt(n,a){if(1&n&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(4);t.R7$(),t.SpI(" ",e.required_message," ")}}function pt(n,a){if(1&n&&(t.j41(0,"div",21),t.DNE(1,mt,2,1,"div",16),t.k0s()),2&n){const e=t.XpG(3);t.R7$(),t.Y8G("ngIf",null==e.f.ipt_type_code.errors?null:e.f.ipt_type_code.errors.required)}}function ut(n,a){if(1&n&&(t.j41(0,"div")(1,"label",22),t.EFF(2,"Exposure or Infection"),t.k0s(),t.j41(3,"select",23),t.DNE(4,dt,2,2,"option",10),t.k0s(),t.DNE(5,pt,2,1,"div",11),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(4,u,e.show_error&&e.f.ipt_type_code.errors)),t.R7$(2),t.Y8G("ngClass",t.eq3(6,f,e.show_error&&e.f.ipt_type_code.errors)),t.R7$(),t.Y8G("ngForOf",e.tb_ipt_types),t.R7$(),t.Y8G("ngIf",e.show_error&&e.f.ipt_type_code.errors)}}function ft(n,a){if(1&n&&(t.j41(0,"option",20),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.Y8G("value",e.code),t.R7$(),t.JRh(e.desc)}}function gt(n,a){if(1&n&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(4);t.R7$(),t.SpI(" ",e.required_message," ")}}function bt(n,a){if(1&n&&(t.j41(0,"div",21),t.DNE(1,gt,2,1,"div",16),t.k0s()),2&n){const e=t.XpG(3);t.R7$(),t.Y8G("ngIf",null==e.f.treatment_regimen_code.errors?null:e.f.treatment_regimen_code.errors.required)}}function ht(n,a){if(1&n&&(t.j41(0,"div")(1,"label",24),t.EFF(2,"Treatment Regimen"),t.k0s(),t.j41(3,"select",25),t.DNE(4,ft,2,2,"option",10),t.k0s(),t.DNE(5,bt,2,1,"div",11),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(4,u,e.show_error&&e.f.treatment_regimen_code.errors)),t.R7$(2),t.Y8G("ngClass",t.eq3(6,f,e.show_error&&e.f.treatment_regimen_code.errors)),t.R7$(),t.Y8G("ngForOf",e.tb_treatment_regimens),t.R7$(),t.Y8G("ngIf",e.show_error&&e.f.treatment_regimen_code.errors)}}function vt(n,a){if(1&n&&(t.j41(0,"option",20),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.Y8G("value",e.code),t.R7$(),t.JRh(e.desc)}}function Ct(n,a){if(1&n&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(4);t.R7$(),t.SpI(" ",e.required_message," ")}}function Ft(n,a){if(1&n&&(t.j41(0,"div",21),t.DNE(1,Ct,2,1,"div",16),t.k0s()),2&n){const e=t.XpG(3);t.R7$(),t.Y8G("ngIf",null==e.f.bacteriological_status_code.errors?null:e.f.bacteriological_status_code.errors.required)}}function xt(n,a){if(1&n&&(t.j41(0,"div",26)(1,"label",27),t.EFF(2,"Bacteriological Status"),t.k0s(),t.j41(3,"select",28),t.DNE(4,vt,2,2,"option",10),t.k0s(),t.DNE(5,Ft,2,1,"div",11),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(4,u,e.show_error&&e.f.bacteriological_status_code.errors)),t.R7$(2),t.Y8G("ngClass",t.eq3(6,f,e.show_error&&e.f.bacteriological_status_code.errors)),t.R7$(),t.Y8G("ngForOf",e.tb_bacteriological_statuses),t.R7$(),t.Y8G("ngIf",e.show_error&&e.f.bacteriological_status_code.errors)}}function kt(n,a){if(1&n&&(t.j41(0,"option",20),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.Y8G("value",e.code),t.R7$(),t.JRh(e.desc)}}function Tt(n,a){if(1&n&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(4);t.R7$(),t.SpI(" ",e.required_message," ")}}function Gt(n,a){if(1&n&&(t.j41(0,"div",21),t.DNE(1,Tt,2,1,"div",16),t.k0s()),2&n){const e=t.XpG(3);t.R7$(),t.Y8G("ngIf",null==e.f.anatomical_site_code.errors?null:e.f.anatomical_site_code.errors.required)}}function Rt(n,a){if(1&n){const e=t.RV6();t.j41(0,"div")(1,"label",29),t.EFF(2,"Anatomical Site"),t.k0s(),t.j41(3,"select",30),t.bIt("change",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.eptbSite())}),t.DNE(4,kt,2,2,"option",10),t.k0s(),t.DNE(5,Gt,2,1,"div",11),t.k0s()}if(2&n){const e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(4,u,e.show_error&&e.f.anatomical_site_code.errors)),t.R7$(2),t.Y8G("ngClass",t.eq3(6,f,e.show_error&&e.f.anatomical_site_code.errors)),t.R7$(),t.Y8G("ngForOf",e.tb_anatomical_sites),t.R7$(),t.Y8G("ngIf",e.show_error&&e.f.anatomical_site_code.errors)}}function yt(n,a){if(1&n&&(t.j41(0,"option",20),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.Y8G("value",e.id),t.R7$(),t.JRh(e.desc)}}function jt(n,a){if(1&n&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(4);t.R7$(),t.SpI(" ",e.required_message," ")}}function wt(n,a){if(1&n&&(t.j41(0,"div",21),t.DNE(1,jt,2,1,"div",16),t.k0s()),2&n){const e=t.XpG(3);t.R7$(),t.Y8G("ngIf",null==e.f.eptb_site_id.errors?null:e.f.eptb_site_id.errors.required)}}function $t(n,a){if(1&n){const e=t.RV6();t.j41(0,"div")(1,"label",31),t.EFF(2,"EPTB Site"),t.k0s(),t.j41(3,"select",32),t.bIt("change",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.specificSite())}),t.DNE(4,yt,2,2,"option",10),t.k0s(),t.DNE(5,wt,2,1,"div",11),t.k0s()}if(2&n){const e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(4,u,e.show_error&&e.f.eptb_site_id.errors)),t.R7$(2),t.Y8G("ngClass",t.eq3(6,f,e.show_error&&e.f.eptb_site_id.errors)),t.R7$(),t.Y8G("ngForOf",e.tb_eptb_sites),t.R7$(),t.Y8G("ngIf",e.show_error&&e.f.eptb_site_id.errors)}}function Et(n,a){if(1&n&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(4);t.R7$(),t.SpI(" ",e.required_message," ")}}function It(n,a){if(1&n&&(t.j41(0,"div",21),t.DNE(1,Et,2,1,"div",16),t.k0s()),2&n){const e=t.XpG(3);t.R7$(),t.Y8G("ngIf",null==e.f.specific_site.errors?null:e.f.specific_site.errors.required)}}function Yt(n,a){if(1&n&&(t.j41(0,"div")(1,"label",33),t.EFF(2,"EPTB Site Specific"),t.k0s(),t.nrm(3,"input",34),t.DNE(4,It,2,1,"div",11),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(3,u,e.show_error&&e.f.specific_site.errors)),t.R7$(2),t.Y8G("ngClass",t.eq3(5,f,e.show_error&&e.f.specific_site.errors)),t.R7$(),t.Y8G("ngIf",e.show_error&&e.f.specific_site.errors)}}function Nt(n,a){if(1&n&&(t.j41(0,"option",38),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.Y8G("ngValue","N"===e.code?0:1),t.R7$(),t.JRh(e.desc)}}function Dt(n,a){if(1&n&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(4);t.R7$(),t.SpI(" ",e.required_message," ")}}function Mt(n,a){if(1&n&&(t.j41(0,"div",21),t.DNE(1,Dt,2,1,"div",16),t.k0s()),2&n){const e=t.XpG(3);t.R7$(),t.Y8G("ngIf",null==e.f.drug_resistant_flag.errors?null:e.f.drug_resistant_flag.errors.required)}}function Xt(n,a){if(1&n&&(t.j41(0,"div")(1,"label",35),t.EFF(2,"Drug Resistant (RR/MDR-TB)"),t.k0s(),t.j41(3,"select",36),t.DNE(4,Nt,2,2,"option",37),t.k0s(),t.DNE(5,Mt,2,1,"div",11),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.eq3(4,u,e.show_error&&e.f.drug_resistant_flag.errors)),t.R7$(2),t.Y8G("ngClass",t.eq3(6,f,e.show_error&&e.f.drug_resistant_flag.errors)),t.R7$(),t.Y8G("ngForOf",e.tb_answers_yn),t.R7$(),t.Y8G("ngIf",e.show_error&&e.f.drug_resistant_flag.errors)}}function Ht(n,a){if(1&n&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(4);t.R7$(),t.SpI(" ",e.required_message," ")}}function St(n,a){if(1&n&&(t.j41(0,"div",21),t.DNE(1,Ht,2,1,"div",16),t.k0s()),2&n){const e=t.XpG(3);t.R7$(),t.Y8G("ngIf",null==e.f.treatment_start.errors?null:e.f.treatment_start.errors.required)}}function Pt(n,a){if(1&n&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(4);t.R7$(),t.SpI(" ",e.required_message," ")}}function Ot(n,a){if(1&n&&(t.j41(0,"div",21),t.DNE(1,Pt,2,1,"div",16),t.k0s()),2&n){const e=t.XpG(3);t.R7$(),t.Y8G("ngIf",null==e.f.continuation_start.errors?null:e.f.continuation_start.errors.required)}}function qt(n,a){if(1&n&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(4);t.R7$(),t.SpI(" ",e.required_message," ")}}function Vt(n,a){if(1&n&&(t.j41(0,"div",21),t.DNE(1,qt,2,1,"div",16),t.k0s()),2&n){const e=t.XpG(3);t.R7$(),t.Y8G("ngIf",null==e.f.treatment_end.errors?null:e.f.treatment_end.errors.required)}}function Jt(n,a){if(1&n&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(5);t.R7$(),t.SpI(" ",e.required_message," ")}}function Bt(n,a){if(1&n&&(t.j41(0,"div",21),t.DNE(1,Jt,2,1,"div",16),t.k0s()),2&n){const e=t.XpG(4);t.R7$(),t.Y8G("ngIf",null==e.f.pict_date.errors?null:e.f.pict_date.errors.required)}}function At(n,a){if(1&n&&(t.j41(0,"div")(1,"label",48),t.EFF(2,"PICT Date"),t.k0s(),t.nrm(3,"input",49),t.DNE(4,Bt,2,1,"div",11),t.k0s()),2&n){const e=t.XpG(3);t.R7$(),t.Y8G("ngClass",t.eq3(3,u,e.show_error&&e.f.pict_date.errors)),t.R7$(2),t.Y8G("ngClass",t.eq3(5,f,e.show_error&&e.f.pict_date.errors)),t.R7$(),t.Y8G("ngIf",e.show_error&&e.f.pict_date.errors)}}function Ut(n,a){if(1&n){const e=t.RV6();t.j41(0,"div",39)(1,"div",40),t.EFF(2," Important Dates "),t.k0s(),t.j41(3,"div",41)(4,"div")(5,"label",42),t.EFF(6,"Treatment Start Date"),t.k0s(),t.j41(7,"input",43),t.bIt("change",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.getContinuationDate())}),t.k0s(),t.DNE(8,St,2,1,"div",11),t.k0s(),t.j41(9,"div")(10,"label",44),t.EFF(11,"Continuation Date"),t.k0s(),t.nrm(12,"input",45),t.DNE(13,Ot,2,1,"div",11),t.k0s(),t.j41(14,"div")(15,"label",46),t.EFF(16,"Treatment End Date"),t.k0s(),t.nrm(17,"input",47),t.DNE(18,Vt,2,1,"div",11),t.k0s(),t.DNE(19,At,5,7,"div",16),t.k0s()()}if(2&n){const e=t.XpG(2);t.R7$(5),t.Y8G("ngClass",t.eq3(10,u,e.show_error&&e.f.treatment_start.errors)),t.R7$(2),t.Y8G("ngClass",t.eq3(12,f,e.show_error&&e.f.treatment_start.errors)),t.R7$(),t.Y8G("ngIf",e.show_error&&e.f.treatment_start.errors),t.R7$(2),t.Y8G("ngClass",t.eq3(14,u,e.show_error&&e.f.continuation_start.errors)),t.R7$(2),t.Y8G("ngClass",t.eq3(16,f,e.show_error&&e.f.continuation_start.errors)),t.R7$(),t.Y8G("ngIf",e.show_error&&e.f.continuation_start.errors),t.R7$(2),t.Y8G("ngClass",t.eq3(18,u,e.show_error&&e.f.treatment_end.errors)),t.R7$(2),t.Y8G("ngClass",t.eq3(20,f,e.show_error&&e.f.treatment_end.errors)),t.R7$(),t.Y8G("ngIf",e.show_error&&e.f.treatment_end.errors),t.R7$(),t.Y8G("ngIf",e.f.pict_date.enabled)}}function Lt(n,a){if(1&n&&t.nrm(0,"fa-icon",54),2&n){const e=t.XpG(3);t.Y8G("icon",e.faSave)}}function zt(n,a){if(1&n&&t.nrm(0,"fa-icon",55),2&n){const e=t.XpG(3);t.Y8G("icon",e.faCircleNotch)}}function Qt(n,a){if(1&n&&(t.j41(0,"div",50)(1,"button",51),t.DNE(2,Lt,1,1,"fa-icon",52)(3,zt,1,1,"fa-icon",53),t.EFF(4),t.k0s()()),2&n){const e=t.XpG(2);t.R7$(),t.Y8G("disabled",e.is_saving),t.R7$(),t.Y8G("ngIf",!e.is_saving),t.R7$(),t.Y8G("ngIf",e.is_saving),t.R7$(),t.SpI(" ",e.caseHoldingForm.value.id?e.is_saving?"Updating":"Update":e.is_saving?"Saving":"Save"," ")}}function Zt(n,a){if(1&n){const e=t.RV6();t.j41(0,"div",1)(1,"div",2),t.EFF(2," Treatment Form "),t.k0s(),t.j41(3,"div",3)(4,"form",4),t.bIt("ngSubmit",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.saveCaseFindings())}),t.j41(5,"div",5)(6,"div",6),t.EFF(7," Enrollment Details "),t.k0s(),t.j41(8,"div",7)(9,"div")(10,"label",8),t.EFF(11,"Enrolled As"),t.k0s(),t.j41(12,"select",9),t.bIt("change",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.checkForm())}),t.DNE(13,ot,2,2,"option",10),t.k0s(),t.DNE(14,st,2,1,"div",11),t.k0s(),t.j41(15,"div")(16,"label",12),t.EFF(17,"Case Number"),t.k0s(),t.nrm(18,"input",13),t.DNE(19,_t,3,2,"div",11),t.k0s(),t.j41(20,"div")(21,"label",14),t.EFF(22,"Registration Date"),t.k0s(),t.nrm(23,"input",15),t.DNE(24,lt,2,1,"div",11),t.k0s(),t.DNE(25,ut,6,8,"div",16)(26,ht,6,8,"div",16)(27,xt,6,8,"div",17)(28,Rt,6,8,"div",16)(29,$t,6,8,"div",16)(30,Yt,5,7,"div",16)(31,Xt,6,8,"div",16),t.k0s()(),t.DNE(32,Ut,20,22,"div",18)(33,Qt,5,4,"div",19),t.k0s()()()}if(2&n){const e=t.XpG();t.R7$(4),t.Y8G("formGroup",e.caseHoldingForm),t.R7$(6),t.Y8G("ngClass",t.eq3(21,u,e.show_error&&e.f.enroll_as_code.errors)),t.R7$(2),t.Y8G("ngClass",t.eq3(23,f,e.show_error&&e.f.enroll_as_code.errors)),t.R7$(),t.Y8G("ngForOf",e.tb_enroll_as),t.R7$(),t.Y8G("ngIf",e.show_error&&e.f.enroll_as_code.errors),t.R7$(2),t.Y8G("ngClass",t.eq3(25,u,e.show_error&&e.f.case_number.errors)),t.R7$(2),t.Y8G("ngClass",t.eq3(27,f,e.show_error&&e.f.case_number.errors)),t.R7$(),t.Y8G("ngIf",e.show_error&&e.f.case_number.errors),t.R7$(2),t.Y8G("ngClass",t.eq3(29,u,e.show_error&&e.f.registration_date.errors)),t.R7$(2),t.Y8G("max",e.max_date)("ngClass",t.eq3(31,f,e.show_error&&e.f.registration_date.errors)),t.R7$(),t.Y8G("ngIf",e.show_error&&e.f.registration_date.errors),t.R7$(),t.Y8G("ngIf",e.f.ipt_type_code.enabled),t.R7$(),t.Y8G("ngIf",e.f.treatment_regimen_code.enabled),t.R7$(),t.Y8G("ngIf",e.f.bacteriological_status_code.enabled),t.R7$(),t.Y8G("ngIf",e.f.anatomical_site_code.enabled),t.R7$(),t.Y8G("ngIf",e.f.eptb_site_id.enabled),t.R7$(),t.Y8G("ngIf",e.f.specific_site.enabled),t.R7$(),t.Y8G("ngIf",e.f.drug_resistant_flag.enabled),t.R7$(),t.Y8G("ngIf",e.f.enroll_as_code.value),t.R7$(),t.Y8G("ngIf",!e.selected_tb_consult||0===e.selected_tb_consult.treatment_done)}}let Wt=(()=>{class n{saveCaseFindings(){this.is_saving=!0,this.caseHoldingForm.valid?this.http.post("tbdots/patient-tb-caseholding",this.caseHoldingForm.value).subscribe({next:()=>{this.showToastr("success","Recorded successfully","Case Holding"),this.getPatientTbHistory.emit()},error:e=>console.log(e)}):(this.show_error=!0,this.showToastr("error","Form invalid or incomplete","Error"))}showToastr(e,i,o){this.toastr[e](i,o),this.is_saving=!1}getContinuationDate(){let e=new Date(this.caseHoldingForm.value.treatment_start);e.setDate(e.getDate()+56),this.caseHoldingForm.patchValue({continuation_start:(0,m.Yq)(e,"yyyy-MM-dd","en","Asia/Manila")}),this.getTreatmentEnd()}getTreatmentEnd(){let e=new Date(this.caseHoldingForm.value.continuation_start);e.setDate(e.getDate()+111),this.caseHoldingForm.patchValue({treatment_end:(0,m.Yq)(e,"yyyy-MM-dd","en","Asia/Manila")})}get f(){return this.caseHoldingForm.controls}loadCaseHolding(){if(this.selected_tb_consult){let e=this.selected_tb_consult;e.case_holding&&(this.caseHoldingForm.patchValue({...e.case_holding}),this.caseHoldingForm.patchValue({id:e.id,enroll_as_code:e.case_holding.enroll_as.code,treatment_regimen_code:e.case_holding.treatment_regimen?e.case_holding.treatment_regimen.code:null,bacteriological_status_code:e.case_holding.bacteriological_status?e.case_holding.bacteriological_status.code:null,anatomical_site_code:e.case_holding.anatomical_site?e.case_holding.anatomical_site.code:null,eptb_site_id:e.case_holding.eptb_site?e.case_holding.eptb_site.id:null}))}this.show_form=!0,this.checkForm()}createForm(){this.caseHoldingForm=this.formBuilder.nonNullable.group({id:[null],patient_id:[this.patient_id],patient_tb_id:[this.selected_tb_consult.id],case_number:["",[s.k0.required,s.k0.pattern("^[a-zA-Z0-9]*$")]],enroll_as_code:["",s.k0.required],treatment_regimen_code:["",s.k0.required],registration_date:["",s.k0.required],treatment_start:["",s.k0.required],continuation_start:["",s.k0.required],treatment_end:["",s.k0.required],bacteriological_status_code:["",s.k0.required],anatomical_site_code:["",s.k0.required],eptb_site_id:["",s.k0.required],specific_site:["",s.k0.required],drug_resistant_flag:[0],ipt_type_code:["",s.k0.required],transfer_flag:[0],pict_date:[""]}),this.loadCaseHolding()}checkForm(){this.f.eptb_site_id.disable(),this.f.specific_site.disable(),this.f.ipt_type_code.disable(),this.eptbSite(),this.specificSite()}eptbSite(){"EP"===this.caseHoldingForm.value.anatomical_site_code?this.f.eptb_site_id.enable():this.f.eptb_site_id.disable()}specificSite(){"9"===this.caseHoldingForm.value.eptb_site_id?this.f.specific_site.enable():this.f.specific_site.disable()}loadLibraries(){this.http.get("tbdots/tb-libraries-caseholding").subscribe({next:e=>{this.tb_anatomical_sites=e.tb_anatomical_sites,this.tb_answers_yn=e.tb_answers_yn,this.tb_bacteriological_statuses=e.tb_bacteriological_statuses,this.tb_enroll_as=e.tb_enroll_as,this.tb_eptb_sites=e.tb_eptb_sites,this.tb_ipt_types=e.tb_ipt_types,this.tb_treatment_regimens=e.tb_treatment_regimens,this.createForm()},error:e=>console.log(e)})}constructor(e,i,o){this.http=e,this.toastr=i,this.formBuilder=o,this.getPatientTbHistory=new t.bkB,this.faSave=p.hSh,this.faAdd=p.vkJ,this.faCircleNotch=p.s4k,this.required_message="Required field",this.caseHoldingForm=new s.gE({id:new s.MJ(""),patient_id:new s.MJ(""),patient_tb_id:new s.MJ(""),case_number:new s.MJ(""),enroll_as_code:new s.MJ(""),treatment_regimen_code:new s.MJ(""),registration_date:new s.MJ(""),treatment_start:new s.MJ(""),continuation_start:new s.MJ(""),treatment_end:new s.MJ(""),bacteriological_status_code:new s.MJ(""),anatomical_site_code:new s.MJ(""),eptb_site_id:new s.MJ(""),specific_site:new s.MJ(""),drug_resistant_flag:new s.MJ(!1),ipt_type_code:new s.MJ(""),transfer_flag:new s.MJ(!1),pict_date:new s.MJ("")}),this.show_form=!1,this.is_saving=!1,this.show_error=!1,this.tb_anatomical_sites=[],this.tb_answers_yn=[],this.tb_bacteriological_statuses=[],this.tb_enroll_as=[],this.tb_eptb_sites=[],this.tb_ipt_types=[],this.iptDisabled=["treatment_regimen_code","bacteriological_status_code","anatomical_site_code","pict_date","eptb_site_id","specific_site","drug_resistant_flag"]}ngOnInit(){this.loadLibraries()}static{this.\u0275fac=function(i){return new(i||n)(t.rXU(h.k),t.rXU(v.tw),t.rXU(s.ok))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-case-holding"]],inputs:{patient_id:"patient_id",selected_tb_consult:"selected_tb_consult",max_date:"max_date"},outputs:{getPatientTbHistory:"getPatientTbHistory"},standalone:!1,decls:1,vars:1,consts:[["class","m-5 border border-slate-200 rounded-lg",4,"ngIf"],[1,"m-5","border","border-slate-200","rounded-lg"],[1,"bg-blue-500","text-white","rounded-t-md","py-2","pl-3","font-semibold"],[1,"mx-5","mb-5"],[3,"ngSubmit","formGroup"],[1,"grid","grid-cols-3","gap-4","w-full"],[1,"col-span-3","border-b","border-slate-200","w-full","my-2","font-semibold","text-sky-500"],[1,"mx-5","col-span-3","grid","grid-cols-3","gap-x-4"],["for","enroll_as_code",3,"ngClass"],["name","enroll_as_code","id","enroll_as_code","formControlName","enroll_as_code",1,"input",3,"change","ngClass"],[3,"value",4,"ngFor","ngForOf"],["class","invalid-alert",4,"ngIf"],["for","case_number",3,"ngClass"],["type","text","name","case_number","id","case_number","formControlName","case_number",1,"input",3,"ngClass"],["for","registration_date",3,"ngClass"],["type","date","name","registration_date","id","registration_date","formControlName","registration_date",1,"input",3,"max","ngClass"],[4,"ngIf"],["class","col-span-2",4,"ngIf"],["class","mt-1 grid grid-cols-3 gap-x-4 w-full",4,"ngIf"],["class","flex justify-center mt-5",4,"ngIf"],[3,"value"],[1,"invalid-alert"],["for","ipt_type_code",3,"ngClass"],["name","ipt_type_code","id","ipt_type_code","formControlName","ipt_type_code",1,"input",3,"ngClass"],["for","treatment_regimen_code",3,"ngClass"],["name","treatment_regimen_code","id","treatment_regimen_code","formControlName","treatment_regimen_code",1,"input",3,"ngClass"],[1,"col-span-2"],["for","bacteriological_status_code",3,"ngClass"],["name","bacteriological_status_code","id","bacteriological_status_code","formControlName","bacteriological_status_code",1,"input",3,"ngClass"],["for","anatomical_site_code",3,"ngClass"],["name","anatomical_site_code","id","anatomical_site_code","formControlName","anatomical_site_code",1,"input",3,"change","ngClass"],["for","eptb_site_id",3,"ngClass"],["name","eptb_site_id","id","eptb_site_id","formControlName","eptb_site_id",1,"input",3,"change","ngClass"],["for","specific_site",3,"ngClass"],["type","text","name","specific_site","id","specific_site","formControlName","specific_site",1,"input",3,"ngClass"],["for","drug_resistant_flag",3,"ngClass"],["name","drug_resistant_flag","id","drug_resistant_flag","formControlName","drug_resistant_flag",1,"input",3,"ngClass"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"mt-1","grid","grid-cols-3","gap-x-4","w-full"],[1,"col-span-3","border-b","border-slate-200","w-full","my-2","pt-3","font-semibold","text-sky-500"],[1,"mx-5","col-span-3","grid","grid-cols-4","gap-x-4"],["for","treatment_start",3,"ngClass"],["type","date","name","treatment_start","id","treatment_start","formControlName","treatment_start",1,"input",3,"change","ngClass"],["for","continuation_start",3,"ngClass"],["type","date","name","continuation_start","id","continuation_start","formControlName","continuation_start",1,"input",3,"ngClass"],["for","treatment_end",3,"ngClass"],["type","date","name","treatment_end","id","treatment_end","formControlName","treatment_end",1,"input",3,"ngClass"],["for","pict_date",3,"ngClass"],["type","date","name","pict_date","id","pict_date","formControlName","pict_date",1,"input",3,"ngClass"],[1,"flex","justify-center","mt-5"],["type","submit",1,"btn-save","mr-5","mt-4",3,"disabled"],["class","mr-2",3,"icon",4,"ngIf"],["animation","spin","class","mr-2",3,"icon",4,"ngIf"],[1,"mr-2",3,"icon"],["animation","spin",1,"mr-2",3,"icon"]],template:function(i,o){1&i&&t.DNE(0,Zt,34,33,"div",0),2&i&&t.Y8G("ngIf",o.show_form)},dependencies:[m.YU,m.Sq,m.bT,b.aY,s.qT,s.xH,s.y7,s.me,s.wz,s.BC,s.cb,s.j4,s.JD],encapsulation:2})}}return n})();var N=l(614);function Kt(n,a){if(1&n&&(t.j41(0,"th",11),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.R7$(),t.JRh(e)}}function te(n,a){if(1&n){const e=t.RV6();t.j41(0,"input",17),t.mxI("ngModelChange",function(o){t.eBV(e);const r=t.XpG().$implicit,_=t.XpG(),c=_.$implicit,d=_.index,g=t.XpG();return t.DH7(g.intensiveForm[d][c.year+"-"+c.month[0].toString().padStart(2,"0")+"-"+r.toString().padStart(2,"0")],o)||(g.intensiveForm[d][c.year+"-"+c.month[0].toString().padStart(2,"0")+"-"+r.toString().padStart(2,"0")]=o),t.Njj(o)}),t.k0s()}if(2&n){const e=t.XpG().$implicit,i=t.XpG(),o=i.$implicit,r=i.index,_=t.XpG();t.R50("ngModel",_.intensiveForm[r][o.year+"-"+o.month[0].toString().padStart(2,"0")+"-"+e.toString().padStart(2,"0")])}}function ee(n,a){if(1&n&&(t.j41(0,"td",15),t.DNE(1,te,1,1,"input",16),t.k0s()),2&n){const e=a.$implicit,i=t.XpG(),o=i.$implicit,r=i.index,_=t.XpG();t.R7$(),t.Y8G("ngIf",_.compareDate(_.treatment_start,_.continuation_start,o.month[0],e,o.year,"ip",r))}}function ne(n,a){if(1&n){const e=t.RV6();t.j41(0,"tr")(1,"td")(2,"input",12),t.mxI("ngModelChange",function(o){const r=t.eBV(e).index,_=t.XpG();return t.DH7(_.intensiveAll[r],o)||(_.intensiveAll[r]=o),t.Njj(o)}),t.bIt("click",function(){const o=t.eBV(e).index,r=t.XpG();return t.Njj(r.checkAll("ip",o))}),t.k0s()(),t.j41(3,"td",13)(4,"label"),t.EFF(5),t.k0s()(),t.j41(6,"td",13),t.EFF(7),t.k0s(),t.DNE(8,ee,2,1,"td",14),t.k0s()}if(2&n){const e=a.$implicit,i=a.index,o=t.XpG();t.R7$(2),t.R50("ngModel",o.intensiveAll[i]),t.BMQ("id",e.month[1]),t.R7$(2),t.BMQ("for",e.month[1]),t.R7$(),t.JRh(e.month[1]),t.R7$(2),t.SpI(" ",e.year," "),t.R7$(),t.Y8G("ngForOf",o.days)}}function oe(n,a){if(1&n&&(t.j41(0,"th",11),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.R7$(),t.JRh(e)}}function ie(n,a){if(1&n){const e=t.RV6();t.j41(0,"input",17),t.mxI("ngModelChange",function(o){t.eBV(e);const r=t.XpG().$implicit,_=t.XpG(),c=_.$implicit,d=_.index,g=t.XpG();return t.DH7(g.continuationForm[d][c.year+"-"+c.month[0].toString().padStart(2,"0")+"-"+r.toString().padStart(2,"0")],o)||(g.continuationForm[d][c.year+"-"+c.month[0].toString().padStart(2,"0")+"-"+r.toString().padStart(2,"0")]=o),t.Njj(o)}),t.k0s()}if(2&n){const e=t.XpG().$implicit,i=t.XpG(),o=i.$implicit,r=i.index,_=t.XpG();t.R50("ngModel",_.continuationForm[r][o.year+"-"+o.month[0].toString().padStart(2,"0")+"-"+e.toString().padStart(2,"0")])}}function se(n,a){if(1&n&&(t.j41(0,"td",15),t.DNE(1,ie,1,1,"input",16),t.k0s()),2&n){const e=a.$implicit,i=t.XpG(),o=i.$implicit,r=i.index,_=t.XpG();t.R7$(),t.Y8G("ngIf",_.compareDate(_.continuation_start,_.treatment_end,o.month[0],e,o.year,"cp",r))}}function ae(n,a){if(1&n){const e=t.RV6();t.j41(0,"tr")(1,"td")(2,"input",12),t.mxI("ngModelChange",function(o){const r=t.eBV(e).index,_=t.XpG();return t.DH7(_.continuationAll[r],o)||(_.continuationAll[r]=o),t.Njj(o)}),t.bIt("click",function(){const o=t.eBV(e).index,r=t.XpG();return t.Njj(r.checkAll("cp",o))}),t.k0s()(),t.j41(3,"td",13)(4,"label"),t.EFF(5),t.k0s()(),t.j41(6,"td",13),t.EFF(7),t.k0s(),t.DNE(8,se,2,1,"td",14),t.k0s()}if(2&n){const e=a.$implicit,i=a.index,o=t.XpG();t.R7$(2),t.R50("ngModel",o.continuationAll[i]),t.BMQ("id",e.month[1]),t.R7$(2),t.BMQ("for",e.month[1]),t.R7$(),t.JRh(e.month[1]),t.R7$(2),t.SpI(" ",e.year," "),t.R7$(),t.Y8G("ngForOf",o.days)}}function re(n,a){if(1&n&&t.nrm(0,"fa-icon",18),2&n){const e=t.XpG();t.Y8G("icon",e.faSave)}}function _e(n,a){if(1&n&&t.nrm(0,"fa-icon",19),2&n){const e=t.XpG();t.Y8G("icon",e.faCircleNotch)}}let ce=(()=>{class n{checkAll(e,i){let o="ip"===e?this.intensiveForm[i]:this.continuationForm[i],r="ip"===e?"intensiveForm":"continuationForm",_="ip"===e?"intensiveAll":"continuationAll";this[_][i]=!this[_][i],Object.entries(o).forEach(([c,d])=>{console.log(i,this[_][i]),this[r][i][c]=this[_][i],console.log(c,this[r][i][c])})}generateChart(){if(this.selected_tb_consult.case_holding){this.treatment_start=new Date(this.selected_tb_consult.case_holding.treatment_start),this.continuation_start=new Date(this.selected_tb_consult.case_holding.continuation_start),this.treatment_end=new Date(this.selected_tb_consult.case_holding.treatment_end);let e=new Date(this.continuation_start).setDate(this.continuation_start.getDate()-1);for(let o=new Date(this.treatment_start.getFullYear(),this.treatment_start.getMonth(),1);o<=new Date(e);o.setMonth(o.getMonth()+1))this.intensive_phase.push({month:[o.getMonth()+1,o.toLocaleString("default",{month:"short"})],year:o.getFullYear()});for(let o=new Date(new Date(this.selected_tb_consult.case_holding.continuation_start).getFullYear()+"-"+(new Date(this.selected_tb_consult.case_holding.continuation_start).getMonth()+1)+"-01");o<=new Date(this.selected_tb_consult.case_holding.treatment_end);o.setMonth(o.getMonth()+1))this.continuation_phase.push({month:[o.getMonth()+1,o.toLocaleString("default",{month:"short"})],year:o.getFullYear()})}}onSubmit(){let e=[];Object.entries(this.intensiveForm).forEach(([o,r])=>{Object.entries(r).forEach(([_,c])=>{c&&e.push({dots_date:_,dots_type:"IP"})})}),Object.entries(this.continuationForm).forEach(([o,r])=>{Object.entries(r).forEach(([_,c])=>{c&&e.push({dots_date:_,dots_type:"CP"})})}),this.http.post("tbdots/patient-tb-chart",{patient_id:this.patient_id,patient_tb_id:this.selected_tb_consult.id,dots:e}).subscribe({next:o=>{console.log(o),this.toastr.success("Successfully Recorded","TB Dots Chart"),this.is_saving=!1},error:o=>{this.http.showError(o.error.message,"TB Dots Chart")}})}compareDate(e,i,o,r,_,c,d){if("ip"===c&&!this.intensiveForm[d]&&(this.intensiveForm[d]=[]),"cp"===c&&!this.continuationForm[d]&&(this.continuationForm[d]=[]),this.isValidDate(`${_}-${o.toString().padStart(2,"0")}-${r.toString().padStart(2,"0")}`)){let g=_+"-"+o.toString().padStart(2,"0")+"-"+r.toString().padStart(2,"0"),D=new Date(`${_}-${o.toString().padStart(2,"0")}-${r.toString().padStart(2,"0")}`),Ke=new Date(e),k=new Date(i);"ip"===c&&k.setDate(k.getDate()-1);let T=D>=Ke&&D<=k,G=!!this.saved_dots_chart[g];return"ip"===c&&T&&!this.intensiveForm[d][g]&&(this.intensiveForm[d][g]=G),"cp"===c&&T&&!this.continuationForm[d][g]&&(this.continuationForm[d][g]=G),G&&delete this.saved_dots_chart[g],T}return!1}isValidDate(e){const i=new Date(e);return i.getFullYear()===Number(e.substr(0,4))&&i.getMonth()===Number(e.substr(5,2))-1&&i.getDate()===Number(e.substr(8,2))}constructor(e,i){this.http=e,this.toastr=i,this.getPatientTbHistory=new t.bkB,this.faCircleNotch=p.s4k,this.faSave=N.hSh,this.days=Array.from({length:31},(o,r)=>r+1),this.intensive_phase=[],this.continuation_phase=[],this.intensiveForm=[],this.intensiveAll=[],this.continuationForm=[],this.continuationAll=[],this.ip_count=[],this.cp_count=[],this.is_saving=!1,this.saved_dots_chart=[]}ngOnInit(){this.ip_count=[],this.cp_count=[],this.selected_tb_consult.dots_chart?(Object.entries(this.selected_tb_consult.dots_chart).forEach(([e,i])=>{this.saved_dots_chart[i.dots_date]=!0}),console.log(this.saved_dots_chart),this.generateChart()):this.generateChart()}static{this.\u0275fac=function(i){return new(i||n)(t.rXU(h.k),t.rXU(v.tw))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-dots-chart"]],inputs:{patient_id:"patient_id",consult_id:"consult_id",selected_tb_consult:"selected_tb_consult"},outputs:{getPatientTbHistory:"getPatientTbHistory"},standalone:!1,decls:37,vars:8,consts:[[1,"flex","overflow-x-auto"],[1,"flex","flex-col","p-5","mt-10","border","border-slate-200","rouned-md","shadow-md"],[1,"text-center","font-semibold"],[1,"bg-blue-500","text-white"],[1,"px-2"],["class","w-12 font-normal px-1",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"flex","justify-center","mt-5"],["type","button",1,"btn-save","mr-5","mt-4",3,"click","disabled"],["class","mr-2",3,"icon",4,"ngIf"],["animation","spin","class","mr-2",3,"icon",4,"ngIf"],[1,"w-12","font-normal","px-1"],["type","checkbox",1,"input-checkbox",3,"ngModelChange","click","ngModel"],[1,"px-2","select-none"],["class","px-1",4,"ngFor","ngForOf"],[1,"px-1"],["type","checkbox","class","input-checkbox",3,"ngModel","ngModelChange",4,"ngIf"],["type","checkbox",1,"input-checkbox",3,"ngModelChange","ngModel"],[1,"mr-2",3,"icon"],["animation","spin",1,"mr-2",3,"icon"]],template:function(i,o){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3," Intensive Phase "),t.k0s(),t.j41(4,"div")(5,"table")(6,"thead")(7,"tr",3),t.nrm(8,"th"),t.j41(9,"th",4),t.EFF(10,"Month"),t.k0s(),t.j41(11,"th",4),t.EFF(12,"Year"),t.k0s(),t.DNE(13,Kt,2,1,"th",5),t.k0s()(),t.j41(14,"tbody"),t.DNE(15,ne,9,6,"tr",6),t.k0s()()()()(),t.j41(16,"div",0)(17,"div",1)(18,"div",2),t.EFF(19," Continuation Phase "),t.k0s(),t.j41(20,"div")(21,"table")(22,"thead")(23,"tr",3),t.nrm(24,"th"),t.j41(25,"th",4),t.EFF(26,"Month"),t.k0s(),t.j41(27,"th",4),t.EFF(28,"Year"),t.k0s(),t.DNE(29,oe,2,1,"th",5),t.k0s()(),t.j41(30,"tbody"),t.DNE(31,ae,9,6,"tr",6),t.k0s()()()()(),t.j41(32,"div",7)(33,"button",8),t.bIt("click",function(){return o.onSubmit()}),t.DNE(34,re,1,1,"fa-icon",9)(35,_e,1,1,"fa-icon",10),t.EFF(36),t.k0s()()),2&i&&(t.R7$(13),t.Y8G("ngForOf",o.days),t.R7$(2),t.Y8G("ngForOf",o.intensive_phase),t.R7$(14),t.Y8G("ngForOf",o.days),t.R7$(2),t.Y8G("ngForOf",o.continuation_phase),t.R7$(2),t.Y8G("disabled",o.is_saving),t.R7$(),t.Y8G("ngIf",!o.is_saving),t.R7$(),t.Y8G("ngIf",o.is_saving),t.R7$(),t.SpI(" ",o.intensiveForm?o.is_saving?"Updating":"Update":o.is_saving?"Saving":"Save"," "))},dependencies:[m.Sq,m.bT,b.aY,s.Zm,s.BC,s.vS],encapsulation:2})}}return n})();const F=n=>({"text-red-500":n}),x=n=>({"invalid-input":n}),le=n=>({hidden:n});function de(n,a){if(1&n&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.SpI(" ",e.required_message," ")}}function me(n,a){if(1&n&&(t.j41(0,"div",25),t.DNE(1,de,2,1,"div",26),t.k0s()),2&n){const e=t.XpG();t.R7$(),t.Y8G("ngIf",null==e.f.outcome_date.errors?null:e.f.outcome_date.errors.required)}}function pe(n,a){if(1&n&&(t.j41(0,"option",27),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.Y8G("value",e.code),t.R7$(),t.JRh(e.desc)}}function ue(n,a){if(1&n&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.SpI(" ",e.required_message," ")}}function fe(n,a){if(1&n&&(t.j41(0,"div",25),t.DNE(1,ue,2,1,"div",26),t.k0s()),2&n){const e=t.XpG();t.R7$(),t.Y8G("ngIf",null==e.f.tb_treatment_outcome_code.errors?null:e.f.tb_treatment_outcome_code.errors.required)}}function ge(n,a){if(1&n&&(t.j41(0,"option",31),t.EFF(1),t.k0s()),2&n){const e=a.$implicit,i=t.XpG(2);t.Y8G("ngClass",t.eq3(3,le,i.checkReason(e.id)))("value",e.id),t.R7$(),t.JRh(e.desc)}}function be(n,a){if(1&n&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(3);t.R7$(),t.SpI(" ",e.required_message," ")}}function he(n,a){if(1&n&&(t.j41(0,"div",25),t.DNE(1,be,2,1,"div",26),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.Y8G("ngIf",null==e.f.lib_tb_outcome_reason_id.errors?null:e.f.lib_tb_outcome_reason_id.errors.required)}}function ve(n,a){if(1&n&&(t.j41(0,"div",15)(1,"label",28),t.EFF(2,"Treatment Outcome"),t.k0s(),t.j41(3,"select",29),t.DNE(4,ge,2,5,"option",30),t.k0s(),t.DNE(5,he,2,1,"div",10),t.k0s()),2&n){const e=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(4,F,e.show_error&&e.f.outcome_date.errors)),t.R7$(2),t.Y8G("ngClass",t.eq3(6,x,e.show_error&&e.f.lib_tb_outcome_reason_id.errors)),t.R7$(),t.Y8G("ngForOf",e.outcome_reasons),t.R7$(),t.Y8G("ngIf",e.show_error&&e.f.lib_tb_outcome_reason_id.errors)}}let Ce=(()=>{class n{get f(){return this.tbForm.controls}onSubmit(){this.is_saving=!0,this.http.update("tbdots/patient-tb/",this.selected_tb_consult.id,this.tbForm.value).subscribe({next:e=>{this.saveComplete()},error:e=>console.log(e)})}saveComplete(){this.is_saving=!1,this.toastr.success("Successfully recorded!","Treatment Outcome"),this.switchPage.emit(1),this.closeModal()}disableFields(){"D"===this.tbForm.value.tb_treatment_outcome_code||"LTFU"===this.tbForm.value.tb_treatment_outcome_code||"NE"===this.tbForm.value.tb_treatment_outcome_code?this.tbForm.controls.lib_tb_outcome_reason_id.enable():this.tbForm.controls.lib_tb_outcome_reason_id.disable()}loadLibraries(){this.http.get("libraries/tb-treatment-outcome").subscribe({next:e=>this.treatment_outcomes=e.data,error:e=>console.log(e)}),this.http.get("libraries/tb-outcome-reason").subscribe({next:e=>this.outcome_reasons=e.data,error:e=>console.log(e)})}checkReason(e){let i=!1;return"D"===this.f.tb_treatment_outcome_code.value?i=!(e>=10&&e<=11):("LTFU"===this.f.tb_treatment_outcome_code.value||"NE"===this.f.tb_treatment_outcome_code.value)&&(i=e>=10&&e<=11),i}createForm(){this.selected_tb_consult&&(this.tbForm=this.formBuilder.nonNullable.group({patient_id:[this.selected_tb_consult.patient_id],tb_treatment_outcome_code:["",s.k0.required],lib_tb_outcome_reason_id:["",s.k0.required],outcome_date:["",s.k0.required],treatment_done:[!1],outcome_remarks:[""]})),this.loadLibraries(),this.disableFields(),this.tbForm.patchValue({tb_treatment_outcome_code:this.selected_tb_consult.tb_treatment_outcome?this.selected_tb_consult.tb_treatment_outcome.code:null,lib_tb_outcome_reason_id:this.selected_tb_consult.outcome_reason?this.selected_tb_consult.outcome_reason.id:null,outcome_date:this.selected_tb_consult.outcome_date?(0,m.Yq)(this.selected_tb_consult.outcome_date,"yyyy-MM-dd","en","Asia/Manila"):null,treatment_done:this.selected_tb_consult.treatment_done,outcome_remarks:this.selected_tb_consult.outcome_remarks}),this.disableFields()}closeModal(){this.toggleModal.emit("treatment_outcome")}constructor(e,i,o){this.formBuilder=e,this.http=i,this.toastr=o,this.getPatientTbHistory=new t.bkB,this.toggleModal=new t.bkB,this.switchPage=new t.bkB,this.faSave=N.hSh,this.faCircleNotch=p.s4k,this.is_saving=!1,this.show_error=!1,this.required_message="Required field",this.tbForm=new s.gE({patient_id:new s.MJ(""),tb_treatment_outcome_code:new s.MJ(""),lib_tb_outcome_reason_id:new s.MJ(""),outcome_date:new s.MJ(""),treatment_done:new s.MJ(""),outcome_remarks:new s.MJ("")})}ngOnInit(){this.createForm()}static{this.\u0275fac=function(i){return new(i||n)(t.rXU(s.ok),t.rXU(h.k),t.rXU(v.tw))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-treatment-outcome"]],inputs:{selected_tb_consult:"selected_tb_consult",max_date:"max_date"},outputs:{getPatientTbHistory:"getPatientTbHistory",toggleModal:"toggleModal",switchPage:"switchPage"},standalone:!1,decls:37,vars:20,consts:[["id","defaultModal","tabindex","-1","aria-modal","true","role","dialog",1,"overflow-y-auto","overflow-x-hidden","fixed","top-0","right-0","left-0","w-full","md:inset-0","h-modal","md:h-full","justify-center","items-center","flex",2,"z-index","60"],[1,"relative","p-4","w-full","max-w-3xl","h-auto","md:h-auto"],[1,"relative","bg-white","rounded-lg","shadow"],[1,"flex","justify-between","items-start","py-3","px-5","rounded-t","border-b","bg-orange-500"],[1,"text-sm","font-bold","text-white"],[1,"overflow-y-auto","h-96","scrollbar-thin","scrollbar-thumb-gray-400","scrollbar-track-gray-100"],[1,"text-left","text-gray-500","m-5",3,"submit","formGroup"],[1,"grid","grid-cols-2","gap-4"],["for","outcome_date",3,"ngClass"],["type","date","name","outcome_date","id","outcome_date","formControlName","outcome_date",1,"input",3,"max","ngClass"],["class","invalid-alert",4,"ngIf"],["for","tb_treatment_outcome_code",3,"ngClass"],["name","tb_treatment_outcome_code","id","tb_treatment_outcome_code","formControlName","tb_treatment_outcome_code",1,"input",3,"change","ngClass"],[3,"value",4,"ngFor","ngForOf"],["class","col-span-2",4,"ngIf"],[1,"col-span-2"],["for","outcome_remarks"],["name","outcome_remarks","id","outcome_remarks","formControlName","outcome_remarks",1,"input"],[1,"flex","justify-center"],["type","checkbox","id","treatment_done","formControlName","treatment_done",1,"border","border-slate-500","rounded","mr-3"],["for","treatment_done",1,"font-normal"],[1,"flex","justify-end","py-4","px-5","space-x-4","rounded-b","border-t","border-gray-200"],["type","button",1,"btn-save","bg-gray-400",3,"click"],["type","submit",1,"btn-save","px-10","disabled:bg-gray-300",3,"click","disabled"],[1,"opacity-50","fixed","inset-0","z-50","bg-black"],[1,"invalid-alert"],[4,"ngIf"],[3,"value"],["for","lib_tb_outcome_reason_id",3,"ngClass"],["name","lib_tb_outcome_reason_id","id","lib_tb_outcome_reason_id","formControlName","lib_tb_outcome_reason_id",1,"input",3,"ngClass"],[3,"ngClass","value",4,"ngFor","ngForOf"],[3,"ngClass","value"]],template:function(i,o){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),t.EFF(5," Treatment Outcome/Status Form "),t.k0s()(),t.j41(6,"div",5)(7,"form",6),t.bIt("submit",function(){return o.onSubmit()}),t.j41(8,"div",7)(9,"div")(10,"label",8),t.EFF(11,"Outcome Date"),t.k0s(),t.nrm(12,"input",9),t.DNE(13,me,2,1,"div",10),t.k0s(),t.j41(14,"div")(15,"label",11),t.EFF(16,"Treatment Outcome"),t.k0s(),t.j41(17,"select",12),t.bIt("change",function(){return o.disableFields()}),t.DNE(18,pe,2,2,"option",13),t.k0s(),t.DNE(19,fe,2,1,"div",10),t.k0s(),t.DNE(20,ve,6,8,"div",14),t.j41(21,"div",15)(22,"label",16),t.EFF(23,"Brief Explanation/Remarks"),t.k0s(),t.nrm(24,"textarea",17),t.k0s(),t.j41(25,"div",15)(26,"div",18),t.nrm(27,"input",19),t.j41(28,"label",20),t.EFF(29,"Check to end this treatment"),t.k0s()()()()()(),t.j41(30,"div",21)(31,"button",22),t.bIt("click",function(){return o.closeModal()}),t.EFF(32,"Close"),t.k0s(),t.j41(33,"button",23),t.bIt("click",function(){return o.onSubmit()}),t.nrm(34,"fa-icon"),t.EFF(35),t.k0s()()()()(),t.nrm(36,"div",24)),2&i&&(t.R7$(7),t.Y8G("formGroup",o.tbForm),t.R7$(3),t.Y8G("ngClass",t.eq3(12,F,o.show_error&&o.f.outcome_date.errors)),t.R7$(2),t.Y8G("max",o.max_date)("ngClass",t.eq3(14,x,o.show_error&&o.f.outcome_date.errors)),t.R7$(),t.Y8G("ngIf",o.show_error&&o.f.outcome_date.errors),t.R7$(2),t.Y8G("ngClass",t.eq3(16,F,o.show_error&&o.f.outcome_date.errors)),t.R7$(2),t.Y8G("ngClass",t.eq3(18,x,o.show_error&&o.f.tb_treatment_outcome_code.errors)),t.R7$(),t.Y8G("ngForOf",o.treatment_outcomes),t.R7$(),t.Y8G("ngIf",o.show_error&&o.f.tb_treatment_outcome_code.errors),t.R7$(),t.Y8G("ngIf",o.f.lib_tb_outcome_reason_id.enabled),t.R7$(13),t.Y8G("disabled",o.is_saving||o.tbForm.invalid),t.R7$(2),t.SpI(" ",o.is_saving?"Saving":"Save"," "))},dependencies:[m.YU,m.Sq,m.bT,b.aY,s.qT,s.xH,s.y7,s.me,s.Zm,s.wz,s.BC,s.cb,s.j4,s.JD],encapsulation:2})}}return n})();function Fe(n,a){if(1&n){const e=t.RV6();t.j41(0,"button",2),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.switchPage(2))}),t.EFF(1," TREATMENT "),t.k0s()}if(2&n){const e=t.XpG();t.HbH(2===e.pages?"tabs-main-true rounded-t-md":"tabs-main-false")}}function xe(n,a){if(1&n){const e=t.RV6();t.j41(0,"button",2),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.switchPage(3))}),t.EFF(1," ECLAIMS "),t.k0s()}if(2&n){const e=t.XpG();t.HbH(3===e.pages?"tabs-main-true rounded-t-md":"tabs-main-false")}}function ke(n,a){if(1&n){const e=t.RV6();t.j41(0,"button",16),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.toggleModal("end_visit"))}),t.nrm(1,"fa-icon",17),t.EFF(2," End Visit "),t.k0s()}if(2&n){const e=t.XpG();t.R7$(),t.Y8G("icon",e.faDoorClosed)}}function Te(n,a){if(1&n){const e=t.RV6();t.j41(0,"button",20),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.switchTab(3))}),t.EFF(1," CASE HOLDING "),t.k0s()}if(2&n){const e=t.XpG(2);t.HbH(3===e.module?"tabs-main-true":"tabs-main-false")}}function Ge(n,a){if(1&n){const e=t.RV6();t.j41(0,"button",20),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.switchTab(5))}),t.EFF(1," DIAGNOSIS & PRESCRIPTION "),t.k0s()}if(2&n){const e=t.XpG(2);t.HbH(5===e.module?"tabs-main-true":"tabs-main-false")}}function Re(n,a){if(1&n){const e=t.RV6();t.j41(0,"button",20),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.switchTab(6))}),t.EFF(1," SUPPLIES "),t.k0s()}if(2&n){const e=t.XpG(2);t.HbH(6===e.module?"tabs-main-true":"tabs-main-false")}}function ye(n,a){if(1&n){const e=t.RV6();t.j41(0,"button",20),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.switchTab(8))}),t.EFF(1," CASE RATE "),t.k0s()}if(2&n){const e=t.XpG(2);t.HbH(8===e.module?"tabs-main-true":"tabs-main-false")}}function je(n,a){if(1&n){const e=t.RV6();t.j41(0,"button",23),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.toggleModal("treatment_outcome"))}),t.EFF(1," Treatment Outcome "),t.k0s()}}function we(n,a){if(1&n){const e=t.RV6();t.j41(0,"nav",18)(1,"div",19)(2,"button",20),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.switchTab(1))}),t.EFF(3," FINDINGS "),t.k0s(),t.DNE(4,Te,2,2,"button",21),t.j41(5,"button",20),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.switchTab(4))}),t.EFF(6," DOTS CHART "),t.k0s(),t.DNE(7,Ge,2,2,"button",21)(8,Re,2,2,"button",21)(9,ye,2,2,"button",21),t.k0s(),t.j41(10,"div",19),t.DNE(11,je,2,0,"button",22),t.k0s()()}if(2&n){const e=t.XpG();t.R7$(2),t.HbH(1===e.module?"tabs-main-true":"tabs-main-false"),t.R7$(2),t.Y8G("ngIf",null==e.selected_tb_consult?null:e.selected_tb_consult.id),t.R7$(),t.HbH(4===e.module?"tabs-main-true":"tabs-main-false"),t.R7$(2),t.Y8G("ngIf",null==e.selected_tb_consult?null:e.selected_tb_consult.id),t.R7$(),t.Y8G("ngIf",null==e.selected_tb_consult?null:e.selected_tb_consult.id),t.R7$(),t.Y8G("ngIf",null==e.selected_tb_consult?null:e.selected_tb_consult.id),t.R7$(2),t.Y8G("ngIf",e.selected_tb_consult&&0===e.selected_tb_consult.treatment_done)}}function $e(n,a){1&n&&(t.j41(0,"div",28),t.EFF(1," There is an ongoing TB treatment for this patient on another facility. You are not allowed to create a new treatment or view previous treatment from other facilities. "),t.k0s())}function Ee(n,a){if(1&n&&(t.j41(0,"div",29)(1,"div",30),t.nrm(2,"fa-icon",31),t.k0s(),t.j41(3,"div",32),t.EFF(4,"Fetching history..."),t.k0s()()),2&n){const e=t.XpG(2);t.R7$(2),t.Y8G("icon",e.faCircleNotch)}}function Ie(n,a){1&n&&(t.j41(0,"td",42)(1,"div",43),t.EFF(2," No records to show... "),t.k0s()())}function Ye(n,a){if(1&n){const e=t.RV6();t.j41(0,"button",44),t.bIt("click",function(){t.eBV(e);const o=t.XpG().$implicit,r=t.XpG(3);return t.Njj(r.openTbConsult(o))}),t.EFF(1),t.k0s()}if(2&n){const e=t.XpG().$implicit;t.R7$(),t.SpI(" ",0===e.treatment_done?"Open":"View"," ")}}function Ne(n,a){if(1&n&&(t.j41(0,"tr",38),t.DNE(1,Ie,3,0,"td",39),t.j41(2,"td",40),t.EFF(3),t.nI1(4,"date"),t.k0s(),t.j41(5,"td",40),t.EFF(6),t.nI1(7,"date"),t.k0s(),t.j41(8,"td",40),t.EFF(9),t.k0s(),t.j41(10,"td",40),t.EFF(11),t.k0s(),t.j41(12,"td",40),t.EFF(13),t.k0s(),t.j41(14,"td",40),t.EFF(15),t.k0s(),t.j41(16,"td",40),t.DNE(17,Ye,2,1,"button",41),t.k0s()()),2&n){const e=a.$implicit,i=t.XpG(3);t.R7$(),t.Y8G("ngIf",!i.patient_tb_history),t.R7$(2),t.SpI(" ",t.brH(4,8,e.case_finding.consult_date,"MM/dd/yyyy","Asia/Manila")," "),t.R7$(3),t.SpI(" ",e.case_holding?t.brH(7,12,null==e.case_holding?null:e.case_holding.registration_date,"MM/dd/yyyy","Asia/Manila"):"-"," "),t.R7$(3),t.SpI(" ",e.case_holding?null==e.case_holding?null:e.case_holding.case_number:"-"," "),t.R7$(2),t.SpI(" ",e.case_holding?null==e.case_holding?null:e.case_holding.enroll_as.desc:"-"," "),t.R7$(2),t.SpI(" ",e.tb_treatment_outcome?e.tb_treatment_outcome.desc:"-"," "),t.R7$(2),t.SpI(" ",0===e.treatment_done?"Open":"Closed"," "),t.R7$(2),t.Y8G("ngIf",i.user_facility===e.facility_code)}}function De(n,a){if(1&n){const e=t.RV6();t.j41(0,"tr",38)(1,"td",42)(2,"div",45)(3,"div",46),t.EFF(4,"No records to show..."),t.k0s(),t.j41(5,"div",46)(6,"button",47),t.bIt("click",function(){t.eBV(e);const o=t.XpG(3);return t.Njj(o.switchPage(2))}),t.EFF(7," create record "),t.k0s()()()()()}}function Me(n,a){if(1&n&&(t.j41(0,"table",33)(1,"thead",34)(2,"tr")(3,"th",35),t.EFF(4,"Case Finding Date"),t.k0s(),t.j41(5,"th",35),t.EFF(6,"Enrollment Date"),t.k0s(),t.j41(7,"th",35),t.EFF(8,"Case number"),t.k0s(),t.j41(9,"th",35),t.EFF(10,"Enrolled as"),t.k0s(),t.j41(11,"th",35),t.EFF(12,"Treatment outcome"),t.k0s(),t.j41(13,"th",35),t.EFF(14,"Treatment status"),t.k0s(),t.j41(15,"th",35),t.EFF(16,"Action"),t.k0s()()(),t.j41(17,"tbody"),t.DNE(18,Ne,18,16,"tr",36)(19,De,8,0,"tr",37),t.k0s()()),2&n){const e=t.XpG(2);t.R7$(18),t.Y8G("ngForOf",e.patient_tb_history),t.R7$(),t.Y8G("ngIf",!e.patient_tb_history[0])}}function Xe(n,a){if(1&n&&(t.j41(0,"div",24),t.DNE(1,$e,2,0,"div",25)(2,Ee,5,1,"div",26)(3,Me,20,2,"table",27),t.k0s()),2&n){const e=t.XpG();t.R7$(),t.Y8G("ngIf",e.selected_tb_consult&&(null==e.selected_tb_consult?null:e.selected_tb_consult.facility_code)!==e.user_facility),t.R7$(),t.Y8G("ngIf",e.fetching_history),t.R7$(),t.Y8G("ngIf",!e.fetching_history&&e.patient_tb_history)}}function He(n,a){if(1&n){const e=t.RV6();t.j41(0,"app-casefindings",48),t.bIt("getPatientTbHistory",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.getPatientTbHistory())}),t.k0s()}if(2&n){const e=t.XpG();t.Y8G("patient_id",e.patient_id)("selected_tb_consult",e.selected_tb_consult)("max_date",e.max_date)}}function Se(n,a){if(1&n){const e=t.RV6();t.j41(0,"app-case-holding",48),t.bIt("getPatientTbHistory",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.getPatientTbHistory())}),t.k0s()}if(2&n){const e=t.XpG();t.Y8G("patient_id",e.patient_id)("selected_tb_consult",e.selected_tb_consult)("max_date",e.max_date)}}function Pe(n,a){if(1&n){const e=t.RV6();t.j41(0,"app-dots-chart",49),t.bIt("getPatientTbHistory",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.getPatientTbHistory())}),t.k0s()}if(2&n){const e=t.XpG();t.Y8G("patient_id",e.patient_id)("selected_tb_consult",e.selected_tb_consult)}}function Oe(n,a){if(1&n){const e=t.RV6();t.j41(0,"div")(1,"app-final-dx",50),t.bIt("loadConsult",function(o){t.eBV(e);const r=t.XpG();return t.Njj(r.loadConsult(o))}),t.k0s(),t.j41(2,"app-prescription",51),t.bIt("loadConsult",function(o){t.eBV(e);const r=t.XpG();return t.Njj(r.loadConsult(o))}),t.k0s()()}if(2&n){const e=t.XpG();t.R7$(),t.Y8G("toggle_content",e.toggle_content)("consult_details",e.consult_details)("have_complaint",e.have_complaint)("allowed_to_edit",e.allowed_to_edit),t.R7$(),t.Y8G("toggle_content",e.toggle_content)("consult_details",e.consult_details)("have_complaint",e.have_complaint)("allowed_to_edit",e.allowed_to_edit)("user_id",e.user_id)}}function qe(n,a){if(1&n){const e=t.RV6();t.j41(0,"div")(1,"app-supplies",51),t.bIt("loadConsult",function(o){t.eBV(e);const r=t.XpG();return t.Njj(r.loadConsult(o))}),t.k0s()()}if(2&n){const e=t.XpG();t.R7$(),t.Y8G("toggle_content",e.toggle_content)("consult_details",e.consult_details)("have_complaint",e.have_complaint)("allowed_to_edit",e.allowed_to_edit)("user_id",e.user_id)}}function Ve(n,a){if(1&n){const e=t.RV6();t.j41(0,"app-end-visit",52),t.bIt("toggleModal",function(o){t.eBV(e);const r=t.XpG();return t.Njj(r.toggleModal(o))}),t.k0s()}if(2&n){const e=t.XpG();t.Y8G("consult_id",null==e.consult_details?null:e.consult_details.id)("consult_date",null==e.consult_details?null:e.consult_details.consult_date)("patient_id",null==e.consult_details?null:e.consult_details.patient.id)("pt_group","tb")}}function Je(n,a){if(1&n){const e=t.RV6();t.j41(0,"app-treatment-outcome",53),t.bIt("toggleModal",function(o){t.eBV(e);const r=t.XpG();return t.Njj(r.toggleModal(o))})("switchPage",function(o){t.eBV(e);const r=t.XpG();return t.Njj(r.switchPage(o))})("getPatientTbHistory",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.getPatientTbHistory())}),t.k0s()}if(2&n){const e=t.XpG();t.Y8G("selected_tb_consult",e.selected_tb_consult)("max_date",e.max_date)}}function Be(n,a){if(1&n){const e=t.RV6();t.j41(0,"app-caserate",54),t.bIt("switchPage",function(o){t.eBV(e);const r=t.XpG();return t.Njj(r.switchPage(o))}),t.k0s()}if(2&n){const e=t.XpG();t.Y8G("patient_id",e.selected_tb_consult.patient_id)("program_id",e.selected_tb_consult.id)("program_name","tb")("max_date",e.max_date)}}function Ae(n,a){if(1&n){const e=t.RV6();t.j41(0,"app-eclaims",55),t.bIt("switchPage",function(o){t.eBV(e);const r=t.XpG();return t.Njj(r.switchPage(o))}),t.k0s()}if(2&n){const e=t.XpG();t.Y8G("program_id",e.selected_tb_consult.id)("program_name","tb")("max_date",e.max_date)("selected_case",e.selected_tb_consult)}}function Ue(n,a){if(1&n){const e=t.RV6();t.j41(0,"app-esoa",56),t.bIt("switchPage",function(o){t.eBV(e);const r=t.XpG();return t.Njj(r.switchPage(o))}),t.k0s()}if(2&n){const e=t.XpG();t.Y8G("program_id",e.selected_tb_consult.id)("program_name","tb")("max_date",e.max_date)("consult_details",e.consult_details)}}const Le=[{path:"",component:(()=>{class n{openTbConsult(e){this.selected_tb_consult=e,this.pages=2}getPatientTbHistory(){this.selected_tb_consult=null,this.fetching_history=!0,this.http.get("tbdots/patient-tb",{params:{patient_id:this.patient_id,per_page:"all"}}).subscribe({next:i=>{this.patient_tb_history=i.data,this.patient_tb_history[0]&&0===this.patient_tb_history[0].treatment_done&&(this.selected_tb_consult=i.data[0]),this.fetching_history=!1},error:i=>console.log(i)})}switchPage(e){1===e&&this.getPatientTbHistory(),this.pages=e}switchTab(e){this.module=e}toggleModal(e){this.modals[e]=!this.modals[e]}loadConsult(){this.http.get("consultation/records",{params:{id:this.consult_id,pt_group:"tb"}}).subscribe({next:i=>{this.consult_details=i.data[0],this.getPatientTbHistory()},error:i=>console.log(i)})}constructor(e,i){this.http=e,this.route=i,this.faPersonWalking=p.kH$,this.faDoorClosed=p.K_I,this.faCircleNotch=p.s4k,this.pages=1,this.module=1,this.show_end=!1,this.fetching_history=!0,this.patient_tb_history=[],this.allowed_to_edit=!0,this.have_complaint=!1,this.toggle_content=!0,this.max_date=(0,m.Yq)(new Date,"yyyy-MM-dd","en","Asia/Manila"),this.modals=[]}ngOnInit(){this.user_id=this.http.getUserID(),this.user_facility=this.http.getUserFacility(),this.patient_id=this.route.snapshot.paramMap.get("id"),this.consult_id=this.route.snapshot.paramMap.get("consult_id"),this.loadConsult()}static{this.\u0275fac=function(i){return new(i||n)(t.rXU(h.k),t.rXU(C.nX))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-tbdots"]],standalone:!1,decls:20,vars:17,consts:[[1,"flex"],[1,"mt-4","flex","flex-row","border-b","border-slate-300","text-xs"],[1,"tabs-main","w-36",3,"click"],["class","tabs-main w-36",3,"class","click",4,"ngIf"],[1,"ml-auto"],["type","button","class","btn-end-visit ml-auto mt-5",3,"click",4,"ngIf"],["class","mt-2 flex justify-between border-b border-slate-300 text-xs",4,"ngIf"],["class","my-5 w-full border border-gray-200 shadow-md rounded-xl",4,"ngIf"],[3,"patient_id","selected_tb_consult","max_date","getPatientTbHistory",4,"ngIf"],[3,"patient_id","selected_tb_consult","getPatientTbHistory",4,"ngIf"],[4,"ngIf"],[3,"consult_id","consult_date","patient_id","pt_group","toggleModal",4,"ngIf"],[3,"selected_tb_consult","max_date","toggleModal","switchPage","getPatientTbHistory",4,"ngIf"],[3,"patient_id","program_id","program_name","max_date","switchPage",4,"ngIf"],[3,"program_id","program_name","max_date","selected_case","switchPage",4,"ngIf"],[3,"program_id","program_name","max_date","consult_details","switchPage",4,"ngIf"],["type","button",1,"btn-end-visit","ml-auto","mt-5",3,"click"],[1,"mr-1",3,"icon"],[1,"mt-2","flex","justify-between","border-b","border-slate-300","text-xs"],[1,"flex","flex-row"],[1,"tabs-main","w-28",3,"click"],["class","tabs-main w-28",3,"class","click",4,"ngIf"],["type","button","class","bg-rose-500 px-3 py-2  rounded text-white hover:opacity-75",3,"click",4,"ngIf"],["type","button",1,"bg-rose-500","px-3","py-2","rounded","text-white","hover:opacity-75",3,"click"],[1,"my-5","w-full","border","border-gray-200","shadow-md","rounded-xl"],["class","text-orange-800 border border-orange-400 bg-orange-100 rounded-md p-3 mb-2 w-full",4,"ngIf"],["class","flex flex-col",4,"ngIf"],["class","w-full text-sm text-left",4,"ngIf"],[1,"text-orange-800","border","border-orange-400","bg-orange-100","rounded-md","p-3","mb-2","w-full"],[1,"flex","flex-col"],[1,"w-full","flex","justify-center"],["animation","spin",1,"pt-10",3,"icon"],[1,"w-full","flex","justify-center","pb-10","font-semibold"],[1,"w-full","text-sm","text-left"],[1,"text-xs","text-white","uppercase","bg-blue-500"],["scope","col",1,"py-3","px-6"],["class","bg-white border-b",4,"ngFor","ngForOf"],["class","bg-white border-b",4,"ngIf"],[1,"bg-white","border-b"],["colspan","7",4,"ngIf"],[1,"py-4","px-6"],["type","button","class","rounded-md bg-blue-500 text-white py-1 px-2",3,"click",4,"ngIf"],["colspan","7"],[1,"text-center"],["type","button",1,"rounded-md","bg-blue-500","text-white","py-1","px-2",3,"click"],[1,"text-center","py-3","flex","flex-col"],[1,"flex","justify-center"],["type","button",1,"mt-3","bg-blue-500","px-3","py-1","rounded-md","text-white","hover:opacity-75",3,"click"],[3,"getPatientTbHistory","patient_id","selected_tb_consult","max_date"],[3,"getPatientTbHistory","patient_id","selected_tb_consult"],[3,"loadConsult","toggle_content","consult_details","have_complaint","allowed_to_edit"],[3,"loadConsult","toggle_content","consult_details","have_complaint","allowed_to_edit","user_id"],[3,"toggleModal","consult_id","consult_date","patient_id","pt_group"],[3,"toggleModal","switchPage","getPatientTbHistory","selected_tb_consult","max_date"],[3,"switchPage","patient_id","program_id","program_name","max_date"],[3,"switchPage","program_id","program_name","max_date","selected_case"],[3,"switchPage","program_id","program_name","max_date","consult_details"]],template:function(i,o){1&i&&(t.j41(0,"div",0)(1,"nav",1)(2,"button",2),t.bIt("click",function(){return o.switchPage(1)}),t.EFF(3," TREATMENT ARCHIVE "),t.k0s(),t.DNE(4,Fe,2,2,"button",3)(5,xe,2,2,"button",3),t.k0s(),t.j41(6,"div",4),t.DNE(7,ke,3,1,"button",5),t.k0s()(),t.DNE(8,we,12,9,"nav",6)(9,Xe,4,3,"div",7)(10,He,1,3,"app-casefindings",8)(11,Se,1,3,"app-case-holding",8)(12,Pe,1,2,"app-dots-chart",9)(13,Oe,3,9,"div",10)(14,qe,2,5,"div",10)(15,Ve,1,4,"app-end-visit",11)(16,Je,1,2,"app-treatment-outcome",12)(17,Be,1,4,"app-caserate",13)(18,Ae,1,4,"app-eclaims",14)(19,Ue,1,4,"app-esoa",15)),2&i&&(t.R7$(2),t.HbH(1===o.pages?"tabs-main-true rounded-t-md":"tabs-main-false"),t.R7$(2),t.Y8G("ngIf",!o.selected_tb_consult||(null==o.selected_tb_consult?null:o.selected_tb_consult.facility_code)===o.user_facility),t.R7$(),t.Y8G("ngIf",!o.selected_tb_consult||(null==o.selected_tb_consult?null:o.selected_tb_consult.facility_code)===o.user_facility),t.R7$(2),t.Y8G("ngIf",!(null!=o.consult_details&&o.consult_details.consult_done)),t.R7$(),t.Y8G("ngIf",2===o.pages),t.R7$(),t.Y8G("ngIf",1===o.pages),t.R7$(),t.Y8G("ngIf",2===o.pages&&1===o.module),t.R7$(),t.Y8G("ngIf",2===o.pages&&3===o.module),t.R7$(),t.Y8G("ngIf",2===o.pages&&4===o.module),t.R7$(),t.Y8G("ngIf",2===o.pages&&5===o.module),t.R7$(),t.Y8G("ngIf",2===o.pages&&6===o.module),t.R7$(),t.Y8G("ngIf",o.modals.end_visit),t.R7$(),t.Y8G("ngIf",o.modals.treatment_outcome),t.R7$(),t.Y8G("ngIf",2===o.pages&&8===o.module),t.R7$(),t.Y8G("ngIf",3===o.pages),t.R7$(),t.Y8G("ngIf",2===o.pages&&9===o.module))},dependencies:[m.Sq,m.bT,b.aY,y.u,j.G,M.i,w._,$.W,E.H,I.U,nt,Wt,ce,Ce,m.vh],encapsulation:2})}}return n})()}];let ze=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({imports:[C.iI.forChild(Le),C.iI]})}}return n})();var Qe=l(4959),Ze=l(8249);let We=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({imports:[m.MD,ze,b.dX,s.YN,s.X1,y.u,Y.c,j.G,Qe.u,Ze.a,w._,$.W,E.H,I.U]})}}return n})()}}]);