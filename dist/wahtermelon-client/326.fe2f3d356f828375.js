"use strict";(self.webpackChunkwahtermelon_client=self.webpackChunkwahtermelon_client||[]).push([[326],{5326:(h,f,l)=>{l.r(f),l.d(f,{EnvironmentalModule:()=>M});var s=l(6895),u=l(5749),n=l(4006),d=l(4128),_=l(3396),g=l(2687),e=l(4650),y=l(4691),w=l(7185),x=l(1512),v=l(2216);function Z(a,o){if(1&a&&(e.TgZ(0,"option",32),e._uU(1),e.qZA()),2&a){const t=o.$implicit,i=e.oxw(2);e.Tol(i.checkExist(t)?"bg-green-700 text-white":""),e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function b(a,o){if(1&a&&(e.TgZ(0,"option",32),e._uU(1),e.qZA()),2&a){const t=o.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.desc)}}function N(a,o){if(1&a&&(e.TgZ(0,"option",35),e._uU(1),e.qZA()),2&a){const t=o.$implicit;e.Q6J("ngValue",t.value),e.xp6(1),e.Oqu(t.desc)}}function T(a,o){if(1&a&&(e.TgZ(0,"div")(1,"label",33),e._uU(2),e.TgZ(3,"span",14),e._uU(4,"*"),e.qZA()(),e.TgZ(5,"select",34)(6,"option",35),e._uU(7,"-"),e.qZA(),e.YNc(8,N,2,2,"option",36),e.qZA()()),2&a){const t=o.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("for",t.var_name),e.xp6(1),e.hij("",t.title," "),e.xp6(3),e.Q6J("name",t.var_name)("id",t.var_name)("formControlName",t.var_name),e.xp6(1),e.Q6J("ngValue",null),e.xp6(2),e.Q6J("ngForOf",i.ans_yn)}}function I(a,o){if(1&a&&(e.TgZ(0,"option",32),e._uU(1),e.qZA()),2&a){const t=o.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.desc)}}function E(a,o){if(1&a&&(e.TgZ(0,"fieldset",37)(1,"legend"),e._uU(2),e.qZA(),e.TgZ(3,"div")(4,"label",33),e._uU(5,"Date of validation"),e.qZA(),e._UZ(6,"input",38),e.qZA(),e.TgZ(7,"div")(8,"label",33),e._uU(9,"Result"),e.qZA(),e.TgZ(10,"select",34)(11,"option",32),e._uU(12,"-"),e.qZA(),e.TgZ(13,"option",39),e._uU(14,"Positive"),e.qZA(),e.TgZ(15,"option",40),e._uU(16,"Negative"),e.qZA()()()()),2&a){const t=o.$implicit;e.xp6(2),e.Oqu(t.title),e.xp6(2),e.Q6J("for",t.date_var),e.xp6(2),e.Q6J("name",t.date_var)("id",t.date_var)("formControlName",t.date_var),e.xp6(2),e.Q6J("for",t.result_var),e.xp6(2),e.Q6J("name",t.result_var)("id",t.result_var)("formControlName",t.result_var),e.xp6(1),e.Q6J("value",null)}}function F(a,o){if(1&a&&(e.TgZ(0,"div"),e._UZ(1,"input",43),e.TgZ(2,"label",44),e._uU(3),e.qZA()()),2&a){const t=o.$implicit;e.xp6(1),e.Q6J("formControlName",t.var_name),e.uIk("id",t.var_name),e.xp6(1),e.uIk("for",t.var_name),e.xp6(1),e.Oqu(t.title)}}function A(a,o){1&a&&(e.TgZ(0,"div",26)(1,"label",45),e._uU(2,"Remarks"),e.qZA(),e._UZ(3,"input",46),e.qZA())}function C(a,o){if(1&a&&(e.TgZ(0,"fieldset",41)(1,"legend"),e._uU(2),e.qZA(),e.TgZ(3,"div",8),e.YNc(4,F,4,4,"div",21),e.qZA(),e.YNc(5,A,4,0,"div",42),e.qZA()),2&a){const t=o.$implicit,i=o.index,r=e.oxw(2);e.xp6(2),e.Oqu(t.title),e.xp6(2),e.Q6J("ngForOf",t.content),e.xp6(1),e.Q6J("ngIf",r.environmentalForm.value.wm_others_flag&&1===i)}}const U=function(){return{standalone:!0}};function q(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"div",7)(1,"div",8)(2,"div")(3,"label",9),e._uU(4,"Selected Year"),e.qZA(),e.TgZ(5,"select",10),e.NdJ("change",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.loadSelectedYear())})("ngModelChange",function(r){e.CHM(t);const m=e.oxw();return e.KtG(m.selected_year=r)}),e.YNc(6,Z,2,4,"option",11),e.qZA()()(),e.TgZ(7,"form",12)(8,"div")(9,"label",13),e._uU(10,"Registration Date "),e.TgZ(11,"span",14),e._uU(12,"*"),e.qZA()(),e._UZ(13,"input",15),e.qZA(),e.TgZ(14,"div")(15,"label",16),e._uU(16,"Number of families "),e.TgZ(17,"span",14),e._uU(18,"*"),e.qZA()(),e._UZ(19,"input",17),e.qZA(),e.TgZ(20,"div")(21,"label",18),e._uU(22,"Type of water "),e.TgZ(23,"span",14),e._uU(24,"*"),e.qZA()(),e.TgZ(25,"select",19),e.YNc(26,b,2,2,"option",20),e.qZA()(),e.YNc(27,T,9,7,"div",21),e.TgZ(28,"div")(29,"label",22),e._uU(30,"Type of Toilet Facility "),e.TgZ(31,"span",14),e._uU(32,"*"),e.qZA()(),e.TgZ(33,"select",23),e.YNc(34,I,2,2,"option",20),e.qZA()(),e.TgZ(35,"div"),e._uU(36,"\xa0"),e.qZA(),e.YNc(37,E,17,10,"fieldset",24),e.YNc(38,C,6,3,"fieldset",25),e.TgZ(39,"div",26)(40,"label",27),e._uU(41,"Remarks"),e.qZA(),e._UZ(42,"input",28),e.qZA(),e.TgZ(43,"div",29)(44,"button",30),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onSubmit())}),e._UZ(45,"fa-icon",31),e._uU(46),e.qZA()()()()}if(2&a){const t=e.oxw();e.xp6(5),e.Q6J("ngModel",t.selected_year)("ngModelOptions",e.DdM(13,U)),e.xp6(1),e.Q6J("ngForOf",t.years),e.xp6(1),e.Q6J("formGroup",t.environmentalForm),e.xp6(19),e.Q6J("ngForOf",t.env_water_types),e.xp6(1),e.Q6J("ngForOf",t.sanition_flags),e.xp6(7),e.Q6J("ngForOf",t.env_toilet_facilities),e.xp6(3),e.Q6J("ngForOf",t.test_lists),e.xp6(1),e.Q6J("ngForOf",t.sw_wm_management_lists),e.xp6(6),e.Q6J("disabled",t.environmentalForm.invalid||t.is_saving),e.xp6(1),e.Q6J("icon",t.is_saving?t.faCircleNotch:t.faSave)("spin",t.is_saving),e.xp6(1),e.hij(" ",t.is_saving?t.environmentalForm.value.id?"Updating":"Saving":t.environmentalForm.value.id?"Update":"Save"," ")}}function J(a,o){if(1&a&&(e.TgZ(0,"div",47)(1,"div",48),e._UZ(2,"fa-icon",49),e.qZA(),e.TgZ(3,"div",50),e._uU(4," Loading health and sanitation... "),e.qZA()()),2&a){const t=e.oxw();e.xp6(2),e.Q6J("icon",t.faCircleNotch)}}const k=[{path:"",component:(()=>{class a{onSubmit(){this.is_saving=!0;let t=(0,s.p6)(this.environmentalForm.value.registration_date,"yyyy","en","Asia/Manila");this.environmentalForm.patchValue({effectivity_year:t}),this.http.post("households/environmental/records",this.environmentalForm.value).subscribe({next:()=>{this.toastr.success("Successfully recorded!","Environmental"),this.loadEnvironmental(),this.is_saving=!1},error:i=>this.http.showError(i.error.message,"Environmental")})}loadEnvironmental(){this.show_form=!1,this.http.get("households/environmental/records",{params:{household_folder_id:this.household_folder_id}}).subscribe({next:i=>{console.log(i),this.environmental_list=i.data,this.loadSelectedYear()},error:i=>{this.http.showError(i.error.message,"Household Profile"),this.show_form=!0}})}loadSelectedYear(){let t=this.checkExist();this.selected_profile=t,this.selected_profile&&Object.keys(this.selected_profile).length>0?(this.environmentalForm.patchValue({...this.selected_profile}),this.environmentalForm.patchValue({validation_date:this.environmentalForm.value.validation_date?this.dateHelper.dateFormat(this.environmentalForm.value.validation_date):null,arsenic_date:this.environmentalForm.value.arsenic_date?this.dateHelper.dateFormat(this.environmentalForm.value.arsenic_date):null})):this.emptyForm(),this.show_form=!0}checkExist(t){return t?!!this.environmental_list.find(r=>Number(r.effectivity_year)===Number(t)):this.environmental_list.find(i=>Number(i.effectivity_year)===Number(this.selected_year))}createForm(){this.show_form=!1,this.selected_year=Number(this.year),this.emptyForm(),this.loadEnvironmental()}emptyForm(){this.environmentalForm=this.formBuilder.group({id:[null],household_folder_id:[this.household_folder_id,n.kI.required],number_of_families:[null,n.kI.required],registration_date:[null,n.kI.required],effectivity_year:[null],water_type_code:[null,n.kI.required],safety_managed_flag:[null,n.kI.required],sanitation_managed_flag:[null,n.kI.required],satisfaction_management_flag:[null,n.kI.required],complete_sanitation_flag:[null,n.kI.required],located_premises_flag:[null,n.kI.required],availability_flag:[null,n.kI.required],microbiological_result:[null],validation_date:[null],arsenic_result:[null],arsenic_date:[null],open_defecation_flag:[null,n.kI.required],toilet_facility_code:[null,n.kI.required],toilet_shared_flag:[null,n.kI.required],sw_disposed_flag:[!1],sw_collected_flag:[!1],wm_waste_segration_flag:[!1],wm_backyad_composting_flag:[!1],wm_recycling_flag:[!1],wm_collected_flag:[!1],wm_others_flag:[!1],wm_others_remarks:[null],remarks:[null],end_sanitation_flag:[0]})}loadLibraries(){this.show_form=!1;const t=this.http.get("libraries/environmental-result"),i=this.http.get("libraries/environmental-sewage"),r=this.http.get("libraries/environmental-toilet-facility"),m=this.http.get("libraries/environmental-waste-management"),c=this.http.get("libraries/environmental-water-type");(0,d.D)([t,i,r,m,c]).subscribe({next:([Q,Y,S,D,H])=>{this.env_results=Q.data,this.env_sewages=Y.data,this.env_toilet_facilities=S.data,this.env_waste_managements=D.data,this.env_water_types=H.data,this.createForm()}})}constructor(t,i,r,m){this.http=t,this.toastr=i,this.formBuilder=r,this.dateHelper=m,this.faSave=_.r6l,this.faCircleNotch=g.IJ7,this.environmentalForm=function p(){return new n.cw({id:new n.NI(null),household_folder_id:new n.NI(null),number_of_families:new n.NI(null),registration_date:new n.NI(null),effectivity_year:new n.NI(null),water_type_code:new n.NI(null),safety_managed_flag:new n.NI(!1),sanitation_managed_flag:new n.NI(!1),satisfaction_management_flag:new n.NI(!1),complete_sanitation_flag:new n.NI(!1),located_premises_flag:new n.NI(!1),availability_flag:new n.NI(!1),microbiological_result:new n.NI(null),validation_date:new n.NI(null),arsenic_result:new n.NI(null),arsenic_date:new n.NI(null),open_defecation_flag:new n.NI(!1),toilet_shared_flag:new n.NI(!1),toilet_facility_code:new n.NI(null),sw_disposed_flag:new n.NI(!1),sw_collected_flag:new n.NI(!1),wm_waste_segration_flag:new n.NI(!1),wm_backyad_composting_flag:new n.NI(!1),wm_recycling_flag:new n.NI(!1),wm_collected_flag:new n.NI(!1),wm_others_flag:new n.NI(!1),wm_others_remarks:new n.NI(null),remarks:new n.NI(null),end_sanitation_flag:new n.NI(!1)})}(),this.year=(0,s.p6)(new Date,"yyyy","en"),this.years=[],this.show_form=!1,this.is_saving=!1,this.ans_yn=[{desc:"Yes",value:1},{desc:"No",value:0}],this.sanition_flags=[{title:"Using safety managed drinking water services",var_name:"safety_managed_flag"},{title:"Using managed sanitation services",var_name:"sanitation_managed_flag"},{title:"Satisfaction solid waste management",var_name:"satisfaction_management_flag"},{title:"Complete sanitation facilities",var_name:"complete_sanitation_flag"},{title:"Located within premises",var_name:"located_premises_flag"},{title:"Available at least 12 hours per day",var_name:"availability_flag"},{title:"Open Defecation",var_name:"open_defecation_flag"},{title:"Toilet not shared",var_name:"toilet_shared_flag"}],this.test_lists=[{title:"Microbiological Validation",date_var:"validation_date",result_var:"microbiological_result"},{title:"Physico-chemical test for Arsenic",date_var:"arsenic_date",result_var:"arsenic_result"}],this.sw_wm_management_lists=[{title:"Disposal/Treatment of Excreta/Sewage",content:[{title:"Sewage/excreta is safely disposed in situ",var_name:"sw_disposed_flag"},{title:"Sewage/excreta is collected, transported and disposed off site",var_name:"sw_collected_flag"}]},{title:"Waste Management",content:[{title:"Waste Segregation",var_name:"wm_waste_segration_flag"},{title:"Backyard Composting",var_name:"wm_backyad_composting_flag"},{title:"Recycling/Reuse",var_name:"wm_recycling_flag"},{title:"Collected by City/Municipality Collection and Disposal System",var_name:"wm_collected_flag"},{title:"Others (Burning / Burying, Specify)",var_name:"wm_others_flag"}]}];for(let c=Number(this.year);c>2017;c--)this.years.push(c)}ngOnInit(){this.household_folder_id=this.http.getUrlParams().patient_id,this.loadLibraries()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(y.O),e.Y36(w._W),e.Y36(n.qu),e.Y36(x.Y))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-environmental"]],decls:8,vars:2,consts:[[1,"my-10","flex","justify-center","w-full"],[1,"w-full","bg-white","border","border-solid","border-slate-100","rounded-xl","shadow-md"],[1,"border","border-solid","border-slate-100","rounded-t-xl","font-semibold","justify-between"],[1,"flex","border","border-solid","border-slate-100","rounded-t-xl","p-3","font-semibold","justify-between"],[1,"text-blue-500","text-lg","pt-2","pl-5"],["class","overflow-x-auto relative grid grid-cols-3 gap-4 m-10",4,"ngIf"],["class","grid grid-cols-1 my-24",4,"ngIf"],[1,"overflow-x-auto","relative","grid","grid-cols-3","gap-4","m-10"],[1,"col-span-3","grid","grid-cols-3","gap-4"],["for","selected_year"],["name","selected_year","id","selected_year",1,"input",3,"ngModel","ngModelOptions","change","ngModelChange"],[3,"value","class",4,"ngFor","ngForOf"],[1,"col-span-3","grid","grid-cols-3","gap-4",3,"formGroup"],["for","registration_date"],[1,"text-red-500"],["type","date","name","registration_date","id","registration_date","formControlName","registration_date",1,"input"],["for","number_of_families"],["type","number","name","number_of_families","id","number_of_families","formControlName","number_of_families",1,"input"],["for","water_type_code"],["name","water_type_code","id","water_type_code","formControlName","water_type_code",1,"input"],[3,"value",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["for","toilet_facility_code"],["name","toilet_facility_code","id","toilet_facility_code","formControlName","toilet_facility_code",1,"input"],["class","col-span-3 grid grid-cols-3 gap-4 border border-blue-300 p-5 mx-10",4,"ngFor","ngForOf"],["class","select-none col-span-3 grid grid-cols-3 gap-4 border border-blue-300 p-5 mx-10",4,"ngFor","ngForOf"],[1,"col-span-3"],["for","remarks"],["type","text","name","remarks","id","remarks","formControlName","remarks",1,"input"],[1,"col-span-3","flex","justify-center"],["type","submit",1,"btn-save",3,"disabled","click"],[3,"icon","spin"],[3,"value"],[3,"for"],[1,"input",3,"name","id","formControlName"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"col-span-3","grid","grid-cols-3","gap-4","border","border-blue-300","p-5","mx-10"],["type","date",1,"input",3,"name","id","formControlName"],["value","POSITIVE"],["value","NEGATIVE"],[1,"select-none","col-span-3","grid","grid-cols-3","gap-4","border","border-blue-300","p-5","mx-10"],["class","col-span-3",4,"ngIf"],["type","checkbox",1,"input-checkbox",3,"formControlName"],[1,"pl-2"],["for","wm_others_remarks"],["type","text","name","wm_others_remarks","id","wm_others_remarks","formControlName","wm_others_remarks",1,"input"],[1,"grid","grid-cols-1","my-24"],[1,"flex","justify-center","text-blue-500"],["spin","true",3,"icon"],[1,"flex","justify-center"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e._uU(5," Environmental Health and Sanitation "),e.qZA()(),e.YNc(6,q,47,14,"div",5),e.YNc(7,J,5,1,"div",6),e.qZA()()()),2&t&&(e.xp6(6),e.Q6J("ngIf",i.show_form),e.xp6(1),e.Q6J("ngIf",!i.show_form))},dependencies:[s.sg,s.O5,n._Y,n.YN,n.Kr,n.Fj,n.wV,n.Wl,n.EJ,n.JJ,n.JL,n.On,n.sg,n.u,v.BN]}),a})()}];let O=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[u.Bz.forChild(k),u.Bz]}),a})(),M=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[s.ez,O,n.u5,n.UX,v.uH]}),a})()},1512:(h,f,l)=>{l.d(f,{Y:()=>n});var s=l(6895),u=l(4650);let n=(()=>{class d{dateFormat(_){try{return(0,s.p6)(_,"yyyy-MM-dd","en","Asia/Manila")}catch{return"Date is not valid"}}timeFormatAmPm(_){try{return(0,s.p6)(_,"hh:mma","en","Asia/Manila")}catch{return"Date is not valid"}}timeFormat(_){try{return(0,s.p6)(_,"HH:mm:ss","en","Asia/Manila")}catch{return"Date is not valid"}}}return d.\u0275fac=function(_){return new(_||d)},d.\u0275prov=u.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()}}]);