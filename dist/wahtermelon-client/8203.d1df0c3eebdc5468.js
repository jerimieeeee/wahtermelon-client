"use strict";(self.webpackChunkwahtermelon_client=self.webpackChunkwahtermelon_client||[]).push([[8203],{8203:(V,f,r)=>{r.r(f),r.d(f,{FeedbackModule:()=>N});var u=r(177),d=r(3895),l=r(5383),t=r(3953),m=r(3318),a=r(9417),_=r(60),h=r(614),g=r(3236),p=r(1584),v=r(6697);function b(n,s){if(1&n){const e=t.RV6();t.j41(0,"button",19),t.bIt("click",function(){const i=t.eBV(e).$implicit,c=t.XpG(3);return t.Njj(c.logScore(i))}),t.nrm(1,"fa-icon",20),t.k0s()}if(2&n){const e=s.$implicit,o=t.XpG(3);t.R7$(),t.HbH(o.feedback_answers[o.question_list[o.question_index].column_name]&&o.feedback_answers[o.question_list[o.question_index].column_name]===e&&(1===e?"text-white bg-red-500":2===e?"text-white bg-yellow-500":"text-white bg-green-600")),t.Y8G("icon",1===e?o.faFaceFrown:2===e?o.faFaceMeh:o.faFaceLaughBeam)}}function F(n,s){if(1&n&&(t.j41(0,"div",17),t.DNE(1,b,2,3,"button",18),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.Y8G("ngForOf",e.question_score)}}function k(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",17)(1,"textarea",21),t.mxI("ngModelChange",function(i){t.eBV(e);const c=t.XpG(2);return t.DH7(c.feedback_answers.remarks,i)||(c.feedback_answers.remarks=i),t.Njj(i)}),t.k0s()()}if(2&n){const e=t.XpG(2);t.R7$(),t.R50("ngModel",e.feedback_answers.remarks)}}function y(n,s){if(1&n&&t.nrm(0,"fa-icon",12),2&n){const e=t.XpG(2);t.Y8G("icon",e.question_index===e.question_length-1?e.faSave:e.faArrowRight)}}function w(n,s){if(1&n&&t.nrm(0,"fa-icon",22),2&n){const e=t.XpG(2);t.Y8G("icon",e.question_index===e.question_length-1?e.faCircleNotch:e.faArrowRight)}}function I(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",3)(1,"div",4),t.EFF(2," Client Feedback "),t.k0s(),t.j41(3,"div",5)(4,"div",6)(5,"div",7),t.EFF(6),t.k0s(),t.DNE(7,F,2,1,"div",8)(8,k,2,1,"div",9),t.k0s(),t.j41(9,"div",10)(10,"button",11),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.previousQuestion())}),t.nrm(11,"fa-icon",12),t.EFF(12," Previous "),t.k0s(),t.j41(13,"div",13),t.EFF(14),t.k0s(),t.j41(15,"button",14),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.question_index===i.question_length-1?i.onSubmit():i.nextQuestion())}),t.EFF(16),t.DNE(17,y,1,1,"fa-icon",15)(18,w,1,1,"fa-icon",16),t.k0s()()()()}if(2&n){const e=t.XpG();t.R7$(6),t.SpI(" ",e.question_list[e.question_index].question," "),t.R7$(),t.Y8G("ngIf","remarks"!==e.question_list[e.question_index].column_name),t.R7$(),t.Y8G("ngIf","remarks"===e.question_list[e.question_index].column_name),t.R7$(2),t.Y8G("disabled",0===e.question_index),t.R7$(),t.Y8G("icon",e.faArrowLeft),t.R7$(3),t.Lme(" ",e.question_index+1,"/",e.question_length," "),t.R7$(),t.Y8G("disabled",e.is_saving)("disabled",!e.feedback_answers[e.question_list[e.question_index].column_name]&&"remarks"!==e.question_list[e.question_index].column_name),t.R7$(),t.SpI(" ",e.question_index===e.question_length-1?e.is_saving?"Saving":"Submit":"Next"," "),t.R7$(),t.Y8G("ngIf",!e.is_saving),t.R7$(),t.Y8G("ngIf",e.is_saving)}}function C(n,s){if(1&n&&(t.j41(0,"div",23)(1,"span"),t.EFF(2,"Maraming salamat sa iyong kooperasayon. "),t.nrm(3,"br"),t.EFF(4),t.k0s()()),2&n){const e=t.XpG();t.R7$(4),t.SpI(" Redirecting in ",e.countdown," secs")}}function G(n,s){if(1&n&&(t.j41(0,"div",24)(1,"div",25),t.nrm(2,"fa-icon",22),t.k0s(),t.j41(3,"div",26),t.EFF(4," Loading questions... "),t.k0s()()),2&n){const e=t.XpG();t.R7$(2),t.Y8G("icon",e.faCircleNotch)}}let j=(()=>{class n{onSubmit(){this.is_saving=!0,this.http.post("consultation/feedback",this.feedback_answers).subscribe({next:e=>{console.log(e),this.survey_completed=!0,this.is_saving=!1,this.startCountdown()},error:e=>{this.http.showError(e.error.message,"Consult Feedback")}})}startCountdown(){(function x(n=0,s=g.E){return n<0&&(n=0),(0,p.O)(n,n,s)})(1e3).pipe((0,v.s)(5)).subscribe({next:o=>{this.countdown=5-(o+1)},complete:()=>{this.toggleSurveyForm.emit()}})}logScore(e){this.feedback_answers[this.question_list[this.question_index].column_name]=e}previousQuestion(){this.question_index-=1}nextQuestion(){this.question_index+=1}loadLibraries(){this.http.get("libraries/feedback-question").subscribe({next:e=>{console.log(e.data),this.question_list=e.data,this.question_length=Object.keys(this.question_list).length,this.show_form=!0},error:e=>{this.http.showError(e.error.message,"Feedback Questions")}})}constructor(e,o){this.http=e,this.router=o,this.toggleSurveyForm=new t.bkB,this.faCircleNotch=l.s4k,this.faSave=h.hSh,this.faArrowRight=l.dmS,this.faArrowLeft=l.CeG,this.faFaceFrown=l.HoF,this.faFaceLaughBeam=l.HLW,this.faFaceMeh=l.Lz9,this.countdown=5,this.show_form=!1,this.question_length=0,this.question_index=0,this.question_score=[1,2,3],this.survey_completed=!1,this.is_saving=!1}ngOnInit(){this.feedback_answers={consult_id:this.consultationId,overall_score:null,cleanliness_score:null,behavior_score:null,time_score:null,quality_score:null,completeness_score:null,remarks:null},this.loadLibraries()}static#t=this.\u0275fac=function(o){return new(o||n)(t.rXU(m.k),t.rXU(d.Ix))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-survey-form"]],inputs:{consultationId:"consultationId"},outputs:{toggleSurveyForm:"toggleSurveyForm"},decls:3,vars:3,consts:[["class","flex flex-col w-auto h-5/6 m-10 border border-gray-100 shadow-lg rounded-2xl",4,"ngIf"],["class","flex flex-col w-full h-full justify-center items-center text-center text-3xl bg-blue-500 font-semibold text-white",4,"ngIf"],["class","grid grid-cols-1 w-full my-24 text-center text-3xl",4,"ngIf"],[1,"flex","flex-col","w-auto","h-5/6","m-10","border","border-gray-100","shadow-lg","rounded-2xl"],[1,"bg-blue-500","h-16","text-2xl","p-4","font-semibold","text-white","uppercase","rounded-t-2xl"],[1,"flex","flex-col","h-full"],[1,"flex-grow","grid","grid-cols-1","mb-10","mx-10"],[1,"text-3xl","font-semibold","text-center","my-auto"],["class","grid grid-cols-3",4,"ngIf"],["class","grid grid-cols-3 ",4,"ngIf"],[1,"grid","grid-cols-3","m-10"],[1,"bg-gray-300","text-gray-500","rounded-md","h-16","disabled:opacity-25","text-xl",3,"click","disabled"],[3,"icon"],[1,"text-2xl","text-center","mt-3"],[1,"bg-blue-500","text-white","rounded-md","h-16","text-xl","disabled:opacity-25",3,"click","disabled"],[3,"icon",4,"ngIf"],["animation","spin",3,"icon",4,"ngIf"],[1,"grid","grid-cols-3"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"text-8xl","px-10","py-6","rounded-2xl","text-gray-100","bg-gray-300",3,"icon"],[1,"input","col-span-3","text-xl",3,"ngModelChange","ngModel"],["animation","spin",3,"icon"],[1,"flex","flex-col","w-full","h-full","justify-center","items-center","text-center","text-3xl","bg-blue-500","font-semibold","text-white"],[1,"grid","grid-cols-1","w-full","my-24","text-center","text-3xl"],[1,"flex","justify-center","text-blue-500"],[1,"flex","justify-center"]],template:function(o,i){1&o&&t.DNE(0,I,19,12,"div",0)(1,C,5,1,"div",1)(2,G,5,1,"div",2),2&o&&(t.Y8G("ngIf",i.show_form&&!i.survey_completed),t.R7$(),t.Y8G("ngIf",i.show_form&&i.survey_completed),t.R7$(),t.Y8G("ngIf",!i.show_form))},dependencies:[u.Sq,u.bT,a.me,a.BC,a.vS,_.aY]})}return n})();function S(n,s){1&n&&(t.j41(0,"span"),t.EFF(1,"Invalid input, or visit already has recorded feedback."),t.k0s())}function R(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(e)}}function q(n,s){if(1&n&&t.nrm(0,"fa-icon",16),2&n){const e=t.XpG(3);t.Y8G("icon",e.faArrowLeft)}}function $(n,s){if(1&n){const e=t.RV6();t.j41(0,"button",14),t.bIt("click",function(){const i=t.eBV(e).$implicit,c=t.XpG(2);return t.Njj(c.concat(i))}),t.DNE(1,R,2,1,"span",12)(2,q,1,1,"fa-icon",15),t.k0s()}if(2&n){const e=s.$implicit;t.HbH("clear"===e?"bg-rose-500":"bg-sky-500"),t.R7$(),t.Y8G("ngIf","delete"!==e),t.R7$(),t.Y8G("ngIf","delete"===e)}}function T(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",2)(1,"div",3)(2,"a",4),t.nrm(3,"img",5),t.k0s()(),t.j41(4,"div",6)(5,"div",7),t.nrm(6,"input",8),t.j41(7,"input",9),t.mxI("ngModelChange",function(i){t.eBV(e);const c=t.XpG();return t.DH7(c.consultationId,i)||(c.consultationId=i),t.Njj(i)}),t.k0s(),t.j41(8,"button",10),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.checkVisitFeedback())}),t.EFF(9," OK "),t.k0s()(),t.j41(10,"div",11),t.DNE(11,S,2,0,"span",12),t.k0s(),t.DNE(12,$,3,4,"button",13),t.k0s()()}if(2&n){const e=t.XpG();t.R7$(7),t.R50("ngModel",e.consultationId),t.R7$(4),t.Y8G("ngIf",e.show_invalid),t.R7$(),t.Y8G("ngForOf",e.numbers)}}function Y(n,s){if(1&n){const e=t.RV6();t.j41(0,"app-survey-form",17),t.bIt("toggleSurveyForm",function(i){t.eBV(e);const c=t.XpG();return t.Njj(c.toggleSurveyForm(i))}),t.k0s()}if(2&n){const e=t.XpG();t.Y8G("consultationId",e.consultationId)}}const X=[{path:"",component:(()=>{class n{concat(e){"number"==typeof e&&(this.consultationId=this.consultationId+""+e),"delete"===e&&(this.consultationId=this.consultationId.substring(0,this.consultationId.length-1)),"clear"===e&&(this.consultationId="")}checkVisitFeedback(){this.show_invalid=!1,this.show_survey=!1,this.http.get("consultation/records/"+this.consultationId).subscribe({next:e=>{e.for_feedback?this.show_survey=!0:this.show_invalid=!0},error:()=>{this.show_invalid=!0}})}toggleSurveyForm(){console.log("test"),this.consultationId="",this.show_survey=!1}constructor(e){this.http=e,this.faArrowLeft=l.CeG,this.numbers=[1,2,3,4,5,6,7,8,9,"delete",0,"clear"],this.consultationId="",this.show_survey=!1,this.show_invalid=!1}static#t=this.\u0275fac=function(o){return new(o||n)(t.rXU(m.k))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-feedback"]],decls:2,vars:2,consts:[["class","grid grid-cols-1 gap-5 h-dvh",4,"ngIf"],[3,"consultationId","toggleSurveyForm",4,"ngIf"],[1,"grid","grid-cols-1","gap-5","h-dvh"],[1,"flex","justify-center","align-middle"],["routerLink","/"],["src","./assets/img/wah_icon.png",1,"rounded-full","w-32","h-32","mx-auto"],[1,"grid","grid-cols-3","gap-6","h-5/6","font-semibold","mx-20"],[1,"col-span-3","flex","mb-5"],["type","text","placeholder","Visit No.","disabled","",1,"w-1/5","text-center","rounded-l-lg","text-2xl","disabled:bg-gray-200"],["type","text","readonly","",1,"w-full","text-center","text-4xl",3,"ngModelChange","ngModel"],[1,"bg-sky-500","rounded-r-lg","h-full","w-28","text-white","text-2xl",3,"click"],[1,"text-red-500","col-span-3","flex","justify-center","h-8"],[4,"ngIf"],["class","border-2 rounded-lg text-white w-full h-full text-center text-4xl py-5",3,"class","click",4,"ngFor","ngForOf"],[1,"border-2","rounded-lg","text-white","w-full","h-full","text-center","text-4xl","py-5",3,"click"],[3,"icon",4,"ngIf"],[3,"icon"],[3,"toggleSurveyForm","consultationId"]],template:function(o,i){1&o&&t.DNE(0,T,13,3,"div",0)(1,Y,1,1,"app-survey-form",1),2&o&&(t.Y8G("ngIf",!i.show_survey),t.R7$(),t.Y8G("ngIf",i.show_survey))},dependencies:[u.Sq,u.bT,d.Wk,a.me,a.BC,a.vS,_.aY,j]})}return n})()}];let E=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.$C({type:n});static#n=this.\u0275inj=t.G2t({imports:[d.iI.forChild(X),d.iI]})}return n})(),N=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.$C({type:n});static#n=this.\u0275inj=t.G2t({imports:[u.MD,E,a.YN,_.dX]})}return n})()}}]);