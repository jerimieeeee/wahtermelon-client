(self.webpackChunkwahtermelon_client=self.webpackChunkwahtermelon_client||[]).push([[2076],{8437:(R,w,a)=>{"use strict";a.d(w,{Z:()=>f});var t=a(4438),n=a(177),v=a(614),u=a(60),E=a(5383),g=a(8761),d=a(9417),M=a(3318),y=a(5794);const s=l=>({"rounded-b":l});function i(l,m){if(1&l){const e=t.RV6();t.j41(0,"span",21)(1,"span")(2,"fa-icon",22),t.bIt("click",function(){const c=t.eBV(e);return t.Njj((0,c.clear)(c.item))}),t.k0s()(),t.j41(3,"span"),t.EFF(4),t.k0s()()}if(2&l){const e=m.item,r=t.XpG(2);t.R7$(2),t.Y8G("icon",r.faXmark),t.R7$(2),t.JRh(e.complaint_desc)}}function h(l,m){if(1&l&&(t.j41(0,"div",23)(1,"div")(2,"h5",24),t.EFF(3),t.k0s()()()),2&l){const e=m.item,r=m.searchTerm;t.R7$(2),t.Y8G("ngOptionHighlight",r),t.R7$(),t.JRh(e.complaint_desc)}}function o(l,m){if(1&l&&t.nrm(0,"fa-icon",28),2&l){const e=t.XpG(3);t.Y8G("icon",e.faCircleNotch)}}function p(l,m){if(1&l&&t.nrm(0,"fa-icon",29),2&l){const e=t.XpG(3);t.Y8G("icon",e.faSave)}}function _(l,m){if(1&l){const e=t.RV6();t.j41(0,"button",25),t.bIt("click",function(){t.eBV(e);const c=t.XpG(2);return t.Njj(c.onSubmit())}),t.DNE(1,o,1,1,"fa-icon",26)(2,p,1,1,"fa-icon",27),t.EFF(3),t.k0s()}if(2&l){const e=t.XpG(2);t.Y8G("disabled",e.is_saving),t.R7$(),t.Y8G("ngIf",e.is_saving),t.R7$(),t.Y8G("ngIf",!e.is_saving),t.R7$(),t.SpI(" ",e.is_saving?"Saving":"Save"," ")}}function b(l,m){if(1&l){const e=t.RV6();t.j41(0,"div")(1,"div",8)(2,"button",9),t.nrm(3,"fa-icon",10),t.k0s(),t.j41(4,"div",11)(5,"ng-select",12),t.mxI("ngModelChange",function(c){t.eBV(e);const C=t.XpG();return t.DH7(C.selectedComplaint,c)||(C.selectedComplaint=c),t.Njj(c)}),t.DNE(6,i,5,2,"ng-template",13)(7,h,4,2,"ng-template",14),t.k0s()()(),t.j41(8,"div",15)(9,"label",16),t.EFF(10,"Complaint notes"),t.k0s(),t.j41(11,"textarea",17),t.mxI("ngModelChange",function(c){t.eBV(e);const C=t.XpG();return t.DH7(C.consult_notes.complaint,c)||(C.consult_notes.complaint=c),t.Njj(c)}),t.k0s()(),t.j41(12,"div",15)(13,"label",16),t.EFF(14,"History notes"),t.k0s(),t.j41(15,"textarea",18),t.mxI("ngModelChange",function(c){t.eBV(e);const C=t.XpG();return t.DH7(C.consult_notes.history,c)||(C.consult_notes.history=c),t.Njj(c)}),t.k0s()(),t.j41(16,"div",19),t.DNE(17,_,4,4,"button",20),t.k0s()()}if(2&l){const e=t.XpG();t.R7$(3),t.Y8G("icon",e.faPlusSquare),t.R7$(2),t.Y8G("disabled",e.consult_done||!e.allowed_to_edit)("items",e.complaints)("multiple",!0)("closeOnSelect",!1)("hideSelected",!0)("clearable",!1),t.R50("ngModel",e.selectedComplaint),t.R7$(6),t.R50("ngModel",e.consult_notes.complaint),t.R7$(4),t.R50("ngModel",e.consult_notes.history),t.R7$(2),t.Y8G("ngIf",!e.consult_done&&e.allowed_to_edit)}}let f=(()=>{class l{onSubmit(){this.is_saving=!0,this.http.post("consultation/complaint",{notes_id:this.consult_details.consult_notes.id,consult_id:this.consult_details.id,patient_id:this.consult_details.patient.id,complaints:this.selectedComplaint}).subscribe({next:r=>{this.saveNotes()},error:r=>{this.http.showError(r.error.message,"Complaint History")}})}saveNotes(){this.http.update("consultation/notes/",this.consult_details.consult_notes.id,{consult_id:this.consult_details.id,patient_id:this.consult_details.patient.id,complaint:this.consult_notes.complaint,history:this.consult_notes.history}).subscribe({next:()=>{this.is_saving=!1,this.showToastr(),this.loadConsult.emit()},error:r=>{this.http.showError(r.error.message,"Complaint History")}})}showToastr(){this.toastr.success("Successfully updated!","Complaint")}loadLib(){this.http.get("libraries/complaint").subscribe(e=>{this.complaints=e.data,this.loadSelected(),this.show_form=!0})}loadSelected(){this.gbv_complaints=[],this.show_gbv_form=!1,this.have_open_gbv=!1;let e=[];this.consult_details.consult_notes&&this.consult_details.consult_notes.complaints&&Object.entries(this.consult_details.consult_notes.complaints).forEach(([r,c],C)=>{e.push(c.complaint_id)}),this.selectedComplaint=e}getPatientGbv(){this.http.get("gender-based-violence/patient-gbv",{params:{patient_id:this.consult_details.patient.id}}).subscribe({next:r=>{r.data.length>0&&!r.data[0].outcome_date&&(this.have_open_gbv=!0),this.show_gbv_form=!0},error:r=>console.log(r)})}ngOnChanges(e){this.show_content=this.toggle_content,this.consult_details&&(this.complaints&&this.loadSelected(),this.consult_notes=this.consult_details.consult_notes,this.consult_done=this.consult_details.consult_done)}toggleModal(e){this.modals[e]=!this.modals[e],"gbv_referral"===e&&this.getPatientGbv()}constructor(e,r){this.http=e,this.toastr=r,this.loadConsult=new t.bkB,this.faPlusSquare=v.CHJ,this.faSave=v.hSh,this.faChevronCircleUp=E.AeV,this.faChevronCircleDown=E.DqM,this.faCircleNotch=E.s4k,this.faXmark=E.Jyw,this.selectedComplaint=[],this.consult_notes={complaint:null,history:null},this.modals=[],this.show_content=!0,this.is_saving=!1,this.consult_done=!1,this.show_form=!1,this.enable_edit=!1,this.show_gbv_form=!1,this.have_open_gbv=!1}ngOnInit(){this.loadLib(),this.allowed_to_edit=!0}static{this.\u0275fac=function(r){return new(r||l)(t.rXU(M.k),t.rXU(y.tw))}}static{this.\u0275cmp=t.VBU({type:l,selectors:[["app-complaint-history"]],inputs:{toggle_content:"toggle_content",consult_details:"consult_details",have_complaint:"have_complaint",allowed_to_edit:"allowed_to_edit"},outputs:{loadConsult:"loadConsult"},features:[t.OA$],decls:10,vars:5,consts:[[1,"grid","grid-cols-10","mb-5"],[1,"col-span-2","pt-2","pr-5","font-semibold"],[1,"col-span-8"],[1,"rounded-md","border","border-solid","border-gray-300"],[1,"rounded-t-md","m-0","p-2","font-semibold","text-gray-50","bg-cyan-500","flex","justify-between",3,"ngClass"],["type","button",3,"click"],["size","lg",1,"pr-2",3,"icon"],[4,"ngIf"],[1,"flex","mb-2","p-4"],["type","submit",1,"inline-flex","p-1","items-center","text-gray-50","bg-sky-400","rounded-l-md","border","border-gray-300"],[1,"text-white","fa-xl",3,"icon"],[1,"chips-container"],["placeholder","search","bindLabel","complaint_desc","bindValue","complaint_id","placeholder","Select Complaint",1,"select-chips",3,"ngModelChange","disabled","items","multiple","closeOnSelect","hideSelected","clearable","ngModel"],["ng-label-tmp",""],["ng-option-tmp",""],[1,"grid","grid-cols-1","px-4","pb-4"],["for","complaint_notes",1,"font-semibold","pl-1"],["rows","3","id","complaint_notes","placeholder","Complaint Notes",1,"placeholder-slate-400","w-full","rounded-md","border-gray-300","bg-gray-50",3,"ngModelChange","ngModel"],["rows","3","id","history_notes","placeholder","History of Current Illness",1,"placeholder-slate-400","w-full","rounded-md","border-gray-300","bg-gray-50",3,"ngModelChange","ngModel"],[1,"flex","text-right"],["type","button","class","btn-save ml-auto mr-5 mb-5 px-10 disabled:bg-gray-300",3,"disabled","click",4,"ngIf"],[1,"px-2","py-1","rounded-md","text-sm"],[1,"text-xs","mr-1","hover:text-slate-100","hover:cursor-pointer",3,"click","icon"],[1,"grid","grid-flow-col","auto-cols-max"],[3,"ngOptionHighlight"],["type","button",1,"btn-save","ml-auto","mr-5","mb-5","px-10","disabled:bg-gray-300",3,"click","disabled"],["class","mr-2","animation","spin",3,"icon",4,"ngIf"],["class","mr-2",3,"icon",4,"ngIf"],["animation","spin",1,"mr-2",3,"icon"],[1,"mr-2",3,"icon"]],template:function(r,c){1&r&&(t.j41(0,"div",0)(1,"div",1),t.EFF(2," Chief Complaint and History of Current Illness "),t.k0s(),t.j41(3,"div",2)(4,"div",3)(5,"span",4),t.EFF(6," Complaints "),t.j41(7,"button",5),t.bIt("click",function(){return c.show_content=!c.show_content}),t.nrm(8,"fa-icon",6),t.k0s()(),t.DNE(9,b,18,11,"div",7),t.k0s()()()),2&r&&(t.R7$(5),t.Y8G("ngClass",t.eq3(3,s,!c.show_content)),t.R7$(3),t.Y8G("icon",c.show_content?c.faChevronCircleUp:c.faChevronCircleDown),t.R7$(),t.Y8G("ngIf",c.show_content&&c.show_form))},dependencies:[n.MD,n.YU,n.bT,u.dX,u.aY,g.MQ,g.vr,g.Uq,g.ZZ,d.YN,d.me,d.BC,d.vS],encapsulation:2})}}return l})()},8249:(R,w,a)=>{"use strict";a.d(w,{a:()=>v});var t=a(177),n=a(4438);let v=(()=>{class u{static{this.\u0275fac=function(d){return new(d||u)}}static{this.\u0275cmp=n.VBU({type:u,selectors:[["app-initial-dx"]],decls:2,vars:0,template:function(d,M){1&d&&(n.j41(0,"p"),n.EFF(1,"initial-dx works!"),n.k0s())},dependencies:[t.MD],encapsulation:2})}}return u})()},943:(R,w,a)=>{"use strict";a.d(w,{B:()=>h});var t=a(177),n=a(4438),v=a(9417),u=a(60),E=a(614),g=a(5383),d=a(3318),M=a(5794);function y(o,p){if(1&o&&n.nrm(0,"fa-icon",11),2&o){const _=n.XpG(2);n.Y8G("icon",_.faCircleNotch)}}function s(o,p){if(1&o&&n.nrm(0,"fa-icon",12),2&o){const _=n.XpG(2);n.Y8G("icon",_.faSave)}}function i(o,p){if(1&o){const _=n.RV6();n.j41(0,"button",8),n.bIt("click",function(){n.eBV(_);const f=n.XpG();return n.Njj(f.onSubmit())}),n.DNE(1,y,1,1,"fa-icon",9)(2,s,1,1,"fa-icon",10),n.EFF(3),n.k0s()}if(2&o){const _=n.XpG();n.Y8G("disabled",_.is_saving||_.is_pregnant===_.consult_details.is_pregnant),n.R7$(),n.Y8G("ngIf",_.is_saving),n.R7$(),n.Y8G("ngIf",!_.is_saving),n.R7$(),n.SpI(" ",_.is_saving?"Saving":"Update"," ")}}let h=(()=>{class o{onSubmit(){this.consult_details.is_pregnant=this.is_pregnant,this.http.update("consultation/records/",this.consult_details.id,this.consult_details).subscribe({next:()=>{this.toastr.success("Successfully updated","Visit Record"),this.loadConsult.emit()},error:_=>{this.http.showError(_.error.message,"Visit Record")}})}constructor(_,b){this.http=_,this.toastr=b,this.loadConsult=new n.bkB,this.faSave=E.hSh,this.faCircleNotch=g.s4k,this.is_pregnant=!1,this.show_content=!0,this.is_saving=!1,this.consult_done=!1,this.show_form=!1}ngOnChanges(_){this.show_content=this.toggle_content,this.consult_details&&(this.consult_done=this.consult_details.consult_done,this.is_pregnant=this.consult_details.is_pregnant)}static{this.\u0275fac=function(b){return new(b||o)(n.rXU(d.k),n.rXU(M.tw))}}static{this.\u0275cmp=n.VBU({type:o,selectors:[["app-pregnant-tag"]],inputs:{toggle_content:"toggle_content",consult_details:"consult_details",have_complaint:"have_complaint",allowed_to_edit:"allowed_to_edit"},outputs:{loadConsult:"loadConsult"},features:[n.OA$],decls:9,vars:2,consts:[[1,"grid","grid-cols-10","mb-5"],[1,"col-span-10","border","border-gray-300","rounded-md","shadow-md"],[1,"flex","justify-between","p-4"],[1,"mt-1","select-none"],["type","checkbox","id","is_pregnant",1,"input-checkbox",3,"ngModelChange","ngModel"],["for","is_pregnant",1,"pl-2","pt-1"],[1,"flex","text-right"],["type","button","class","btn-save ml-auto px-5 disabled:bg-gray-300",3,"disabled","click",4,"ngIf"],["type","button",1,"btn-save","ml-auto","px-5","disabled:bg-gray-300",3,"click","disabled"],["class","mr-2","animation","spin",3,"icon",4,"ngIf"],["class","mr-2",3,"icon",4,"ngIf"],["animation","spin",1,"mr-2",3,"icon"],[1,"mr-2",3,"icon"]],template:function(b,f){1&b&&(n.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3)(4,"input",4),n.mxI("ngModelChange",function(m){return n.DH7(f.is_pregnant,m)||(f.is_pregnant=m),m}),n.k0s(),n.j41(5,"label",5),n.EFF(6,"Is the patient pregnant during this visit?"),n.k0s()(),n.j41(7,"div",6),n.DNE(8,i,4,4,"button",7),n.k0s()()()()),2&b&&(n.R7$(4),n.R50("ngModel",f.is_pregnant),n.R7$(4),n.Y8G("ngIf",!f.consult_done&&f.allowed_to_edit))},dependencies:[t.MD,t.bT,v.YN,v.Zm,v.BC,v.vS,u.dX,u.aY],encapsulation:2})}}return o})()},2578:function(R,w){var a,n;void 0!==(n="function"==typeof(a=function(){"use strict";function u(s,i,h){var o=new XMLHttpRequest;o.open("GET",s),o.responseType="blob",o.onload=function(){y(o.response,i,h)},o.onerror=function(){console.error("could not download file")},o.send()}function E(s){var i=new XMLHttpRequest;i.open("HEAD",s,!1);try{i.send()}catch{}return 200<=i.status&&299>=i.status}function g(s){try{s.dispatchEvent(new MouseEvent("click"))}catch{var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),s.dispatchEvent(i)}}var d="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,M=d.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),y=d.saveAs||("object"!=typeof window||window!==d?function(){}:"download"in HTMLAnchorElement.prototype&&!M?function(s,i,h){var o=d.URL||d.webkitURL,p=document.createElement("a");p.download=i=i||s.name||"download",p.rel="noopener","string"==typeof s?(p.href=s,p.origin===location.origin?g(p):E(p.href)?u(s,i,h):g(p,p.target="_blank")):(p.href=o.createObjectURL(s),setTimeout(function(){o.revokeObjectURL(p.href)},4e4),setTimeout(function(){g(p)},0))}:"msSaveOrOpenBlob"in navigator?function(s,i,h){if(i=i||s.name||"download","string"!=typeof s)navigator.msSaveOrOpenBlob(function v(s,i){return typeof i>"u"?i={autoBom:!1}:"object"!=typeof i&&(console.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\ufeff",s],{type:s.type}):s}(s,h),i);else if(E(s))u(s,i,h);else{var o=document.createElement("a");o.href=s,o.target="_blank",setTimeout(function(){g(o)})}}:function(s,i,h,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof s)return u(s,i,h);var p="application/octet-stream"===s.type,_=/constructor/i.test(d.HTMLElement)||d.safari,b=/CriOS\/[\d]+/.test(navigator.userAgent);if((b||p&&_||M)&&typeof FileReader<"u"){var f=new FileReader;f.onloadend=function(){var e=f.result;e=b?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=e:location=e,o=null},f.readAsDataURL(s)}else{var l=d.URL||d.webkitURL,m=l.createObjectURL(s);o?o.location=m:location.href=m,o=null,setTimeout(function(){l.revokeObjectURL(m)},4e4)}});d.saveAs=y.saveAs=y,R.exports=y})?a.apply(w,[]):a)&&(R.exports=n)}}]);