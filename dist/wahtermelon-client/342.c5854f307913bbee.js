"use strict";(self.webpackChunkwahtermelon_client=self.webpackChunkwahtermelon_client||[]).push([[342],{4342:(B,d,r)=>{r.r(d),r.d(d,{EnvironmentalModule:()=>k});var s=r(6814),c=r(3602),n=r(6223),u=r(9315),p=r(1449),v=r(590),e=r(5879),h=r(265),w=r(2425),f=r(5597);function y(i,a){if(1&i&&(e.TgZ(0,"option",31),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function Z(i,a){if(1&i&&(e.TgZ(0,"option",31),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.desc)}}function x(i,a){if(1&i&&(e.TgZ(0,"option",34),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("ngValue",t.value),e.xp6(1),e.Oqu(t.desc)}}function b(i,a){if(1&i&&(e.TgZ(0,"div")(1,"label",32),e._uU(2),e.TgZ(3,"span",14),e._uU(4,"*"),e.qZA()(),e.TgZ(5,"select",33)(6,"option",34),e._uU(7,"-"),e.qZA(),e.YNc(8,x,2,2,"option",35),e.qZA()()),2&i){const t=a.$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("for",t.var_name),e.xp6(1),e.hij("",t.title," "),e.xp6(3),e.Q6J("name",t.var_name)("id",t.var_name)("formControlName",t.var_name),e.xp6(1),e.Q6J("ngValue",null),e.xp6(2),e.Q6J("ngForOf",o.ans_yn)}}function N(i,a){if(1&i&&(e.TgZ(0,"option",31),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.desc)}}function T(i,a){if(1&i&&(e.TgZ(0,"fieldset",36)(1,"legend"),e._uU(2),e.qZA(),e.TgZ(3,"div")(4,"label",32),e._uU(5,"Date of validation"),e.qZA(),e._UZ(6,"input",37),e.qZA(),e.TgZ(7,"div")(8,"label",32),e._uU(9,"Result"),e.qZA(),e.TgZ(10,"select",33)(11,"option",31),e._uU(12,"-"),e.qZA(),e.TgZ(13,"option",38),e._uU(14,"Positive"),e.qZA(),e.TgZ(15,"option",39),e._uU(16,"Negative"),e.qZA()()()()),2&i){const t=a.$implicit;e.xp6(2),e.Oqu(t.title),e.xp6(2),e.Q6J("for",t.date_var),e.xp6(2),e.Q6J("name",t.date_var)("id",t.date_var)("formControlName",t.date_var),e.xp6(2),e.Q6J("for",t.result_var),e.xp6(2),e.Q6J("name",t.result_var)("id",t.result_var)("formControlName",t.result_var),e.xp6(1),e.Q6J("value",null)}}function I(i,a){if(1&i&&(e.TgZ(0,"div"),e._UZ(1,"input",42),e.TgZ(2,"label",43),e._uU(3),e.qZA()()),2&i){const t=a.$implicit;e.xp6(1),e.Q6J("formControlName",t.var_name),e.uIk("id",t.var_name),e.xp6(1),e.uIk("for",t.var_name),e.xp6(1),e.Oqu(t.title)}}function C(i,a){1&i&&(e.TgZ(0,"div",25)(1,"label",44),e._uU(2,"Remarks"),e.qZA(),e._UZ(3,"input",45),e.qZA())}function q(i,a){if(1&i&&(e.TgZ(0,"fieldset",40)(1,"legend"),e._uU(2),e.qZA(),e.TgZ(3,"div",8),e.YNc(4,I,4,4,"div",20),e.qZA(),e.YNc(5,C,4,0,"div",41),e.qZA()),2&i){const t=a.$implicit,o=a.index,l=e.oxw(2);e.xp6(2),e.Oqu(t.title),e.xp6(2),e.Q6J("ngForOf",t.content),e.xp6(1),e.Q6J("ngIf",l.environmentalForm.value.wm_others_flag&&1===o)}}const A=function(){return{standalone:!0}};function U(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",7)(1,"div",8)(2,"div")(3,"label",9),e._uU(4,"Selected Year"),e.qZA(),e.TgZ(5,"select",10),e.NdJ("change",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.loadSelectedYear())})("ngModelChange",function(l){e.CHM(t);const _=e.oxw();return e.KtG(_.selected_year=l)}),e.YNc(6,y,2,2,"option",11),e.qZA()()(),e.TgZ(7,"form",12)(8,"div")(9,"label",13),e._uU(10,"Registration Date "),e.TgZ(11,"span",14),e._uU(12,"*"),e.qZA()(),e._UZ(13,"input",15),e.qZA(),e.TgZ(14,"div")(15,"label",16),e._uU(16,"Number of families "),e.TgZ(17,"span",14),e._uU(18,"*"),e.qZA()(),e._UZ(19,"input",17),e.qZA(),e.TgZ(20,"div")(21,"label",18),e._uU(22,"Type of water "),e.TgZ(23,"span",14),e._uU(24,"*"),e.qZA()(),e.TgZ(25,"select",19),e.YNc(26,Z,2,2,"option",11),e.qZA()(),e.YNc(27,b,9,7,"div",20),e.TgZ(28,"div")(29,"label",21),e._uU(30,"Type of Toilet Facility "),e.TgZ(31,"span",14),e._uU(32,"*"),e.qZA()(),e.TgZ(33,"select",22),e.YNc(34,N,2,2,"option",11),e.qZA()(),e.TgZ(35,"div"),e._uU(36,"\xa0"),e.qZA(),e.YNc(37,T,17,10,"fieldset",23),e.YNc(38,q,6,3,"fieldset",24),e.TgZ(39,"div",25)(40,"label",26),e._uU(41,"Remarks"),e.qZA(),e._UZ(42,"input",27),e.qZA(),e.TgZ(43,"div",28)(44,"button",29),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.onSubmit())}),e._UZ(45,"fa-icon",30),e._uU(46),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(5),e.Q6J("ngModel",t.selected_year)("ngModelOptions",e.DdM(13,A)),e.xp6(1),e.Q6J("ngForOf",t.years),e.xp6(1),e.Q6J("formGroup",t.environmentalForm),e.xp6(19),e.Q6J("ngForOf",t.env_water_types),e.xp6(1),e.Q6J("ngForOf",t.sanition_flags),e.xp6(7),e.Q6J("ngForOf",t.env_toilet_facilities),e.xp6(3),e.Q6J("ngForOf",t.test_lists),e.xp6(1),e.Q6J("ngForOf",t.sw_wm_management_lists),e.xp6(6),e.Q6J("disabled",t.environmentalForm.invalid||t.is_saving),e.xp6(1),e.Q6J("icon",t.is_saving?t.faCircleNotch:t.faSave)("spin",t.is_saving),e.xp6(1),e.hij(" ",t.is_saving?t.environmentalForm.value.id?"Updating":"Saving":t.environmentalForm.value.id?"Update":"Save"," ")}}function E(i,a){if(1&i&&(e.TgZ(0,"div",46)(1,"div",47),e._UZ(2,"fa-icon",48),e.qZA(),e.TgZ(3,"div",49),e._uU(4," Loading health and sanitation... "),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("icon",t.faCircleNotch)}}const F=[{path:"",component:(()=>{var i;class a{onSubmit(){this.is_saving=!0;let o=(0,s.p6)(this.environmentalForm.value.registration_date,"yyyy","en");this.environmentalForm.patchValue({effectivity_year:o}),this.http.post("households/environmental/records",this.environmentalForm.value).subscribe({next:()=>{this.toastr.success("Successfully recorded!","Environmental"),this.is_saving=!1},error:l=>this.http.showError(l.error.message,"Environmental")})}loadSelectedYear(){this.show_form=!1,this.http.get("households/environmental/records",{params:{effectivity_year:this.selected_year,household_id:this.household_id}}).subscribe({next:l=>{this.selected_profile=l.data[0],this.selected_profile&&Object.keys(this.selected_profile).length>0?this.environmentalForm.patchValue({...this.selected_profile}):this.emptyForm(),this.show_form=!0},error:l=>{this.http.showError(l.error.message,"Household Profile"),this.show_form=!0}})}createForm(){this.show_form=!1,this.selected_year=Number(this.year),this.emptyForm(),this.loadSelectedYear()}emptyForm(){this.environmentalForm=this.formBuilder.group({id:[null],household_folder_id:[this.household_id,n.kI.required],number_of_families:[null,n.kI.required],registration_date:[null,n.kI.required],effectivity_year:[null],water_type_code:[null,n.kI.required],safety_managed_flag:[null,n.kI.required],sanitation_managed_flag:[null,n.kI.required],satisfaction_management_flag:[null,n.kI.required],complete_sanitation_flag:[null,n.kI.required],located_premises_flag:[null,n.kI.required],availability_flag:[null,n.kI.required],microbiological_result:[null],validation_date:[null],arsenic_result:[null],arsenic_date:[null],open_defecation_flag:[null,n.kI.required],toilet_facility_code:[null,n.kI.required],toilet_shared_flag:[null,n.kI.required],sw_disposed_flag:[!1],sw_collected_flag:[!1],wm_waste_segration_flag:[!1],wm_backyad_composting_flag:[!1],wm_recycling_flag:[!1],wm_collected_flag:[!1],wm_others_flag:[!1],wm_others_remarks:[null],remarks:[null],end_sanitation_flag:[0]})}loadLibraries(){this.show_form=!1;const o=this.http.get("libraries/environmental-result"),l=this.http.get("libraries/environmental-sewage"),_=this.http.get("libraries/environmental-toilet-facility"),m=this.http.get("libraries/environmental-waste-management"),O=this.http.get("libraries/environmental-water-type");(0,u.D)([o,l,_,m,O]).subscribe({next:([Q,S,M,Y,j])=>{this.env_results=Q.data,this.env_sewages=S.data,this.env_toilet_facilities=M.data,this.env_waste_managements=Y.data,this.env_water_types=j.data,this.createForm()}})}constructor(o,l,_){this.http=o,this.toastr=l,this.formBuilder=_,this.faSave=p.r6l,this.faCircleNotch=v.IJ7,this.environmentalForm=function g(){return new n.cw({id:new n.NI(null),household_folder_id:new n.NI(null),number_of_families:new n.NI(null),registration_date:new n.NI(null),effectivity_year:new n.NI(null),water_type_code:new n.NI(null),safety_managed_flag:new n.NI(!1),sanitation_managed_flag:new n.NI(!1),satisfaction_management_flag:new n.NI(!1),complete_sanitation_flag:new n.NI(!1),located_premises_flag:new n.NI(!1),availability_flag:new n.NI(!1),microbiological_result:new n.NI(null),validation_date:new n.NI(null),arsenic_result:new n.NI(null),arsenic_date:new n.NI(null),open_defecation_flag:new n.NI(!1),toilet_shared_flag:new n.NI(!1),toilet_facility_code:new n.NI(null),sw_disposed_flag:new n.NI(!1),sw_collected_flag:new n.NI(!1),wm_waste_segration_flag:new n.NI(!1),wm_backyad_composting_flag:new n.NI(!1),wm_recycling_flag:new n.NI(!1),wm_collected_flag:new n.NI(!1),wm_others_flag:new n.NI(!1),wm_others_remarks:new n.NI(null),remarks:new n.NI(null),end_sanitation_flag:new n.NI(!1)})}(),this.year=(0,s.p6)(new Date,"yyyy","en"),this.years=[],this.show_form=!1,this.is_saving=!1,this.ans_yn=[{desc:"Yes",value:1},{desc:"No",value:0}],this.sanition_flags=[{title:"Using safety managed drinking water services",var_name:"safety_managed_flag"},{title:"Using managed sanitation services",var_name:"sanitation_managed_flag"},{title:"Satisfaction solid waste management",var_name:"satisfaction_management_flag"},{title:"Complete sanitation facilities",var_name:"complete_sanitation_flag"},{title:"Located within premises",var_name:"located_premises_flag"},{title:"Available at least 12 hours per day",var_name:"availability_flag"},{title:"Open Defecation",var_name:"open_defecation_flag"},{title:"Toilet not shared",var_name:"toilet_shared_flag"}],this.test_lists=[{title:"Microbiological Validation",date_var:"validation_date",result_var:"microbiological_result"},{title:"Physico-chemical test for Arsenic",date_var:"arsenic_date",result_var:"arsenic_result"}],this.sw_wm_management_lists=[{title:"Disposal/Treatment of Excreta/Sewage",content:[{title:"Sewage/excreta is safely disposed in situ",var_name:"sw_disposed_flag"},{title:"Sewage/excreta is collected, transported and disposed off site",var_name:"sw_collected_flag"}]},{title:"Waste Management",content:[{title:"Waste Segregation",var_name:"wm_waste_segration_flag"},{title:"Backyard Composting",var_name:"wm_backyad_composting_flag"},{title:"Recycling/Reuse",var_name:"wm_recycling_flag"},{title:"Collected by City/Municipality Collection and Disposal System",var_name:"wm_collected_flag"},{title:"Others (Burning / Burying, Specify)",var_name:"wm_others_flag"}]}];for(let m=Number(this.year);m>2017;m--)this.years.push(m)}ngOnInit(){this.household_id=this.http.getUrlParams().patient_id,this.loadLibraries()}}return(i=a).\u0275fac=function(o){return new(o||i)(e.Y36(h.O),e.Y36(w._W),e.Y36(n.qu))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-environmental"]],decls:8,vars:2,consts:[[1,"my-10","flex","justify-center","w-full"],[1,"w-full","bg-white","border","border-solid","border-slate-100","rounded-xl","shadow-md"],[1,"border","border-solid","border-slate-100","rounded-t-xl","font-semibold","justify-between"],[1,"flex","border","border-solid","border-slate-100","rounded-t-xl","p-3","font-semibold","justify-between"],[1,"text-blue-500","text-lg","pt-2","pl-5"],["class","overflow-x-auto relative grid grid-cols-3 gap-4 m-10",4,"ngIf"],["class","grid grid-cols-1 my-24",4,"ngIf"],[1,"overflow-x-auto","relative","grid","grid-cols-3","gap-4","m-10"],[1,"col-span-3","grid","grid-cols-3","gap-4"],["for","selected_year"],["name","selected_year","id","selected_year",1,"input",3,"ngModel","ngModelOptions","change","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-span-3","grid","grid-cols-3","gap-4",3,"formGroup"],["for","registration_date"],[1,"text-red-500"],["type","date","name","registration_date","id","registration_date","formControlName","registration_date",1,"input"],["for","number_of_families"],["type","number","name","number_of_families","id","number_of_families","formControlName","number_of_families",1,"input"],["for","water_type_code"],["name","water_type_code","id","water_type_code","formControlName","water_type_code",1,"input"],[4,"ngFor","ngForOf"],["for","toilet_facility_code"],["name","toilet_facility_code","id","toilet_facility_code","formControlName","toilet_facility_code",1,"input"],["class","col-span-3 grid grid-cols-3 gap-4 border border-blue-300 p-5 mx-10",4,"ngFor","ngForOf"],["class","select-none col-span-3 grid grid-cols-3 gap-4 border border-blue-300 p-5 mx-10",4,"ngFor","ngForOf"],[1,"col-span-3"],["for","remarks"],["type","text","name","remarks","id","remarks","formControlName","remarks",1,"input"],[1,"col-span-3","flex","justify-center"],["type","submit",1,"btn-save",3,"disabled","click"],[3,"icon","spin"],[3,"value"],[3,"for"],[1,"input",3,"name","id","formControlName"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"col-span-3","grid","grid-cols-3","gap-4","border","border-blue-300","p-5","mx-10"],["type","date",1,"input",3,"name","id","formControlName"],["value","POSITIVE"],["value","NEGATIVE"],[1,"select-none","col-span-3","grid","grid-cols-3","gap-4","border","border-blue-300","p-5","mx-10"],["class","col-span-3",4,"ngIf"],["type","checkbox",1,"input-checkbox",3,"formControlName"],[1,"pl-2"],["for","wm_others_remarks"],["type","text","name","wm_others_remarks","id","wm_others_remarks","formControlName","wm_others_remarks",1,"input"],[1,"grid","grid-cols-1","my-24"],[1,"flex","justify-center","text-blue-500"],["spin","true",3,"icon"],[1,"flex","justify-center"]],template:function(o,l){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e._uU(5," Environmental Health and Sanitation "),e.qZA()(),e.YNc(6,U,47,14,"div",5),e.YNc(7,E,5,1,"div",6),e.qZA()()()),2&o&&(e.xp6(6),e.Q6J("ngIf",l.show_form),e.xp6(1),e.Q6J("ngIf",!l.show_form))},dependencies:[s.sg,s.O5,n._Y,n.YN,n.Kr,n.Fj,n.wV,n.Wl,n.EJ,n.JJ,n.JL,n.On,n.sg,n.u,f.BN]}),a})()}];let J=(()=>{var i;class a{}return(i=a).\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[c.Bz.forChild(F),c.Bz]}),a})(),k=(()=>{var i;class a{}return(i=a).\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[s.ez,J,n.u5,n.UX,f.uH]}),a})()}}]);