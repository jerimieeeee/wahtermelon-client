"use strict";(self.webpackChunkwahtermelon_client=self.webpackChunkwahtermelon_client||[]).push([[967],{5967:(T,g,_)=>{_.r(g),_.d(g,{LabModule:()=>ae});var n=_(6895),u=_(4553),r=_(2687);let m;function b(i,a,t=!1){t&&m?m.unsubscribe():m=i.subscribe(()=>a())}var e=_(1571),y=_(4691),f=_(6198),x=_(6356),c=_(2216),d=_(6491),C=_(7185),p=_(433);function Z(i,a){if(1&i&&(e.TgZ(0,"option",28),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.desc)}}function w(i,a){if(1&i&&(e.TgZ(0,"option",28),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.desc)}}function F(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",19)(1,"label",20),e._uU(2),e.qZA(),e.TgZ(3,"select",22),e.NdJ("ngModelChange",function(l){e.CHM(t);const s=e.oxw(4);return e.KtG(s.lab_form.findings_code=l)}),e.YNc(4,w,2,2,"option",23),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(2),e.AsE("",t.field_desc," ",t.nv_uom?"("+t.nv_uom+")":null,""),e.xp6(1),e.Q6J("ngModel",o.lab_form.findings_code),e.xp6(1),e.Q6J("ngForOf",o.lab_findings)}}function L(i,a){if(1&i&&(e.TgZ(0,"option",28),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.desc)}}function A(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",19)(1,"label",20),e._uU(2),e.qZA(),e.TgZ(3,"select",22),e.NdJ("ngModelChange",function(l){e.CHM(t);const s=e.oxw(4);return e.KtG(s.lab_form.data_collection_code=l)}),e.YNc(4,L,2,2,"option",23),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(2),e.AsE("",t.field_desc," ",t.nv_uom?"("+t.nv_uom+")":null,""),e.xp6(1),e.Q6J("ngModel",o.lab_form.data_collection_code),e.xp6(1),e.Q6J("ngForOf",o.lab_sputum_collection)}}function J(i,a){if(1&i&&(e.TgZ(0,"option",28),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.desc)}}function q(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",19)(1,"label",20),e._uU(2),e.qZA(),e.TgZ(3,"select",22),e.NdJ("ngModelChange",function(l){e.CHM(t);const s=e.oxw(4);return e.KtG(s.lab_form.findings_code=l)}),e.YNc(4,J,2,2,"option",23),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(2),e.AsE("",t.field_desc," ",t.nv_uom?"("+t.nv_uom+")":null,""),e.xp6(1),e.Q6J("ngModel",o.lab_form.findings_code),e.xp6(1),e.Q6J("ngForOf",o.lab_cxray_findings)}}function N(i,a){if(1&i&&(e.TgZ(0,"option",28),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.desc)}}function Q(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",19)(1,"label",20),e._uU(2),e.qZA(),e.TgZ(3,"select",22),e.NdJ("ngModelChange",function(l){e.CHM(t);const s=e.oxw(4);return e.KtG(s.lab_form.observation_code=l)}),e.YNc(4,N,2,2,"option",23),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(2),e.AsE("",t.field_desc," ",t.nv_uom?"("+t.nv_uom+")":null,""),e.xp6(1),e.Q6J("ngModel",o.lab_form.observation_code),e.xp6(1),e.Q6J("ngForOf",o.lab_cxray_observation)}}function O(i,a){if(1&i&&(e.TgZ(0,"option",28),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.desc)}}function E(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",19)(1,"label",20),e._uU(2),e.qZA(),e.TgZ(3,"select",22),e.NdJ("ngModelChange",function(l){e.CHM(t);const s=e.oxw(4);return e.KtG(s.lab_form.findings_code=l)}),e.YNc(4,O,2,2,"option",23),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(2),e.AsE("",t.field_desc," ",t.nv_uom?"("+t.nv_uom+")":null,""),e.xp6(1),e.Q6J("ngModel",o.lab_form.findings_code),e.xp6(1),e.Q6J("ngForOf",o.lab_findings)}}function U(i,a){if(1&i&&(e.TgZ(0,"option",28),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.desc)}}function k(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",19)(1,"label",20),e._uU(2),e.qZA(),e.TgZ(3,"select",22),e.NdJ("ngModelChange",function(l){e.CHM(t);const s=e.oxw(4);return e.KtG(s.lab_form.findings_code=l)}),e.YNc(4,U,2,2,"option",23),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(2),e.AsE("",t.field_desc," ",t.nv_uom?"("+t.nv_uom+")":null,""),e.xp6(1),e.Q6J("ngModel",o.lab_form.findings_code),e.xp6(1),e.Q6J("ngForOf",o.lab_result_pn)}}function I(i,a){if(1&i&&(e.TgZ(0,"option",28),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.desc)}}function D(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",19)(1,"label",20),e._uU(2),e.qZA(),e.TgZ(3,"select",22),e.NdJ("ngModelChange",function(l){e.CHM(t);const s=e.oxw(4);return e.KtG(s.lab_form.blood_code=l)}),e.YNc(4,I,2,2,"option",23),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(2),e.AsE("",t.field_desc," ",t.nv_uom?"("+t.nv_uom+")":null,""),e.xp6(1),e.Q6J("ngModel",o.lab_form.blood_code),e.xp6(1),e.Q6J("ngForOf",o.lab_stool_blood)}}function Y(i,a){if(1&i&&(e.TgZ(0,"option",28),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.desc)}}function R(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",19)(1,"label",20),e._uU(2),e.qZA(),e.TgZ(3,"select",22),e.NdJ("ngModelChange",function(l){e.CHM(t);const s=e.oxw(4);return e.KtG(s.lab_form.color_code=l)}),e.YNc(4,Y,2,2,"option",23),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(2),e.AsE("",t.field_desc," ",t.nv_uom?"("+t.nv_uom+")":null,""),e.xp6(1),e.Q6J("ngModel",o.lab_form.color_code),e.xp6(1),e.Q6J("ngForOf",o.lab_stool_color)}}function S(i,a){if(1&i&&(e.TgZ(0,"option",28),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.desc)}}function P(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",19)(1,"label",20),e._uU(2),e.qZA(),e.TgZ(3,"select",22),e.NdJ("ngModelChange",function(l){e.CHM(t);const s=e.oxw(4);return e.KtG(s.lab_form.consistency_code=l)}),e.YNc(4,S,2,2,"option",23),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(2),e.AsE("",t.field_desc," ",t.nv_uom?"("+t.nv_uom+")":null,""),e.xp6(1),e.Q6J("ngModel",o.lab_form.consistency_code),e.xp6(1),e.Q6J("ngForOf",o.lab_stool_consistency)}}function H(i,a){if(1&i&&(e.TgZ(0,"span",32),e._uU(1),e.qZA()),2&i){const t=e.oxw(2).$implicit;e.xp6(1),e.AsE("Normal values(Min: ",t.nv_min," to Max: ",t.nv_max,")")}}function K(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",19)(1,"label",20),e._uU(2),e.qZA(),e.TgZ(3,"input",30),e.NdJ("ngModelChange",function(l){e.CHM(t);const s=e.oxw().$implicit,v=e.oxw(3);return e.KtG(v.lab_form[s.field_name]=l)}),e.qZA(),e.YNc(4,H,2,2,"span",31),e.qZA()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(2),e.AsE("",t.field_desc," ",t.nv_uom?"("+t.nv_uom+")":null,""),e.xp6(1),e.Q6J("ngModel",o.lab_form[t.field_name])("type",null!==t.nv_min?"number":"text"),e.xp6(1),e.Q6J("ngIf",null!==t.nv_min)}}function G(i,a){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,F,5,4,"div",29),e.YNc(2,A,5,4,"div",29),e.YNc(3,q,5,4,"div",29),e.YNc(4,Q,5,4,"div",29),e.YNc(5,E,5,4,"div",29),e.YNc(6,k,5,4,"div",29),e.YNc(7,D,5,4,"div",29),e.YNc(8,R,5,4,"div",29),e.YNc(9,P,5,4,"div",29),e.YNc(10,K,5,5,"div",29),e.qZA()),2&i){const t=a.$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("ngIf","SPTM"===o.selected_lab.laboratory.code&&"findings_code"===t.field_name),e.xp6(1),e.Q6J("ngIf","SPTM"===o.selected_lab.laboratory.code&&"data_collection_code"===t.field_name),e.xp6(1),e.Q6J("ngIf","CXRAY"===o.selected_lab.laboratory.code&&"findings_code"===t.field_name),e.xp6(1),e.Q6J("ngIf","CXRAY"===o.selected_lab.laboratory.code&&"observation_code"===t.field_name),e.xp6(1),e.Q6J("ngIf","ECG"===o.selected_lab.laboratory.code&&"findings_code"===t.field_name),e.xp6(1),e.Q6J("ngIf",o.form_with_findings_pn.includes(o.selected_lab.laboratory.code)&&"findings_code"===t.field_name),e.xp6(1),e.Q6J("ngIf","FCAL"===o.selected_lab.laboratory.code&&"blood_code"===t.field_name),e.xp6(1),e.Q6J("ngIf","FCAL"===o.selected_lab.laboratory.code&&"color_code"===t.field_name),e.xp6(1),e.Q6J("ngIf","FCAL"===o.selected_lab.laboratory.code&&"consistency_code"===t.field_name),e.xp6(1),e.Q6J("ngIf",o.spl_val.indexOf(t.field_name)<0)}}function $(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",18)(1,"div",19)(2,"label",20),e._uU(3,"Laboratory date"),e.qZA(),e.TgZ(4,"input",21),e.NdJ("ngModelChange",function(l){e.CHM(t);const s=e.oxw(2);return e.KtG(s.lab_form.laboratory_date=l)}),e.qZA()(),e.TgZ(5,"div",19)(6,"label",20),e._uU(7,"Laboratory status"),e.qZA(),e.TgZ(8,"select",22),e.NdJ("ngModelChange",function(l){e.CHM(t);const s=e.oxw(2);return e.KtG(s.lab_form.lab_status_code=l)}),e.YNc(9,Z,2,2,"option",23),e.qZA()(),e.TgZ(10,"div",24)(11,"label",20),e._uU(12,"Referral Facility"),e.qZA(),e.TgZ(13,"input",25),e.NdJ("ngModelChange",function(l){e.CHM(t);const s=e.oxw(2);return e.KtG(s.lab_form.referral_facility=l)}),e.qZA()(),e.YNc(14,G,11,10,"div",26),e.TgZ(15,"div",27)(16,"div",19)(17,"label",20),e._uU(18,"Remarks"),e.qZA(),e.TgZ(19,"input",25),e.NdJ("ngModelChange",function(l){e.CHM(t);const s=e.oxw(2);return e.KtG(s.lab_form.remarks=l)}),e.qZA()()()()}if(2&i){const t=e.oxw(2);e.xp6(4),e.Q6J("ngModel",t.lab_form.laboratory_date)("max",t.max_date),e.xp6(4),e.Q6J("ngModel",t.lab_form.lab_status_code),e.xp6(1),e.Q6J("ngForOf",t.lab_statuses),e.xp6(4),e.Q6J("ngModel",t.lab_form.referral_facility),e.xp6(1),e.Q6J("ngForOf",t.fields),e.xp6(5),e.Q6J("ngModel",t.lab_form.remarks)}}const B=function(){return{standalone:!0}};function j(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",13)(1,"div",14)(2,"input",15),e.NdJ("ngModelChange",function(l){e.CHM(t);const s=e.oxw();return e.KtG(s.request_status_code=l)}),e.qZA(),e.TgZ(3,"label",16),e._uU(4,"Patient has refused lab service"),e.qZA()(),e.YNc(5,$,20,7,"div",17),e.qZA()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngModel",t.request_status_code)("ngModelOptions",e.DdM(3,B)),e.xp6(3),e.Q6J("ngIf",!t.request_status_code)}}let z=(()=>{class i{loadForm(){this.selected_lab&&this.http.get("libraries/laboratories/"+this.selected_lab.laboratory.code).subscribe({next:t=>{this.trimForm(t.data.category)},error:t=>console.log(t)})}trimForm(t){let o=new Date(this.patient_details.birthdate),v=(new Date(this.selected_lab.request_date)-o)/864e5<=28?"NB":this.patient_details.gender,M=[];Object.entries(t).forEach(([re,se],de)=>{let h=se;h.range_cat?v===h.range_cat&&(M.push(h),this.lab_form[h.field_name]=null):(M.push(h),this.lab_form[h.field_name]=null)}),this.fields=M,this.request_status_code="RF"===this.selected_lab.request_status_code,this.selected_lab.lab_result&&this.fillCodes(this.selected_lab),this.show_form=!0}fillCodes(t){switch(this.lab_form=this.selected_lab.lab_result,t.laboratory.code){case"CXRAY":this.lab_form.findings_code=this.lab_form.findings_code,this.lab_form.observation_code=this.lab_form.observation_code;break;case"ECG":case"FOBT":case"PPD":this.lab_form.findings_code=this.lab_form.findings_code;break;case"SPTM":this.lab_form.findings_code=this.lab_form.findings_code,this.lab_form.data_collection_code=this.lab_form.data_collection_code;break;case"FCAL":this.lab_form.blood_code=this.lab_form.blood_code,this.lab_form.color_code=this.lab_form.color_code,this.lab_form.consistency_code=this.lab_form.consistency_code}}onSubmit(){if(this.is_saving=!0,this.request_status_code)this.updateLabReq("RF");else{let t=this.nameHelper.getURL(this.selected_lab.laboratory.code);if(t||null!==t||""!==t){let o;this.lab_form.request_id?o=this.http.update(t+"/",this.lab_form.id,this.lab_form):(this.lab_form.patient_id=this.selected_lab.patient_id,this.lab_form.request_id=this.selected_lab.id,this.selected_lab.consult_id&&(this.lab_form.consult_id=this.selected_lab.consult_id),o=this.http.post(t,this.lab_form)),o.subscribe({next:l=>{console.log(l),"RF"===this.selected_lab.request_status_code?this.updateLabReq("RQ"):(this.toastr.success("Lab result was recorded!","Laboratory Result"),this.closeModal())},error:l=>console.log(l)})}else this.is_saving=!1,this.toastr.error("Laboratory does not exist","Lab form")}}updateLabReq(t){this.http.update("laboratory/consult-laboratories/",this.selected_lab.id,{lab_code:this.selected_lab.laboratory.code,patient_id:this.selected_lab.patient_id,recommendation_code:this.selected_lab.recommendation_code,request_date:this.selected_lab.request_date,request_status_code:t}).subscribe({next:()=>{this.toastr.success("Lab record was updated!","Lab Record"),this.closeModal()},error:l=>console.log(l)})}closeModal(){this.is_saving=!1,this.toggleModal.emit("add")}cancelThisModal(){this.cancelModal.emit("add")}constructor(t,o,l){this.http=t,this.toastr=o,this.nameHelper=l,this.toggleModal=new e.vpe,this.cancelModal=new e.vpe,this.faSave=r.r6l,this.faSpinner=r.LM3,this.is_saving=!1,this.show_form=!1,this.lab_form={},this.max_date=(0,n.p6)(new Date,"yyyy-MM-dd","en"),this.spl_val=["observation_code","findings_code","data_collection_code","blood_code","color_code","consistency_code"],this.form_with_findings_pn=["FOBT","PPD"],this.form_with_finding_code=["ECG"]}ngOnChanges(t){this.loadForm()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(y.O),e.Y36(C._W),e.Y36(x.y))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-lab-form"]],inputs:{selected_lab:"selected_lab",patient_details:"patient_details",lab_statuses:"lab_statuses",lab_cxray_findings:"lab_cxray_findings",lab_cxray_observation:"lab_cxray_observation",lab_findings:"lab_findings",lab_sputum_collection:"lab_sputum_collection",lab_result_pn:"lab_result_pn",lab_stool_blood:"lab_stool_blood",lab_stool_color:"lab_stool_color",lab_stool_consistency:"lab_stool_consistency"},outputs:{toggleModal:"toggleModal",cancelModal:"cancelModal"},features:[e.TTD],decls:16,vars:7,consts:[["id","defaultModal","tabindex","-1","aria-modal","true","role","dialog",1,"overflow-y-auto","overflow-x-hidden","fixed","top-0","right-0","left-0","w-full","md:inset-0","h-modal","md:h-full","justify-center","items-center","flex",2,"z-index","60"],[1,"relative","p-4","w-full","max-w-4xl","h-auto","md:h-auto"],[1,"relative","bg-white","rounded-lg","shadow","dark:bg-gray-700"],[1,"flex","justify-between","items-start","py-3","px-5","rounded-t","border-b","bg-blue-500","dark:border-gray-600"],[1,"mt-2","text-sm","font-bold","text-white","dark:text-white"],[1,"h-96","overflow-y-auto"],[1,"flex","item-start","flex-wrap","pb-5"],["class","grid grid-cols-2 px-3 py-3 w-full mx-5 mt-5 rounded-lg",4,"ngIf"],[1,"flex","justify-end","pb-5","px-5","space-x-4","rounded-b","my-5"],["type","button",1,"btn-save","bg-gray-400","px-10",3,"disabled","click"],["type","button",1,"btn-save","px-10","disabled:bg-gray-300",3,"disabled","click"],[1,"mr-2",3,"icon","spin"],[1,"opacity-50","fixed","inset-0","z-50","bg-black"],[1,"grid","grid-cols-2","px-3","py-3","w-full","mx-5","mt-5","rounded-lg"],[1,"col-span-2","flex","mb-3","justify-center"],["type","checkbox","name","request_status_code",1,"w-6","h-6","input",3,"ngModel","ngModelOptions","ngModelChange"],["for","request_status_code",1,"ml-3","mt-1"],["class","col-span-2 grid grid-cols-2 gap-5",4,"ngIf"],[1,"col-span-2","grid","grid-cols-2","gap-5"],[1,"text-sm","col-span-1"],[1,"font-semibold"],["name","field","type","date","placeholder","mm/dd/yyyy",1,"input",3,"ngModel","max","ngModelChange"],["name","field",1,"input",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"text-sm","col-span-2"],["name","field","type","text",1,"input",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],[1,"col-span-2"],[3,"value"],["class","text-sm col-span-1",4,"ngIf"],["name","field",1,"input",3,"ngModel","type","ngModelChange"],["class","italic text-xs text-gray-500",4,"ngIf"],[1,"italic","text-xs","text-gray-500"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),e._uU(5),e.qZA()(),e.TgZ(6,"div",5)(7,"div",6),e.YNc(8,j,6,4,"div",7),e.qZA()(),e.TgZ(9,"div",8)(10,"button",9),e.NdJ("click",function(){return o.cancelThisModal()}),e._uU(11,"Cancel"),e.qZA(),e.TgZ(12,"button",10),e.NdJ("click",function(){return o.onSubmit()}),e._UZ(13,"fa-icon",11),e._uU(14),e.qZA()()()()(),e._UZ(15,"div",12)),2&t&&(e.xp6(5),e.hij(" ",o.selected_lab.laboratory.desc," "),e.xp6(3),e.Q6J("ngIf",o.show_form),e.xp6(2),e.Q6J("disabled",o.is_saving),e.xp6(2),e.Q6J("disabled",o.is_saving||!o.request_status_code&&(!o.lab_form.laboratory_date||!o.lab_form.lab_status_code)),e.xp6(1),e.Q6J("icon",o.is_saving?o.faSpinner:o.faSave)("spin",o.is_saving),e.xp6(1),e.hij(" ",o.is_saving?"Saving":"Save"," "))},dependencies:[n.sg,n.O5,c.BN,p.YN,p.Kr,p.Fj,p.Wl,p.EJ,p.JJ,p.On]}),i})();function W(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"fa-icon",20),e.NdJ("click",function(){e.CHM(t);const l=e.oxw().$implicit,s=e.oxw(2);return e.KtG(s.toggleModal("add",l))}),e.qZA()}if(2&i){const t=e.oxw(3);e.Q6J("icon",t.faFlask)}}function X(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"fa-icon",21),e.NdJ("click",function(){e.CHM(t);const l=e.oxw().$implicit,s=e.oxw(2);return e.KtG(s.toggleModal("add",l))}),e.qZA()}if(2&i){const t=e.oxw(3);e.Q6J("icon",t.faFlask)}}function V(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"fa-icon",22),e.NdJ("click",function(){e.CHM(t);const l=e.oxw().$implicit,s=e.oxw(2);return e.KtG(s.toggleModal("add",l))}),e.qZA()}if(2&i){const t=e.oxw(3);e.Q6J("icon",t.faFlask)}}function ee(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"tr",12)(1,"td",13),e._uU(2),e.qZA(),e.TgZ(3,"th",14),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td",15),e.YNc(7,W,1,1,"fa-icon",16),e.YNc(8,X,1,1,"fa-icon",17),e.YNc(9,V,1,1,"fa-icon",18),e.TgZ(10,"fa-icon",19),e.NdJ("click",function(){const s=e.CHM(t).$implicit,v=e.oxw(2);return e.KtG(v.toggleModal("delete-item",s))}),e.qZA()()()}if(2&i){const t=a.$implicit,o=e.oxw(2);e.xp6(2),e.hij(" ",t.laboratory.desc," "),e.xp6(2),e.hij(" ",e.xi3(5,6,t.request_date,"MM/dd/yyyy")," "),e.xp6(3),e.Q6J("ngIf",t.lab_result&&"RF"!==t.request_status_code),e.xp6(1),e.Q6J("ngIf",!t.lab_result&&"RF"!==t.request_status_code),e.xp6(1),e.Q6J("ngIf","RF"===t.request_status_code),e.xp6(1),e.Q6J("icon",o.faTrashCan)}}function te(i,a){if(1&i&&(e.TgZ(0,"div",4)(1,"div",5),e._uU(2," Laboratories "),e.qZA(),e.TgZ(3,"div",6)(4,"table",7)(5,"thead",8)(6,"tr")(7,"th",9),e._uU(8,"Lab type"),e.qZA(),e.TgZ(9,"th",9),e._uU(10,"Date requested"),e.qZA(),e.TgZ(11,"th",10),e._uU(12,"Action"),e.qZA()()(),e.TgZ(13,"tbody"),e.YNc(14,ee,11,9,"tr",11),e.qZA()()()()),2&i){const t=e.oxw();e.xp6(14),e.Q6J("ngForOf",t.pending_list)}}function oe(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"app-lab-form",23),e.NdJ("toggleModal",function(l){e.CHM(t);const s=e.oxw();return e.KtG(s.toggleModal(l))})("cancelModal",function(l){e.CHM(t);const s=e.oxw();return e.KtG(s.cancelModal(l))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("selected_lab",t.selected_lab)("patient_details",t.patient_details)("lab_statuses",t.lab_statuses)("lab_cxray_observation",t.lab_cxray_observation)("lab_cxray_findings",t.lab_cxray_findings)("lab_findings",t.lab_findings)("lab_result_pn",t.lab_result_pn)("lab_sputum_collection",t.lab_sputum_collection)("lab_stool_blood",t.lab_stool_blood)("lab_stool_color",t.lab_stool_color)("lab_stool_consistency",t.lab_stool_consistency)}}function ie(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"app-delete-item",24),e.NdJ("toggleModal",function(l){e.CHM(t);const s=e.oxw();return e.KtG(s.toggleModal(l))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("delete_id",t.delete_id)("delete_desc",t.delete_desc)("url",t.url)}}const le=[{path:"",component:(()=>{class i{loadData(){this.http.get("laboratory/consult-laboratories",{params:{patient_id:this.patient_details.id,sort:"-request_date",include:"laboratory"}}).subscribe({next:o=>{this.pending_list=o.data,this.show_form=!0},error:o=>console.log(o)})}reloadLabs(t){this.show_form=!1,this.pending_list=t,this.loadData()}cancelModal(t){this.modal[t]=!this.modal[t]}toggleModal(t,o){this.selected_lab=o,this.selected_lab?("add"===t?o&&"CXRAY"===o.laboratory.code?this.lab_cxray_findings&&this.lab_cxray_observation?this.modal[t]=!this.modal[t]:this.loadCxrayLib(t):o&&"ECG"===o.laboratory.code?this.lab_findings?this.modal[t]=!this.modal[t]:this.loadLibraries("libraries/laboratory-findings","lab_findings",t):o&&"SPTM"===o.laboratory.code?this.lab_sputum_collection||this.lab_result_pn?this.modal[t]=!this.modal[t]:this.loadSputumCollection(t):o&&"FCAL"===o.laboratory.code?this.lab_stool_blood||this.lab_stool_color||this.lab_stool_consistency?this.modal[t]=!this.modal[t]:this.loadStoolBlood(t):o&&this.forms_with_finding_pn.includes(o.laboratory.code)?this.lab_result_pn?this.modal[t]=!this.modal[t]:this.loadLibraries("libraries/laboratory-results","lab_result_pn",t):this.modal[t]=!this.modal[t]:(this.delete_id=o.id,this.modal[t]=!this.modal[t]),!1===this.modal[t]&&this.loadData()):(this.modal[t]=!1,this.loadData())}loadSputumCollection(t){this.http.get("libraries/laboratory-sputum-collection").subscribe({next:o=>{this.lab_sputum_collection=o.data,this.loadLibraries("libraries/laboratory-findings","lab_findings",t)},error:o=>console.log(o)})}loadStoolBlood(t){this.http.get("libraries/laboratory-blood-stool").subscribe({next:o=>{console.log(o),this.lab_stool_blood=o.data,this.loadStoolColor(t)}})}loadStoolColor(t){this.http.get("libraries/laboratory-stool-color").subscribe({next:o=>{this.lab_stool_color=o.data,this.loadStoolConsistency(t)}})}loadStoolConsistency(t){this.http.get("libraries/laboratory-stool-consistency").subscribe({next:o=>{this.lab_stool_consistency=o.data,this.modal[t]=!this.modal[t]}})}loadLabStatusLib(){this.http.get("libraries/laboratory-statuses").subscribe({next:t=>this.lab_statuses=t.data,error:t=>console.log(t)})}loadCxrayLib(t){this.http.get("libraries/laboratory-chestxray-findings").subscribe({next:o=>{this.lab_cxray_findings=o.data,this.loadCxrayObs(t)},error:o=>console.log(o)})}loadCxrayObs(t){this.http.get("libraries/laboratory-chestxray-observations").subscribe({next:o=>{this.lab_cxray_observation=o.data,this.modal[t]=!this.modal[t]},error:o=>console.log(o)})}loadLibraries(t,o,l){this.http.get(t).subscribe({next:s=>{this[o]=s.data,this.modal[l]=!this.modal[l]},error:s=>console.log(s)})}constructor(t,o,l){this.http=t,this.patientInfo=o,this.nameHelper=l,this.faFlaskVial=r.YKN,this.faTrashCan=r.Vui,this.faEdit=r.Xcf,this.faXmark=r.g82,this.faFlask=r.jZZ,this.show_form=!1,this.modal=[],this.forms_with_finding_pn=["FOBT","PPD"],this.delete_desc="Laboratory",this.url="laboratory/consult-laboratories/",this.loadData=this.loadData.bind(this),b(o.reloadLabs,this.loadData)}ngOnInit(){this.loadLabStatusLib(),this.patient_details=this.http.getPatientInfo(),this.loadData()}ngOnDestroy(){b(this.patientInfo.reloadNCDVitals,this.loadData,!0)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(y.O),e.Y36(f.M),e.Y36(x.y))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-lab"]],decls:4,vars:3,consts:[[1,"block","shadow","p-4","mt-4","rounded-xl","text-gray-600","border","border-slate-100"],["class","border border-slate-200 shadow-md rounded-xl",4,"ngIf"],[3,"selected_lab","patient_details","lab_statuses","lab_cxray_observation","lab_cxray_findings","lab_findings","lab_result_pn","lab_sputum_collection","lab_stool_blood","lab_stool_color","lab_stool_consistency","toggleModal","cancelModal",4,"ngIf"],[3,"delete_id","delete_desc","url","toggleModal",4,"ngIf"],[1,"border","border-slate-200","shadow-md","rounded-xl"],[1,"w-full","bg-blue-500","text-white","rounded-t-xl","p-3","font-semibold"],[1,"w-full","p-5"],[1,"w-full","text-sm","text-left","text-gray-500","dark:text-gray-400"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","dark:bg-gray-700","dark:text-gray-400"],["scope","col",1,"py-3","px-6"],["scope","col",1,"py-3","px-6","text-center"],["class","bg-white border-b last:border-0",4,"ngFor","ngForOf"],[1,"bg-white","border-b","last:border-0"],[1,"w-1/3","py-4","px-6"],["scope","row",1,"w-1/3","py-4","px-6","font-medium","text-gray-900","whitespace-nowrap"],[1,"w-1/3","py-4","px-6","text-center"],["size","lg","class","mx-0 my-0 text-green-500 hover:cursor-pointer flex-none mr-2",3,"icon","click",4,"ngIf"],["size","lg","class","mx-0 my-0 text-orange-500 hover:cursor-pointer flex-none mr-2",3,"icon","click",4,"ngIf"],["size","lg","class","mx-0 my-0 text-red-700 hover:cursor-pointer flex-none mr-2",3,"icon","click",4,"ngIf"],["size","lg",1,"mx-0","my-0","text-red-500","hover:cursor-pointer","flex-none","mr-2",3,"icon","click"],["size","lg",1,"mx-0","my-0","text-green-500","hover:cursor-pointer","flex-none","mr-2",3,"icon","click"],["size","lg",1,"mx-0","my-0","text-orange-500","hover:cursor-pointer","flex-none","mr-2",3,"icon","click"],["size","lg",1,"mx-0","my-0","text-red-700","hover:cursor-pointer","flex-none","mr-2",3,"icon","click"],[3,"selected_lab","patient_details","lab_statuses","lab_cxray_observation","lab_cxray_findings","lab_findings","lab_result_pn","lab_sputum_collection","lab_stool_blood","lab_stool_color","lab_stool_consistency","toggleModal","cancelModal"],[3,"delete_id","delete_desc","url","toggleModal"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.YNc(1,te,15,1,"div",1),e.qZA(),e.YNc(2,oe,1,11,"app-lab-form",2),e.YNc(3,ie,1,3,"app-delete-item",3)),2&t&&(e.xp6(1),e.Q6J("ngIf",o.show_form),e.xp6(1),e.Q6J("ngIf",o.modal.add),e.xp6(1),e.Q6J("ngIf",o.modal["delete-item"]))},dependencies:[n.sg,n.O5,c.BN,d.N,z,n.uU]}),i})()}];let ne=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[u.Bz.forChild(le),u.Bz]}),i})(),ae=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[n.ez,ne,c.uH,p.u5,d.N]}),i})()},6356:(T,g,_)=>{_.d(g,{y:()=>u});var n=_(1571);let u=(()=>{class r{getVisitType(b){switch(b){case"cn":return"Consultation";case"cc":return"Child Care";case"mc":return"Maternal Care";case"dn":return"Dental";case"ncd":return"Non Communicable Disease"}}getURL(b){switch(b){case"CBC":return"laboratory/consult-laboratory-cbc";case"CRTN":return"laboratory/consult-laboratory-creatinine";case"CXRAY":return"laboratory/consult-laboratory-chestxray";case"ECG":return"laboratory/consult-laboratory-ecg";case"FBS":return"laboratory/consult-laboratory-fbs";case"RBS":return"laboratory/consult-laboratory-rbs";case"HBA":return"laboratory/consult-laboratory-hba1c";case"PSMR":return"laboratory/consult-laboratory-papsmear";case"PPD":return"laboratory/consult-laboratory-ppd";case"SPTM":return"laboratory/consult-laboratory-sputum";case"FCAL":return"laboratory/consult-laboratory-fecalysis";case"LPFL":return"laboratory/consult-laboratory-lipid-profile";case"URN":return"laboratory/consult-laboratory-urinalysis";case"OGTT":return"laboratory/consult-laboratory-oral-glucose";case"FOBT":return"laboratory/consult-laboratory-fecal-occult";case"GRMS":return"laboratory/consult-laboratory-gram-stain";case"MCRP":return"laboratory/consult-laboratory-microscopy";default:return""}}constructor(){}}return r.\u0275fac=function(b){return new(b||r)},r.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},6491:(T,g,_)=>{_.d(g,{N:()=>y});var n=_(1571),u=_(433),r=_(2216),m=_(2687),b=_(4691),e=_(7185);let y=(()=>{class f{generateCode(){this.confirm_code=Math.floor(1e3*Math.random()).toString().padStart(4,"0")}onSubmit(){this.confirm_code===this.confirmation_code?this.http.delete(this.url,this.delete_id).subscribe({next:()=>{this.is_loading=!0,this.toastr.error("Record was deleted!","Vaccine record"),this.closeModal()},error:c=>console.log(c)}):(this.generateCode(),this.toastr.info("Code mismatch, please try again","Incorrect Code"),console.log("error"))}closeModal(){this.toggleModal.emit("delete-item")}constructor(c,d){this.http=c,this.toastr=d,this.toggleModal=new n.vpe,this.faTrash=m.$aW,this.confirm_code="0000",this.is_loading=!1}ngOnInit(){console.log(this.delete_id),console.log(this.delete_desc),console.log(this.url),this.generateCode()}}return f.\u0275fac=function(c){return new(c||f)(n.Y36(b.O),n.Y36(e._W))},f.\u0275cmp=n.Xpm({type:f,selectors:[["app-delete-item"]],inputs:{url:"url",delete_id:"delete_id",delete_desc:"delete_desc"},outputs:{toggleModal:"toggleModal"},standalone:!0,features:[n.jDz],decls:28,vars:8,consts:[["id","defaultModal","tabindex","-1","aria-modal","true","role","dialog",1,"overflow-y-auto","overflow-x-hidden","fixed","top-0","right-0","left-0","w-full","md:inset-0","h-modal","md:h-full","justify-center","items-center","flex",2,"z-index","60"],[1,"relative","p-4","w-full","max-w-3xl","h-auto","md:h-auto"],[1,"relative","bg-white","rounded-lg","shadow","dark:bg-gray-700"],[1,"flex","justify-between","items-start","py-3","px-5","rounded-t","border-b","bg-red-500","dark:border-gray-600"],[1,"mt-2","text-sm","font-bold","text-white","dark:text-white"],[1,"overflow-y-auto","h-96","scrollbar-thin","scrollbar-thumb-gray-400","scrollbar-track-gray-100"],[1,"flex","item-start","flex-wrap","pb-5"],[1,"grid","grid-cols-3","px-5","py-5","mt-10","mx-10","w-full","bg-red-50","rounded-lg","text-center"],[1,"col-span-3","text-left","mb-2","pb-2","border-b","border-slate-200"],[1,"col-span-1","text-sm","px-5","py-2","mt-2"],[1,"block","mb-3"],[1,"font-bold","text-2xl","select-none"],["for","confirmation_code"],["name","confirmation_code","id","confirmation_code","type","text",1,"mt-2","border","border-gray-300","text-gray-900","sm:text-sm","rounded-lg","focus:ring-blue-500","focus:border-blue-500","block","w-full","pl-3","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-blue-500","dark:focus:border-blue-500",3,"ngModel","ngModelChange"],[1,"col-span-1","mt-11"],["type","button",1,"my-auto","text-white","bg-red-500","enabled:hover:ring-2","enabled:focus:outline-none","enabled:hover:ring-red-300","disabled:bg-gray-300","font-medium","rounded","text-sm","px-6","py-2.5","text-center","transition","duration-150","ease-in-out",3,"disabled","click"],[1,"mx-0","my-0","text-white",3,"icon"],[1,"flex","justify-end","py-4","px-5","space-x-4","rounded-b","border-t","border-gray-200"],["type","button",1,"text-white","bg-gray-400","hover:ring-2","focus:outline-none","hover:ring-gray-200","rounded","text-sm","font-medium","my-2","px-6","py-2.5","transition","duration-150","ease-in-out",3,"disabled","click"],[1,"opacity-50","fixed","inset-0","z-50","bg-black"]],template:function(c,d){1&c&&(n.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),n._uU(5),n.qZA()(),n.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8),n._uU(10),n.qZA(),n.TgZ(11,"div",9)(12,"span",10),n._uU(13,"Delete Code"),n.qZA(),n.TgZ(14,"span",11),n._uU(15),n.qZA()(),n.TgZ(16,"div",9)(17,"label",12),n._uU(18,"Enter Code"),n.qZA(),n.TgZ(19,"input",13),n.NdJ("ngModelChange",function(p){return d.confirmation_code=p}),n.qZA()(),n.TgZ(20,"div",14)(21,"button",15),n.NdJ("click",function(){return d.onSubmit()}),n._UZ(22,"fa-icon",16),n._uU(23," Delete "),n.qZA()()()()(),n.TgZ(24,"div",17)(25,"button",18),n.NdJ("click",function(){return d.closeModal()}),n._uU(26,"Cancel"),n.qZA()()()()(),n._UZ(27,"div",19)),2&c&&(n.xp6(5),n.AsE(" Delete ",d.delete_desc,": ",d.delete_id," "),n.xp6(5),n.hij(" Your are about to delete a ",d.delete_desc," record for this patient. Please enter the generated delete code in order to proceed. "),n.xp6(5),n.Oqu(d.confirm_code),n.xp6(4),n.Q6J("ngModel",d.confirmation_code),n.xp6(2),n.Q6J("disabled",!d.confirmation_code||d.is_loading),n.xp6(1),n.Q6J("icon",d.faTrash),n.xp6(3),n.Q6J("disabled",d.is_loading))},dependencies:[r.uH,r.BN,u.u5,u.Fj,u.JJ,u.On]}),f})()}}]);