(self.webpackChunkwahtermelon_client=self.webpackChunkwahtermelon_client||[]).push([[9006],{9006:(Ge,V,b)=>{"use strict";b.r(V),b.d(V,{DashboardModule:()=>un});var x=b(177),w=b(60),_=b(3895),e=b(4438),C=b(3318),k=b(5383),A=b(1413),O=b(980),R=b(1196),j=b(41);function E(a){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(u){return typeof u}:function(u){return u&&"function"==typeof Symbol&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(a)}function v(a,u){if(!(a instanceof u))throw new TypeError("Cannot call a class as a function")}function g(a,u){for(var n=0;n<u.length;n++){var o=u[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(a,o.key,o)}}function m(a,u,n){return u&&g(a.prototype,u),n&&g(a,n),Object.defineProperty(a,"prototype",{writable:!1}),a}function F(){return F=Object.assign||function(a){for(var u=1;u<arguments.length;u++){var n=arguments[u];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(a[o]=n[o])}return a},F.apply(this,arguments)}function I(a,u){if("function"!=typeof u&&null!==u)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(u&&u.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),u&&U(a,u)}function M(a){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(a)}function U(a,u){return(U=Object.setPrototypeOf||function(o,s){return o.__proto__=s,o})(a,u)}function G(a){var u=function J(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var s,o=M(a);if(u){var d=M(this).constructor;s=Reflect.construct(o,arguments,d)}else s=o.apply(this,arguments);return function q(a,u){if(u&&("object"==typeof u||"function"==typeof u))return u;if(void 0!==u)throw new TypeError("Derived constructors may only return object or undefined");return function K(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(a)}(this,s)}}var W=function(){function a(){v(this,a)}return m(a,[{key:"listenForWhisper",value:function(n,o){return this.listen(".client-"+n,o)}},{key:"notification",value:function(n){return this.listen(".Illuminate\\Notifications\\Events\\BroadcastNotificationCreated",n)}},{key:"stopListeningForWhisper",value:function(n,o){return this.stopListening(".client-"+n,o)}}]),a}(),Me=function(){function a(u){v(this,a),this.namespace=u}return m(a,[{key:"format",value:function(n){return[".","\\"].includes(n.charAt(0))?n.substring(1):(this.namespace&&(n=this.namespace+"."+n),n.replace(/\./g,"\\"))}},{key:"setNamespace",value:function(n){this.namespace=n}}]),a}(),ne=function(a){I(n,a);var u=G(n);function n(o,s,d){var h;return v(this,n),(h=u.call(this)).name=s,h.pusher=o,h.options=d,h.eventFormatter=new Me(h.options.namespace),h.subscribe(),h}return m(n,[{key:"subscribe",value:function(){this.subscription=this.pusher.subscribe(this.name)}},{key:"unsubscribe",value:function(){this.pusher.unsubscribe(this.name)}},{key:"listen",value:function(s,d){return this.on(this.eventFormatter.format(s),d),this}},{key:"listenToAll",value:function(s){var d=this;return this.subscription.bind_global(function(h,D){if(!h.startsWith("pusher:")){var B=d.options.namespace.replace(/\./g,"\\"),te=h.startsWith(B)?h.substring(B.length+1):"."+h;s(te,D)}}),this}},{key:"stopListening",value:function(s,d){return d?this.subscription.unbind(this.eventFormatter.format(s),d):this.subscription.unbind(this.eventFormatter.format(s)),this}},{key:"stopListeningToAll",value:function(s){return s?this.subscription.unbind_global(s):this.subscription.unbind_global(),this}},{key:"subscribed",value:function(s){return this.on("pusher:subscription_succeeded",function(){s()}),this}},{key:"error",value:function(s){return this.on("pusher:subscription_error",function(d){s(d)}),this}},{key:"on",value:function(s,d){return this.subscription.bind(s,d),this}}]),n}(W),Ue=function(a){I(n,a);var u=G(n);function n(){return v(this,n),u.apply(this,arguments)}return m(n,[{key:"whisper",value:function(s,d){return this.pusher.channels.channels[this.name].trigger("client-".concat(s),d),this}}]),n}(ne),fe=function(a){I(n,a);var u=G(n);function n(){return v(this,n),u.apply(this,arguments)}return m(n,[{key:"whisper",value:function(s,d){return this.pusher.channels.channels[this.name].trigger("client-".concat(s),d),this}}]),n}(ne),dt=function(a){I(n,a);var u=G(n);function n(){return v(this,n),u.apply(this,arguments)}return m(n,[{key:"here",value:function(s){return this.on("pusher:subscription_succeeded",function(d){s(Object.keys(d.members).map(function(h){return d.members[h]}))}),this}},{key:"joining",value:function(s){return this.on("pusher:member_added",function(d){s(d.info)}),this}},{key:"whisper",value:function(s,d){return this.pusher.channels.channels[this.name].trigger("client-".concat(s),d),this}},{key:"leaving",value:function(s){return this.on("pusher:member_removed",function(d){s(d.info)}),this}}]),n}(Ue),Xe=function(a){I(n,a);var u=G(n);function n(o,s,d){var h;return v(this,n),(h=u.call(this)).events={},h.listeners={},h.name=s,h.socket=o,h.options=d,h.eventFormatter=new Me(h.options.namespace),h.subscribe(),h}return m(n,[{key:"subscribe",value:function(){this.socket.emit("subscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"unsubscribe",value:function(){this.unbind(),this.socket.emit("unsubscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"listen",value:function(s,d){return this.on(this.eventFormatter.format(s),d),this}},{key:"stopListening",value:function(s,d){return this.unbindEvent(this.eventFormatter.format(s),d),this}},{key:"subscribed",value:function(s){return this.on("connect",function(d){s(d)}),this}},{key:"error",value:function(s){return this}},{key:"on",value:function(s,d){var h=this;return this.listeners[s]=this.listeners[s]||[],this.events[s]||(this.events[s]=function(D,B){h.name===D&&h.listeners[s]&&h.listeners[s].forEach(function(te){return te(B)})},this.socket.on(s,this.events[s])),this.listeners[s].push(d),this}},{key:"unbind",value:function(){var s=this;Object.keys(this.events).forEach(function(d){s.unbindEvent(d)})}},{key:"unbindEvent",value:function(s,d){this.listeners[s]=this.listeners[s]||[],d&&(this.listeners[s]=this.listeners[s].filter(function(h){return h!==d})),(!d||0===this.listeners[s].length)&&(this.events[s]&&(this.socket.removeListener(s,this.events[s]),delete this.events[s]),delete this.listeners[s])}}]),n}(W),Ye=function(a){I(n,a);var u=G(n);function n(){return v(this,n),u.apply(this,arguments)}return m(n,[{key:"whisper",value:function(s,d){return this.socket.emit("client event",{channel:this.name,event:"client-".concat(s),data:d}),this}}]),n}(Xe),ht=function(a){I(n,a);var u=G(n);function n(){return v(this,n),u.apply(this,arguments)}return m(n,[{key:"here",value:function(s){return this.on("presence:subscribed",function(d){s(d.map(function(h){return h.user_info}))}),this}},{key:"joining",value:function(s){return this.on("presence:joining",function(d){return s(d.user_info)}),this}},{key:"whisper",value:function(s,d){return this.socket.emit("client event",{channel:this.name,event:"client-".concat(s),data:d}),this}},{key:"leaving",value:function(s){return this.on("presence:leaving",function(d){return s(d.user_info)}),this}}]),n}(Ye),me=function(a){I(n,a);var u=G(n);function n(){return v(this,n),u.apply(this,arguments)}return m(n,[{key:"subscribe",value:function(){}},{key:"unsubscribe",value:function(){}},{key:"listen",value:function(s,d){return this}},{key:"listenToAll",value:function(s){return this}},{key:"stopListening",value:function(s,d){return this}},{key:"subscribed",value:function(s){return this}},{key:"error",value:function(s){return this}},{key:"on",value:function(s,d){return this}}]),n}(W),Be=function(a){I(n,a);var u=G(n);function n(){return v(this,n),u.apply(this,arguments)}return m(n,[{key:"whisper",value:function(s,d){return this}}]),n}(me),He=function(a){I(n,a);var u=G(n);function n(){return v(this,n),u.apply(this,arguments)}return m(n,[{key:"whisper",value:function(s,d){return this}}]),n}(me),pt=function(a){I(n,a);var u=G(n);function n(){return v(this,n),u.apply(this,arguments)}return m(n,[{key:"here",value:function(s){return this}},{key:"joining",value:function(s){return this}},{key:"whisper",value:function(s,d){return this}},{key:"leaving",value:function(s){return this}}]),n}(Be),ke=function(){function a(u){v(this,a),this._defaultOptions={auth:{headers:{}},authEndpoint:"/broadcasting/auth",userAuthentication:{endpoint:"/broadcasting/user-auth",headers:{}},broadcaster:"pusher",csrfToken:null,bearerToken:null,host:null,key:null,namespace:"App.Events"},this.setOptions(u),this.connect()}return m(a,[{key:"setOptions",value:function(n){this.options=F(this._defaultOptions,n);var o=this.csrfToken();return o&&(this.options.auth.headers["X-CSRF-TOKEN"]=o,this.options.userAuthentication.headers["X-CSRF-TOKEN"]=o),(o=this.options.bearerToken)&&(this.options.auth.headers.Authorization="Bearer "+o,this.options.userAuthentication.headers.Authorization="Bearer "+o),n}},{key:"csrfToken",value:function(){var n;return typeof window<"u"&&window.Laravel&&window.Laravel.csrfToken?window.Laravel.csrfToken:this.options.csrfToken?this.options.csrfToken:typeof document<"u"&&"function"==typeof document.querySelector&&(n=document.querySelector('meta[name="csrf-token"]'))?n.getAttribute("content"):null}}]),a}(),ie=function(a){I(n,a);var u=G(n);function n(){var o;return v(this,n),(o=u.apply(this,arguments)).channels={},o}return m(n,[{key:"connect",value:function(){this.pusher=typeof this.options.client<"u"?this.options.client:this.options.Pusher?new this.options.Pusher(this.options.key,this.options):new Pusher(this.options.key,this.options)}},{key:"signin",value:function(){this.pusher.signin()}},{key:"listen",value:function(s,d,h){return this.channel(s).listen(d,h)}},{key:"channel",value:function(s){return this.channels[s]||(this.channels[s]=new ne(this.pusher,s,this.options)),this.channels[s]}},{key:"privateChannel",value:function(s){return this.channels["private-"+s]||(this.channels["private-"+s]=new Ue(this.pusher,"private-"+s,this.options)),this.channels["private-"+s]}},{key:"encryptedPrivateChannel",value:function(s){return this.channels["private-encrypted-"+s]||(this.channels["private-encrypted-"+s]=new fe(this.pusher,"private-encrypted-"+s,this.options)),this.channels["private-encrypted-"+s]}},{key:"presenceChannel",value:function(s){return this.channels["presence-"+s]||(this.channels["presence-"+s]=new dt(this.pusher,"presence-"+s,this.options)),this.channels["presence-"+s]}},{key:"leave",value:function(s){var d=this;[s,"private-"+s,"private-encrypted-"+s,"presence-"+s].forEach(function(D,B){d.leaveChannel(D)})}},{key:"leaveChannel",value:function(s){this.channels[s]&&(this.channels[s].unsubscribe(),delete this.channels[s])}},{key:"socketId",value:function(){return this.pusher.connection.socket_id}},{key:"disconnect",value:function(){this.pusher.disconnect()}}]),n}(ke),ze=function(a){I(n,a);var u=G(n);function n(){var o;return v(this,n),(o=u.apply(this,arguments)).channels={},o}return m(n,[{key:"connect",value:function(){var s=this,d=this.getSocketIO();return this.socket=d(this.options.host,this.options),this.socket.on("reconnect",function(){Object.values(s.channels).forEach(function(h){h.subscribe()})}),this.socket}},{key:"getSocketIO",value:function(){if(typeof this.options.client<"u")return this.options.client;if(typeof io<"u")return io;throw new Error("Socket.io client not found. Should be globally available or passed via options.client")}},{key:"listen",value:function(s,d,h){return this.channel(s).listen(d,h)}},{key:"channel",value:function(s){return this.channels[s]||(this.channels[s]=new Xe(this.socket,s,this.options)),this.channels[s]}},{key:"privateChannel",value:function(s){return this.channels["private-"+s]||(this.channels["private-"+s]=new Ye(this.socket,"private-"+s,this.options)),this.channels["private-"+s]}},{key:"presenceChannel",value:function(s){return this.channels["presence-"+s]||(this.channels["presence-"+s]=new ht(this.socket,"presence-"+s,this.options)),this.channels["presence-"+s]}},{key:"leave",value:function(s){var d=this;[s,"private-"+s,"presence-"+s].forEach(function(D){d.leaveChannel(D)})}},{key:"leaveChannel",value:function(s){this.channels[s]&&(this.channels[s].unsubscribe(),delete this.channels[s])}},{key:"socketId",value:function(){return this.socket.id}},{key:"disconnect",value:function(){this.socket.disconnect()}}]),n}(ke),ft=function(a){I(n,a);var u=G(n);function n(){var o;return v(this,n),(o=u.apply(this,arguments)).channels={},o}return m(n,[{key:"connect",value:function(){}},{key:"listen",value:function(s,d,h){return new me}},{key:"channel",value:function(s){return new me}},{key:"privateChannel",value:function(s){return new Be}},{key:"encryptedPrivateChannel",value:function(s){return new He}},{key:"presenceChannel",value:function(s){return new pt}},{key:"leave",value:function(s){}},{key:"leaveChannel",value:function(s){}},{key:"socketId",value:function(){return"fake-socket-id"}},{key:"disconnect",value:function(){}}]),n}(ke),Y=function(){function a(u){v(this,a),this.options=u,this.connect(),this.options.withoutInterceptors||this.registerInterceptors()}return m(a,[{key:"channel",value:function(n){return this.connector.channel(n)}},{key:"connect",value:function(){if("reverb"==this.options.broadcaster)this.connector=new ie(F(F({},this.options),{cluster:""}));else if("pusher"==this.options.broadcaster)this.connector=new ie(this.options);else if("socket.io"==this.options.broadcaster)this.connector=new ze(this.options);else if("null"==this.options.broadcaster)this.connector=new ft(this.options);else{if("function"!=typeof this.options.broadcaster||!function le(a){try{new a}catch(u){if(u.message.includes("is not a constructor"))return!1}return!0}(this.options.broadcaster))throw new Error("Broadcaster ".concat(E(this.options.broadcaster)," ").concat(this.options.broadcaster," is not supported."));this.connector=new this.options.broadcaster(this.options)}}},{key:"disconnect",value:function(){this.connector.disconnect()}},{key:"join",value:function(n){return this.connector.presenceChannel(n)}},{key:"leave",value:function(n){this.connector.leave(n)}},{key:"leaveChannel",value:function(n){this.connector.leaveChannel(n)}},{key:"leaveAllChannels",value:function(){for(var n in this.connector.channels)this.leaveChannel(n)}},{key:"listen",value:function(n,o,s){return this.connector.listen(n,o,s)}},{key:"private",value:function(n){return this.connector.privateChannel(n)}},{key:"encryptedPrivate",value:function(n){if(this.connector instanceof ze)throw new Error("Broadcaster ".concat(E(this.options.broadcaster)," ").concat(this.options.broadcaster," does not support encrypted private channels."));return this.connector.encryptedPrivateChannel(n)}},{key:"socketId",value:function(){return this.connector.socketId()}},{key:"registerInterceptors",value:function(){"function"==typeof Vue&&Vue.http&&this.registerVueRequestInterceptor(),"function"==typeof axios&&this.registerAxiosRequestInterceptor(),"function"==typeof jQuery&&this.registerjQueryAjaxSetup(),"object"===(typeof Turbo>"u"?"undefined":E(Turbo))&&this.registerTurboRequestInterceptor()}},{key:"registerVueRequestInterceptor",value:function(){var n=this;Vue.http.interceptors.push(function(o,s){n.socketId()&&o.headers.set("X-Socket-ID",n.socketId()),s()})}},{key:"registerAxiosRequestInterceptor",value:function(){var n=this;axios.interceptors.request.use(function(o){return n.socketId()&&(o.headers["X-Socket-Id"]=n.socketId()),o})}},{key:"registerjQueryAjaxSetup",value:function(){var n=this;typeof jQuery.ajax<"u"&&jQuery.ajaxPrefilter(function(o,s,d){n.socketId()&&d.setRequestHeader("X-Socket-Id",n.socketId())})}},{key:"registerTurboRequestInterceptor",value:function(){var n=this;document.addEventListener("turbo:before-fetch-request",function(o){o.detail.fetchOptions.headers["X-Socket-Id"]=n.socketId()})}}]),a}(),z=b(8916),mt=b.n(z),Ve=b(2490);let Q=(()=>{class a{constructor(n){this.cookieService=n,this.cookie_value=this.cookieService.get("access_token"),this.pusher=mt(),this.echo=new Y({broadcaster:"pusher",key:"app-key",cluster:"mt1",wsHost:"sockets.wah.ph",wsPort:443,wssPort:443,forceTLS:!0,disableStats:!0,enabledTransports:["ws","wss"],authEndpoint:"https://training-api.wah.ph/broadcasting/auth",auth:{headers:{Authorization:`Bearer ${this.cookie_value}`}}})}subscribeToChannel(n,o,s,d,h){this.echo[n](o+"."+s).listen("."+d,D=>{h(D)})}listenToUserChannel(n){console.log(n),this.echo.private(`App.Models.User.${n}`).listen("UserUpdated",o=>{console.log("User updated event received:",o)})}listenToTestChannel(n){this.echo.channel("todays-patient"+n).listen(".todays.patient",o=>{console.log("User updated event received:",o)})}static{this.\u0275fac=function(o){return new(o||a)(e.KVO(Ve.O))}}static{this.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var P=b(9417);function gt(a,u){if(1&a&&(e.j41(0,"option",10),e.EFF(1),e.k0s()),2&a){const n=u.$implicit;e.Y8G("value",n.id),e.R7$(),e.E5c("",n.last_name,", ",n.first_name," ",n.middle_name,"")}}function ce(a,u){if(1&a&&e.nrm(0,"fa-icon",35),2&a){const n=e.XpG(3);e.Y8G("icon",n.faPersonPregnant)}}function qe(a,u){if(1&a&&e.nrm(0,"fa-icon",36),2&a){const n=e.XpG(3);e.Y8G("icon",n.faPersonCane)}}function _t(a,u){if(1&a&&e.nrm(0,"fa-icon",37),2&a){const n=e.XpG(3);e.Y8G("icon",n.faWheelchair)}}function Je(a,u){if(1&a&&e.nrm(0,"fa-icon",36),2&a){const n=e.XpG(3);e.Y8G("icon",n.faDog)}}function We(a,u){if(1&a&&e.nrm(0,"fa-icon",38),2&a){const n=e.XpG(3);e.Y8G("icon",n.faBaby)}}function vt(a,u){if(1&a&&e.nrm(0,"fa-icon",39),2&a){const n=e.XpG(3);e.Y8G("icon",n.faLungs)}}function Ke(a,u){if(1&a&&e.nrm(0,"fa-icon",36),2&a){const n=e.XpG(3);e.Y8G("icon",n.faTooth)}}function bt(a,u){if(1&a&&e.nrm(0,"fa-icon",36),2&a){const n=e.XpG(3);e.Y8G("icon",n.faHeathPulse)}}function yt(a,u){1&a&&(e.j41(0,"div",40),e.qSk(),e.j41(1,"svg",41),e.nrm(2,"path",42),e.k0s()())}function kt(a,u){if(1&a&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&a){const n=e.XpG().$implicit;e.R7$(),e.Lme(" Dr. ",n.physician.first_name," ",n.physician.last_name," ")}}function xt(a,u){1&a&&(e.j41(0,"span"),e.EFF(1," - "),e.k0s())}function ge(a,u){if(1&a){const n=e.RV6();e.j41(0,"div",13)(1,"div",14),e.bIt("click",function(){const s=e.eBV(n).$implicit,d=e.XpG(2);return e.Njj(d.openItr(null==s?null:s.patient.id,"itr"))}),e.j41(2,"a",15)(3,"div",16)(4,"span",17),e.EFF(5),e.k0s()()(),e.j41(6,"div",18)(7,"span",19),e.EFF(8),e.k0s(),e.j41(9,"span",20),e.EFF(10," -"),e.k0s()()(),e.j41(11,"div",21),e.DNE(12,ce,1,1,"fa-icon",22)(13,qe,1,1,"fa-icon",23)(14,_t,1,1,"fa-icon",24)(15,Je,1,1,"fa-icon",23)(16,We,1,1,"fa-icon",25)(17,vt,1,1,"fa-icon",26)(18,Ke,1,1,"fa-icon",23)(19,bt,1,1,"fa-icon",23)(20,yt,3,0,"div",27),e.k0s(),e.j41(21,"div",28)(22,"div",29),e.bIt("click",function(){const s=e.eBV(n).$implicit,d=e.XpG(2);return e.Njj(d.openItr(null==s?null:s.patient.id,null==s?null:s.pt_group,null==s?null:s.id))}),e.j41(23,"button",30)(24,"span",31),e.EFF(25),e.k0s(),e.j41(26,"span",32),e.EFF(27),e.k0s()()(),e.j41(28,"div",33),e.DNE(29,kt,2,2,"span",9)(30,xt,2,0,"span",9),e.k0s(),e.j41(31,"div",34),e.EFF(32),e.k0s()()()}if(2&a){const n=u.$implicit,o=e.XpG(2);e.R7$(5),e.JRh(o.getInitials(null==n||null==n.patient?null:n.patient.first_name,null==n||null==n.patient?null:n.patient.last_name)),e.R7$(3),e.LHq(" ",null==n||null==n.patient?null:n.patient.last_name,", ",null==n||null==n.patient?null:n.patient.first_name," ","NA"===(null==n||null==n.patient?null:n.patient.middle_name)?"":null==n||null==n.patient?null:n.patient.middle_name," ","NA"===(null==n||null==n.patient?null:n.patient.suffix_name)?"":null==n||null==n.patient?null:n.patient.suffix_name," "),e.R7$(4),e.Y8G("ngIf",n.is_pregnant||"mc"===n.pt_group),e.R7$(),e.Y8G("ngIf",o.getAge(n)),e.R7$(),e.Y8G("ngIf","NA"!==n.patient.pwd_type_code),e.R7$(),e.Y8G("ngIf","ab"===n.pt_group),e.R7$(),e.Y8G("ngIf","cc"===n.pt_group),e.R7$(),e.Y8G("ngIf","tb"===n.pt_group),e.R7$(),e.Y8G("ngIf","dn"===n.pt_group),e.R7$(),e.Y8G("ngIf","ncd"===n.pt_group),e.R7$(),e.Y8G("ngIf","fp"===n.pt_group),e.R7$(5),e.JRh(o.checkVisit(null==n?null:n.pt_group)),e.R7$(2),e.JRh(null==n?null:n.pt_group),e.R7$(2),e.Y8G("ngIf",n.physician),e.R7$(),e.Y8G("ngIf",!n.physician),e.R7$(2),e.SpI(" ",o.getDataDiff(null==n?null:n.consult_date)," ")}}function wt(a,u){if(1&a&&(e.j41(0,"div",11),e.DNE(1,ge,33,19,"div",12),e.k0s()),2&a){const n=e.XpG();e.R7$(),e.Y8G("ngForOf",n.today_consults)}}function L(a,u){1&a&&(e.j41(0,"div",43)(1,"div",44),e.EFF(2," No record to show "),e.k0s()())}function Ct(a,u){if(1&a){const n=e.RV6();e.j41(0,"div")(1,"nav",49)(2,"button",50),e.bIt("click",function(){e.eBV(n);const s=e.XpG(2);return e.Njj(s.getTodaysConsult(1))}),e.nrm(3,"fa-icon",51),e.k0s(),e.j41(4,"button",52),e.bIt("click",function(){e.eBV(n);const s=e.XpG(2);return e.Njj(s.getTodaysConsult(s.current_page-1))}),e.nrm(5,"fa-icon",51),e.EFF(6,"Previous "),e.k0s(),e.j41(7,"button",52),e.bIt("click",function(){e.eBV(n);const s=e.XpG(2);return e.Njj(s.getTodaysConsult(s.current_page+1))}),e.EFF(8," Next"),e.nrm(9,"fa-icon",53),e.k0s(),e.j41(10,"button",54),e.bIt("click",function(){e.eBV(n);const s=e.XpG(2);return e.Njj(s.getTodaysConsult(s.last_page))}),e.nrm(11,"fa-icon",53),e.k0s()()()}if(2&a){const n=e.XpG(2);e.R7$(2),e.Y8G("disabled",1===n.current_page),e.R7$(),e.Y8G("icon",n.faAnglesLeft),e.R7$(),e.Y8G("disabled",1===n.current_page),e.R7$(),e.Y8G("icon",n.faChevronLeft),e.R7$(2),e.Y8G("disabled",n.current_page===n.last_page),e.R7$(2),e.Y8G("icon",n.faChevronRight),e.R7$(),e.Y8G("disabled",n.current_page===n.last_page),e.R7$(),e.Y8G("icon",n.faAnglesRight)}}function Ft(a,u){if(1&a&&(e.j41(0,"div")(1,"div",45)(2,"div",46)(3,"div")(4,"p",47),e.EFF(5," Showing "),e.j41(6,"span",48),e.EFF(7),e.k0s(),e.EFF(8," to "),e.j41(9,"span",48),e.EFF(10),e.k0s(),e.EFF(11," of "),e.j41(12,"span",48),e.EFF(13),e.k0s(),e.EFF(14," results "),e.k0s()(),e.DNE(15,Ct,12,8,"div",9),e.k0s()()()),2&a){const n=e.XpG();e.R7$(7),e.JRh(n.from),e.R7$(3),e.JRh(n.to),e.R7$(3),e.JRh(n.total),e.R7$(2),e.Y8G("ngIf",n.total>=6)}}let Tt=(()=>{class a{getTodaysConsult(n){if(this.isLoading)return;let o={params:{}};return o.params.page=n||this.current_page,"all"!==this.selected_physician?o.params.physician_id=this.selected_physician:delete o.params.physician_id,o.params.per_page=this.per_page,o.params.consult_done=0,o.params.todays_patient=1,this.isLoading=!0,new Promise((s,d)=>{this.http.get("consultation/records",o).pipe((0,O.j)(()=>this.isLoading=!1)).subscribe({next:h=>{this.today_consults=h.data,this.show_form=!0,this.current_page=h.meta.current_page,this.last_page=h.meta.last_page,this.from=h.meta.from,this.to=h.meta.to,this.total=h.meta.total,s()},error:h=>console.log(h)})})}subscribeRefresh(){this.todays_interval=setInterval(()=>{this.getTodaysConsult()},3e4)}loadPhysicians(){return new Promise((n,o)=>{this.http.get("users",{params:{per_page:"all",doctors_list:1}}).subscribe({next:s=>{this.physicians=s.data;let d=this.http.getUserFromJSON();this.selected_physician="MD"===d.designation_code||"DENTIST"===d.designation_code?d.id:"all",n()},error:s=>{console.log(s),o(s)}})})}getAge(n){if(n.patient.birthdate){let o=this.ageService.calcuateAge(n.patient.birthdate);return"year"===o.type&&o.age>=60}}openItr(n,o,s){this.router.navigate("itr"===o?["/patient/"+o,{id:n}]:["/patient/"+o,{id:n,consult_id:s}])}getDataDiff(n){let o=new Date,s=new Date(n);var d=o.getTime()-s.getTime(),h=Math.floor(d/864e5),D=Math.floor(d/36e5)-24*h,B=Math.floor(d/6e4)-(24*h*60+60*D);return(h?h+" days":"")+" "+(D?D+" hours":"")+" "+(B?B+" minutes":"")}checkVisit(n){return this.nameHelper.getVisitType(n)}getInitials(n,o){return n.charAt(0)+o.charAt(0)}constructor(n,o,s,d,h){this.http=n,this.router=o,this.nameHelper=s,this.ageService=d,this.laravelEchoService=h,this.unsubscribe$=new A.B,this.faQuestionCircle=k.wRm,this.faChevronDown=k.Jt$,this.faFolderOpen=k.Uj9,this.faHeart=k.qcK,this.faFlask=k.rIc,this.faNotesMedical=k.UPF,this.faExclamationCircle=k.tUE,this.faChevronRight=k.XkK,this.faChevronLeft=k.Wzs,this.faAnglesLeft=k.rNr,this.faAnglesRight=k.up_,this.faPersonPregnant=k.Q9O,this.faPersonCane=k.W8p,this.faWheelchair=k.GKc,this.faBaby=k.OIP,this.faDog=k.c_V,this.faLungs=k.n55,this.faTooth=k.uT2,this.faHeathPulse=k.RMP,this.selected_physician="all",this.per_page=40,this.current_page=1,this.show_form=!1,this.debounceDelay=1500,this.isLoading=!1,this.current_user=this.http.getUserFromJSON(),this.isListening=!1}listenToChannel(){if(this.isListening)return;this.isListening=!0;const n=()=>this.loadPhysicians().then(()=>this.getTodaysConsult()).catch(o=>{throw console.error("Error loading physicians or consultations:",o),o});n(),this.laravelEchoService.subscribeToChannel("channel","todays-patient",this.current_user.facility_code,"todays.patient",o=>{console.log("User updated event received:",o),o&&n()})}ngOnInit(){this.listenToChannel()}ngOnDestroy(){clearInterval(this.todays_interval),this.unsubscribe$.next(),this.unsubscribe$.complete()}static{this.\u0275fac=function(o){return new(o||a)(e.rXU(C.k),e.rXU(_.Ix),e.rXU(R.j),e.rXU(j.V),e.rXU(Q))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-todays-consult"]],inputs:{date_today:"date_today"},standalone:!1,decls:12,vars:6,consts:[[1,"mb-10","rounded-xl","text-gray-600","h-100","border","border-slate-100","shadow-md","select-none"],[1,"md:flex","md:justify-between","md:items-center","pb-2","bg-orange-400","text-white","rounded-t-md","p-2"],[1,"font-semibold","pl-3"],[1,"flex","items-center"],[1,"input","px-2","mr-3","disabled:bg-gray-300","w-72","text-gray-800",3,"change","ngModelChange","ngModel"],["value","all"],["class","pr-",3,"value",4,"ngFor","ngForOf"],["class","p-3",4,"ngIf"],["class","pt-3",4,"ngIf"],[4,"ngIf"],[1,"pr-",3,"value"],[1,"p-3"],["class","flex justify-between items-center mb-3  pb-3 border-b border-gray-200",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","mb-3","pb-3","border-b","border-gray-200"],[1,"flex","cursor-pointer","w-2/5","hover:opacity-75",3,"click"],[1,"justify-center","mx-auto"],[1,"inline-flex","overflow-hidden","relative","justify-center","items-center","w-16","h-16","bg-gray-100","rounded-full","dark:bg-gray-600"],[1,"font-medium","text-gray-600","text-sm","xl:text-lg"],[1,"flex","justify-center","text-blue-500","md:block","leading-tight","mx-2","my-1","w-full","hover:bg-blue-500","hover:text-white","p-1","rounded-md"],[1,"w-full","block","font-medium","my-0","py-0","text-sm"],[1,"w-full","block","text-xs"],[1,"w-16","text-2xl","text-gray-600","space-x-1"],["class","text-rose-300",3,"icon",4,"ngIf"],[3,"icon",4,"ngIf"],["class","text-sky-500",3,"icon",4,"ngIf"],["class","text-blue-500",3,"icon",4,"ngIf"],["class","text-green-500",3,"icon",4,"ngIf"],["class","w-16",4,"ngIf"],[1,"grid","grid-cols-12","text-left","w-3/5"],[1,"col-span-6","text-gray-700","hover:bg-green-500","hover:text-white","hover:cursor-pointer","p-3","rounded-md","text-[.85em]",3,"click"],["type","button",1,"flex","justify-between"],[1,"hidden","lg:inline-block"],[1,"lg:hidden","uppercase","text-xs"],[1,"col-span-3","px-3","text-sm"],[1,"col-span-3","px-3","text-[.8em]"],[1,"text-rose-300",3,"icon"],[3,"icon"],[1,"text-sky-500",3,"icon"],[1,"text-blue-500",3,"icon"],[1,"text-green-500",3,"icon"],[1,"w-16"],["viewBox","0 0 22 22","xmlns","http://www.w3.org/2000/svg",1,"fill-current","w-6","h-6"],["d","M16,4c0-1.11,0.89-2,2-2s2,0.89,2,2s-0.89,2-2,2S16,5.11,16,4z M20,22v-6h2.5l-2.54-7.63C19.68,7.55,18.92,7,18.06,7h-0.12 c-0.86,0-1.63,0.55-1.9,1.37l-0.86,2.58C16.26,11.55,17,12.68,17,14v8H20z M12.5,11.5c0.83,0,1.5-0.67,1.5-1.5s-0.67-1.5-1.5-1.5 S11,9.17,11,10S11.67,11.5,12.5,11.5z M5.5,6c1.11,0,2-0.89,2-2s-0.89-2-2-2s-2,0.89-2,2S4.39,6,5.5,6z M7.5,22v-7H9V9 c0-1.1-0.9-2-2-2H4C2.9,7,2,7.9,2,9v6h1.5v7H7.5z M14,22v-4h1v-4c0-0.82-0.68-1.5-1.5-1.5h-2c-0.82,0-1.5,0.68-1.5,1.5v4h1v4H14z"],[1,"pt-3"],[1,"text-center","items-center","mb-3","italic"],[1,"bg-white","px-4","py-3","flex","items-center","justify-between","border-t","border-gray-200","sm:px-6"],[1,"hidden","sm:flex-1","sm:flex","sm:items-center","sm:justify-between"],[1,"text-sm","text-gray-700"],[1,"font-medium"],["aria-label","Pagination",1,"relative","z-0","inline-flex","shadow-sm","-space-x-px"],[1,"relative","inline-flex","items-center","px-2","py-2","rounded-l-md","border","border-gray-300","enabled:bg-white","disabled:bg-gray-300","text-sm","font-medium","text-gray-500","hover:bg-gray-50",3,"click","disabled"],[1,"block","h-15","w-15","text-gray-500","pr-1",3,"icon"],[1,"relative","inline-flex","items-center","px-4","py-2","border","border-gray-300","enabled:bg-white","disabled:bg-gray-300","bg-white","text-sm","font-medium","text-gray-700","hover:bg-gray-50",3,"click","disabled"],[1,"h-5","w-5","text-gray-500",3,"icon"],[1,"relative","inline-flex","items-center","px-2","py-2","rounded-r-md","border","border-gray-300","enabled:bg-white","disabled:bg-gray-300","text-sm","font-medium","text-gray-500","hover:bg-gray-50",3,"click","disabled"]],template:function(o,s){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"span",2),e.EFF(3),e.k0s(),e.j41(4,"div",3)(5,"select",4),e.bIt("change",function(){return s.getTodaysConsult()}),e.mxI("ngModelChange",function(h){return e.DH7(s.selected_physician,h)||(s.selected_physician=h),h}),e.j41(6,"option",5),e.EFF(7,"All"),e.k0s(),e.DNE(8,gt,2,4,"option",6),e.k0s()()(),e.DNE(9,wt,2,1,"div",7)(10,L,3,0,"div",8)(11,Ft,16,4,"div",9),e.k0s()),2&o&&(e.R7$(3),e.SpI("Todays Consult (",s.date_today,")"),e.R7$(2),e.R50("ngModel",s.selected_physician),e.R7$(3),e.Y8G("ngForOf",s.physicians),e.R7$(),e.Y8G("ngIf",s.show_form),e.R7$(),e.Y8G("ngIf",0===(null==s.today_consults?null:s.today_consults.length)),e.R7$(),e.Y8G("ngIf",s.total>=1))},dependencies:[x.Sq,x.bT,w.aY,P.xH,P.y7,P.wz,P.BC,P.vS],encapsulation:2})}}return a})();function St(a,u){if(1&a){const n=e.RV6();e.j41(0,"div",15),e.bIt("click",function(){const s=e.eBV(n).$implicit,d=e.XpG(3);return e.Njj(d.openItr(s.value.patient_id,"itr"))}),e.EFF(1),e.k0s()}if(2&a){const n=u.$implicit;e.R7$(),e.SpI(" ",n.value.appointment_desc," ")}}function Rt(a,u){if(1&a){const n=e.RV6();e.j41(0,"div",9)(1,"div",10)(2,"div",11)(3,"span",12),e.bIt("click",function(){const s=e.eBV(n).$implicit,d=e.XpG(2);return e.Njj(d.openItr(s.value[0].patient_id,"itr"))}),e.EFF(4),e.k0s()()(),e.j41(5,"div",13),e.DNE(6,St,2,1,"div",14),e.nI1(7,"keyvalue"),e.k0s()()}if(2&a){const n=u.$implicit;e.R7$(4),e.SpI(" ",n.key," "),e.R7$(2),e.Y8G("ngForOf",e.bMT(7,2,n.value))}}function jt(a,u){if(1&a&&(e.j41(0,"div",7),e.DNE(1,Rt,8,4,"div",8),e.nI1(2,"keyvalue"),e.k0s()),2&a){const n=e.XpG();e.R7$(),e.Y8G("ngForOf",e.bMT(2,1,n.todays_appointment))}}function Et(a,u){1&a&&(e.j41(0,"div",16)(1,"div",17),e.EFF(2," No record to show "),e.k0s()())}function xe(a,u){if(1&a&&(e.j41(0,"div",18)(1,"div",17),e.nrm(2,"fa-icon",19),e.k0s()()),2&a){const n=e.XpG();e.R7$(2),e.Y8G("icon",n.faCircleNotch)}}function we(a,u){if(1&a){const n=e.RV6();e.j41(0,"div")(1,"nav",24)(2,"button",25),e.bIt("click",function(){e.eBV(n);const s=e.XpG(2);return e.Njj(s.loadAppointments(1))}),e.nrm(3,"fa-icon",26),e.k0s(),e.j41(4,"button",27),e.bIt("click",function(){e.eBV(n);const s=e.XpG(2);return e.Njj(s.loadAppointments(s.current_page-1))}),e.nrm(5,"fa-icon",26),e.EFF(6,"Previous "),e.k0s(),e.j41(7,"button",27),e.bIt("click",function(){e.eBV(n);const s=e.XpG(2);return e.Njj(s.loadAppointments(s.current_page+1))}),e.EFF(8," Next"),e.nrm(9,"fa-icon",28),e.k0s(),e.j41(10,"button",29),e.bIt("click",function(){e.eBV(n);const s=e.XpG(2);return e.Njj(s.loadAppointments(s.last_page))}),e.nrm(11,"fa-icon",28),e.k0s()()()}if(2&a){const n=e.XpG(2);e.R7$(2),e.Y8G("disabled",1===n.current_page),e.R7$(),e.Y8G("icon",n.faAnglesLeft),e.R7$(),e.Y8G("disabled",1===n.current_page),e.R7$(),e.Y8G("icon",n.faChevronLeft),e.R7$(2),e.Y8G("disabled",n.current_page===n.last_page),e.R7$(2),e.Y8G("icon",n.faChevronRight),e.R7$(),e.Y8G("disabled",n.current_page===n.last_page),e.R7$(),e.Y8G("icon",n.faAnglesRight)}}function It(a,u){if(1&a&&(e.j41(0,"div")(1,"div",20)(2,"div",21)(3,"div")(4,"p",22),e.EFF(5," Showing "),e.j41(6,"span",23),e.EFF(7),e.k0s(),e.EFF(8," to "),e.j41(9,"span",23),e.EFF(10),e.k0s(),e.EFF(11," of "),e.j41(12,"span",23),e.EFF(13),e.k0s(),e.EFF(14," results "),e.k0s()(),e.DNE(15,we,12,8,"div",6),e.k0s()()()),2&a){const n=e.XpG();e.R7$(7),e.JRh(n.from),e.R7$(3),e.JRh(n.to),e.R7$(3),e.JRh(n.total),e.R7$(2),e.Y8G("ngIf",n.total>=6)}}let Pt=(()=>{class a{openItr(n,o,s){this.router.navigate("itr"===o?["/patient/"+o,{id:n}]:["/patient/"+o,{id:n,consult_id:s}])}loadAppointments(n){if(this.show_form=!1,this.isLoading)return;let o={params:{}};o.params.page=n||this.current_page,o.params.facility_code=this.http.getUserFacility(),o.params.per_page=this.per_page,o.params.consult_done=0,this.isLoading=!0,this.http.get("appointment/schedule",o).pipe((0,O.j)(()=>this.isLoading=!1)).subscribe({next:s=>{this.todays_appointment=s[0].data,this.current_page=s[0].current_page,this.last_page=s[0].last_page,this.from=s[0].from,this.to=s[0].to,this.total=s[0].total,this.show_form=!0},error:s=>console.log(s)})}constructor(n,o){this.http=n,this.router=o,this.faCircleNotch=k.s4k,this.faAnglesLeft=k.rNr,this.faChevronLeft=k.Wzs,this.faChevronRight=k.XkK,this.faAnglesRight=k.up_,this.show_form=!1,this.per_page=5,this.current_page=1,this.isLoading=!1,this.appointment_length=0}ngOnInit(){this.loadAppointments()}static{this.\u0275fac=function(o){return new(o||a)(e.rXU(C.k),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-todays-appointment"]],inputs:{date_today:"date_today"},standalone:!1,decls:8,vars:5,consts:[[1,"mb-10","text-gray-600","h-100","border","border-slate-200","shadow-md","rounded-md"],[1,"md:flex","md:justify-between","md:items-center","pb-2","bg-blue-500","text-white","rounded-t-md"],[1,"font-semibold","pt-2","pl-5"],["class","p-3",4,"ngIf"],["class","-pt-3",4,"ngIf"],["class","pt-3",4,"ngIf"],[4,"ngIf"],[1,"p-3"],["class","flex justify-between border-b border-gray-100",4,"ngFor","ngForOf"],[1,"flex","justify-between","border-b","border-gray-100"],[1,"flex","w-3/5"],[1,"flex","justify-center","text-gray-700","md:block","leading-tight","align-top","my-1","w-full","p-1","rounded-md"],[1,"w-full","font-medium","my-0","text-sm","rounded-md","py-2","px-3","hover:cursor-pointer","hover:bg-blue-500","hover:text-white",3,"click"],[1,"grid","grid-cols-12","text-left","w-2/5"],["class","col-span-12 text-gray-700 hover:bg-green-500 hover:text-white hover:cursor-pointer p-3 rounded-md text-[.85em]",3,"click",4,"ngFor","ngForOf"],[1,"col-span-12","text-gray-700","hover:bg-green-500","hover:text-white","hover:cursor-pointer","p-3","rounded-md","text-[.85em]",3,"click"],[1,"-pt-3"],[1,"text-center","items-center","mb-3","italic"],[1,"pt-3"],["animation","spin",1,"text-blue-500",3,"icon"],[1,"bg-white","px-4","py-3","flex","items-center","justify-between","border-t","border-gray-200","sm:px-6","rounded-b-md"],[1,"hidden","sm:flex-1","sm:flex","sm:items-center","sm:justify-between"],[1,"text-sm","text-gray-700"],[1,"font-medium"],["aria-label","Pagination",1,"relative","z-0","inline-flex","shadow-sm","-space-x-px"],[1,"relative","inline-flex","items-center","px-2","py-2","rounded-l-md","border","border-gray-300","enabled:bg-white","disabled:bg-gray-300","text-sm","font-medium","text-gray-500","hover:bg-gray-50",3,"click","disabled"],[1,"block","h-15","w-15","text-gray-500","pr-1",3,"icon"],[1,"relative","inline-flex","items-center","px-4","py-2","border","border-gray-300","enabled:bg-white","disabled:bg-gray-300","bg-white","text-sm","font-medium","text-gray-700","hover:bg-gray-50",3,"click","disabled"],[1,"h-5","w-5","text-gray-500",3,"icon"],[1,"relative","inline-flex","items-center","px-2","py-2","rounded-r-md","border","border-gray-300","enabled:bg-white","disabled:bg-gray-300","text-sm","font-medium","text-gray-500","hover:bg-gray-50",3,"click","disabled"]],template:function(o,s){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"span",2),e.EFF(3),e.k0s()(),e.DNE(4,jt,3,3,"div",3)(5,Et,3,0,"div",4)(6,xe,3,1,"div",5)(7,It,16,4,"div",6),e.k0s()),2&o&&(e.R7$(3),e.SpI("Todays Appointment (",s.date_today,")"),e.R7$(),e.Y8G("ngIf",s.show_form),e.R7$(),e.Y8G("ngIf",s.show_form&&0===s.todays_appointment.length),e.R7$(),e.Y8G("ngIf",!s.show_form&&!s.todays_appointment),e.R7$(),e.Y8G("ngIf",s.total>=1))},dependencies:[x.Sq,x.bT,w.aY,x.lG],encapsulation:2})}}return a})();var At=b(7468),Qe=b(5794);function Ce(a,u){if(1&a){const n=e.RV6();e.j41(0,"div",14)(1,"div",15),e.EFF(2," Do you want to accept this referral? "),e.k0s(),e.j41(3,"div",16)(4,"div",17)(5,"button",18),e.bIt("click",function(){e.eBV(n);const s=e.XpG();return e.Njj(s.loadLibraries())}),e.EFF(6,"Deny"),e.k0s()(),e.j41(7,"div")(8,"button",19),e.bIt("click",function(){e.eBV(n);const s=e.XpG();return e.Njj(s.toggleForm())}),e.EFF(9,"Accept"),e.k0s()()()()}}function Z(a,u){if(1&a&&(e.j41(0,"option",33),e.EFF(1),e.k0s()),2&a){const n=u.$implicit;e.Y8G("value",n.id),e.R7$(),e.JRh(n.desc)}}function Ot(a,u){if(1&a&&(e.j41(0,"div",28)(1,"label",29),e.EFF(2,"Refusal Reason"),e.k0s(),e.j41(3,"select",30)(4,"option",31),e.EFF(5,"- Choose Reason -"),e.k0s(),e.DNE(6,Z,2,2,"option",32),e.k0s()()),2&a){const n=e.XpG(2);e.R7$(6),e.Y8G("ngForOf",n.refusal_list)}}function oe(a,u){1&a&&(e.j41(0,"div",28)(1,"label",34),e.EFF(2,"Refusal Remarks"),e.k0s(),e.nrm(3,"input",35),e.k0s())}function Nt(a,u){if(1&a){const n=e.RV6();e.j41(0,"form",20),e.bIt("submit",function(){e.eBV(n);const s=e.XpG();return e.Njj(s.onSubmit())}),e.j41(1,"div",21)(2,"div",22)(3,"div",23),e.nrm(4,"div",24),e.j41(5,"div",24)(6,"label",25),e.EFF(7),e.k0s(),e.nrm(8,"input",26),e.k0s(),e.nrm(9,"div",24),e.k0s(),e.DNE(10,Ot,7,1,"div",27)(11,oe,4,0,"div",27),e.k0s()()()}if(2&a){const n=e.XpG();e.Y8G("formGroup",n.referralForm),e.R7$(7),e.SpI(" ",n.show_form?"Refusal":"Accept"," Date "),e.R7$(),e.Y8G("min",n.max_date),e.R7$(2),e.Y8G("ngIf",n.show_form),e.R7$(),e.Y8G("ngIf",n.show_form)}}function Ze(a,u){if(1&a&&(e.j41(0,"div",36),e.nrm(1,"fa-icon",37),e.j41(2,"span",38),e.EFF(3,"Loading libraries..."),e.k0s()()),2&a){const n=e.XpG();e.R7$(),e.Y8G("icon",n.faCircleNotch)}}function et(a,u){if(1&a){const n=e.RV6();e.j41(0,"button",39),e.bIt("click",function(){e.eBV(n);const s=e.XpG();return e.Njj(s.onSubmit())}),e.EFF(1),e.k0s()}if(2&a){const n=e.XpG();e.Y8G("disabled",n.is_saving||n.referralForm.invalid),e.R7$(),e.SpI(" ",n.is_saving?"Saving":"Save"," ")}}let tt=(()=>{class a{get f(){return this.referralForm.controls}toggleForm(){this.with_outcome=!this.with_outcome,this.createForm()}loadLibraries(){this.show_form=!1,this.toggleForm();const n=this.http.get("libraries/referral-refusal");(0,At.p)([n]).subscribe({next:([o])=>{this.refusal_list=o.data,this.show_form=!0},error:o=>console.log(o)})}createForm(){this.referralForm=this.formBuilder.nonNullable.group({id:[this.selected_appointment.id,P.k0.required],outcome_date:[null,P.k0.required],referral_refusal_id:[null],refusal_others:[null]})}onSubmit(){this.is_saving=!0,this.http.update("appointment/schedule/",this.referralForm.value.id,{id:this.referralForm.value.id,outcome_date:this.referralForm.value.outcome_date,referral_refusal_id:this.referralForm.value.referral_refusal_id,refusal_others:this.referralForm.value.refusal_others}).subscribe({next:o=>{this.is_saving=!1,this.toastr.success("Successfully recorded!","Referral"),this.router.navigate(["/patient/itr",{id:this.selected_appointment.patient_id}])},error:o=>console.log(o)})}closeModal(){this.toggleModal.emit("outcome")}constructor(n,o,s,d){this.formBuilder=n,this.http=o,this.toastr=s,this.router=d,this.loadAppointments=new e.bkB,this.toggleModal=new e.bkB,this.faCircleNotch=k.s4k,this.max_date=(0,x.Yq)(new Date,"yyyy-MM-dd","en","Asia/Manila"),this.is_saving=!1,this.with_outcome=!1,this.referralForm=new P.gE({id:new P.MJ(""),outcome_date:new P.MJ(""),referral_refusal_id:new P.MJ(""),refusal_others:new P.MJ("")})}static{this.\u0275fac=function(o){return new(o||a)(e.rXU(P.ok),e.rXU(C.k),e.rXU(Qe.tw),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-outcome-form"]],inputs:{selected_appointment:"selected_appointment"},outputs:{loadAppointments:"loadAppointments",toggleModal:"toggleModal"},standalone:!1,decls:16,vars:4,consts:[["id","defaultModal","tabindex","-1","aria-modal","true","role","dialog",1,"overflow-y-auto","overflow-x-hidden","fixed","top-0","right-0","left-0","w-full","md:inset-0","h-modal","md:h-full","justify-center","items-center","flex",2,"z-index","60"],[1,"relative","p-4","w-full","max-w-3xl","h-auto","md:h-auto"],[1,"relative","bg-white","rounded-lg","shadow","dark:bg-gray-700"],[1,"flex","justify-between","items-start","py-3","px-5","rounded-t","border-b","bg-blue-500","dark:border-gray-600"],[1,"mt-2","text-sm","font-bold","text-white","dark:text-white"],[1,"overflow-y-auto","h-96","scrollbar-thin","scrollbar-thumb-gray-400","scrollbar-track-gray-100"],["class","flex flex-col justify-center pt-32",4,"ngIf"],["class","w-full max-w-3xl text-left text-gray-500 dark:text-gray-400",3,"formGroup","submit",4,"ngIf"],[1,"flex","justify-center","items-center"],["class","flex justify-center items-center space-x-2 py-20",4,"ngIf"],[1,"flex","justify-end","py-4","px-5","space-x-4","rounded-b","border-t","border-gray-200","dark:border-gray-600"],["type","button",1,"btn-save","bg-gray-400",3,"click"],["type","submit","class","btn-save px-10 disabled:bg-gray-300",3,"disabled","click",4,"ngIf"],[1,"opacity-50","fixed","inset-0","z-50","bg-black"],[1,"flex","flex-col","justify-center","pt-32"],[1,"flex","justify-center"],[1,"flex","flex-row","justify-center","mt-5"],[1,"mr-3"],[1,"btn-save","bg-red-500",3,"click"],[1,"btn-save",3,"click"],[1,"w-full","max-w-3xl","text-left","text-gray-500","dark:text-gray-400",3,"submit","formGroup"],[1,"p-5"],[1,"grid","grid-cols-9","gap-x-4","gap-y-2"],[1,"col-span-9","grid","grid-cols-9","gap-x-4","gap-y-2"],[1,"col-span-3"],["for","outcome_date"],["type","date","name","outcome_date","id","outcome_date","formControlName","outcome_date",1,"input",3,"min"],["class","col-span-9",4,"ngIf"],[1,"col-span-9"],["for","referral_refusal_id"],["id","referral_refusal_id","name","referral_refusal_id","formControlName","referral_refusal_id",1,"input","disabled:bg-gray-300"],["value","0","selected",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["for","refusal_others"],["type","text","name","refusal_others","id","refusal_others","formControlName","refusal_others",1,"input"],[1,"flex","justify-center","items-center","space-x-2","py-20"],["animation","spin",1,"text-blue-500",3,"icon"],[1,"text-blue-500"],["type","submit",1,"btn-save","px-10","disabled:bg-gray-300",3,"click","disabled"]],template:function(o,s){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),e.EFF(5," Referral "),e.k0s()(),e.j41(6,"div",5),e.DNE(7,Ce,10,0,"div",6)(8,Nt,12,5,"form",7),e.j41(9,"div",8),e.DNE(10,Ze,4,1,"div",9),e.k0s()(),e.j41(11,"div",10)(12,"button",11),e.bIt("click",function(){return s.closeModal()}),e.EFF(13,"Close"),e.k0s(),e.DNE(14,et,2,2,"button",12),e.k0s()()()(),e.nrm(15,"div",13)),2&o&&(e.R7$(7),e.Y8G("ngIf",!s.with_outcome&&!s.show_form),e.R7$(),e.Y8G("ngIf",s.with_outcome),e.R7$(2),e.Y8G("ngIf",!1===s.show_form),e.R7$(4),e.Y8G("ngIf",s.with_outcome))},dependencies:[x.Sq,x.bT,w.aY,P.qT,P.xH,P.y7,P.me,P.wz,P.BC,P.cb,P.j4,P.JD],encapsulation:2})}}return a})();function nt(a,u){if(1&a&&(e.j41(0,"strong"),e.EFF(1,"Uncoordinated Referral:"),e.k0s(),e.EFF(2)),2&a){const n=e.XpG().$implicit;e.R7$(2),e.Lme(" ",n.value.uncoordinated.desc," ",99===n.value.uncoordinated.id?"("+n.value.uncoordinated_others+")":""," ")}}function $t(a,u){if(1&a){const n=e.RV6();e.j41(0,"div",16),e.bIt("click",function(){const s=e.eBV(n).$implicit,d=e.XpG(3);return e.Njj(d.toggleModal("outcome",s.value))}),e.j41(1,"strong"),e.EFF(2,"Referring Facility:"),e.k0s(),e.EFF(3),e.nrm(4,"br"),e.j41(5,"strong"),e.EFF(6,"Appointment Date:"),e.k0s(),e.EFF(7),e.nI1(8,"date"),e.nrm(9,"br"),e.j41(10,"strong"),e.EFF(11,"Referral Reason:"),e.k0s(),e.EFF(12),e.nrm(13,"br"),e.j41(14,"strong"),e.EFF(15,"Referral Category:"),e.k0s(),e.EFF(16),e.nrm(17,"br"),e.DNE(18,nt,3,2),e.k0s()}if(2&a){const n=u.$implicit;e.R7$(3),e.SpI(" ",n.value.facility_name," "),e.R7$(4),e.SpI(" ",e.brH(8,6,n.value.appointment_date,"MM/dd/yyyy","Asia/Manila")," "),e.R7$(5),e.Lme(" ",n.value.reason.desc," ",n.value.referral_reason?"("+n.value.referral_reason+")":"",""),e.R7$(4),e.SpI(" ",n.value.category.desc," "),e.R7$(2),e.vxM(n.value.uncoordinated?18:-1)}}function Lt(a,u){if(1&a){const n=e.RV6();e.j41(0,"div",10)(1,"div",11)(2,"div",12)(3,"span",13),e.bIt("click",function(){const s=e.eBV(n).$implicit,d=e.XpG(2);return e.Njj(d.openItr(s.value[0].patient_id,"itr"))}),e.EFF(4),e.k0s()()(),e.j41(5,"div",14),e.DNE(6,$t,19,10,"div",15),e.nI1(7,"keyvalue"),e.k0s()()}if(2&a){const n=u.$implicit;e.R7$(4),e.SpI(" ",n.key," "),e.R7$(2),e.Y8G("ngForOf",e.bMT(7,2,n.value))}}function Dt(a,u){if(1&a&&(e.j41(0,"div",8),e.DNE(1,Lt,8,4,"div",9),e.nI1(2,"keyvalue"),e.k0s()),2&a){const n=e.XpG();e.R7$(),e.Y8G("ngForOf",e.bMT(2,1,n.todays_appointment))}}function _e(a,u){1&a&&(e.j41(0,"div",17)(1,"div",18),e.EFF(2," No record to show "),e.k0s()())}function Gt(a,u){if(1&a&&(e.j41(0,"div",19)(1,"div",18),e.nrm(2,"fa-icon",20)(3,"br"),e.EFF(4," Loading... "),e.k0s()()),2&a){const n=e.XpG();e.R7$(2),e.Y8G("icon",n.faCircleNotch)}}function it(a,u){if(1&a){const n=e.RV6();e.j41(0,"div")(1,"nav",25)(2,"button",26),e.bIt("click",function(){e.eBV(n);const s=e.XpG(2);return e.Njj(s.getTodaysConsult(1))}),e.nrm(3,"fa-icon",27),e.k0s(),e.j41(4,"button",28),e.bIt("click",function(){e.eBV(n);const s=e.XpG(2);return e.Njj(s.getTodaysConsult(s.current_page-1))}),e.nrm(5,"fa-icon",27),e.EFF(6,"Previous "),e.k0s(),e.j41(7,"button",28),e.bIt("click",function(){e.eBV(n);const s=e.XpG(2);return e.Njj(s.getTodaysConsult(s.current_page+1))}),e.EFF(8," Next"),e.nrm(9,"fa-icon",29),e.k0s(),e.j41(10,"button",30),e.bIt("click",function(){e.eBV(n);const s=e.XpG(2);return e.Njj(s.getTodaysConsult(s.last_page))}),e.nrm(11,"fa-icon",29),e.k0s()()()}if(2&a){const n=e.XpG(2);e.R7$(2),e.Y8G("disabled",1===n.current_page),e.R7$(),e.Y8G("icon",n.faAnglesLeft),e.R7$(),e.Y8G("disabled",1===n.current_page),e.R7$(),e.Y8G("icon",n.faChevronLeft),e.R7$(2),e.Y8G("disabled",n.current_page===n.last_page),e.R7$(2),e.Y8G("icon",n.faChevronRight),e.R7$(),e.Y8G("disabled",n.current_page===n.last_page),e.R7$(),e.Y8G("icon",n.faAnglesRight)}}function Mt(a,u){if(1&a&&(e.j41(0,"div")(1,"div",21)(2,"div",22)(3,"div")(4,"p",23),e.EFF(5," Showing "),e.j41(6,"span",24),e.EFF(7),e.k0s(),e.EFF(8," to "),e.j41(9,"span",24),e.EFF(10),e.k0s(),e.EFF(11," of "),e.j41(12,"span",24),e.EFF(13),e.k0s(),e.EFF(14," results "),e.k0s()(),e.DNE(15,it,12,8,"div",6),e.k0s()()()),2&a){const n=e.XpG();e.R7$(7),e.JRh(n.from),e.R7$(3),e.JRh(n.to),e.R7$(3),e.JRh(n.total),e.R7$(2),e.Y8G("ngIf",n.total>=6)}}function Ut(a,u){if(1&a){const n=e.RV6();e.j41(0,"app-outcome-form",31),e.bIt("toggleModal",function(s){e.eBV(n);const d=e.XpG();return e.Njj(d.toggleModal(s))})("loadAppointments",function(){e.eBV(n);const s=e.XpG();return e.Njj(s.loadAppointments())}),e.k0s()}if(2&a){const n=e.XpG();e.Y8G("selected_appointment",n.selected_appointment)}}let Xt=(()=>{class a{toggleModal(n,o){o&&(this.selected_appointment=o),this.modals[n]=!this.modals[n]}openItr(n,o,s){this.router.navigate("itr"===o?["/patient/"+o,{id:n}]:["/patient/"+o,{id:n,consult_id:s}])}loadAppointments(n){this.show_form=!1;let o={params:{}};o.params.page=n||this.current_page,o.params.referral_facility_code=this.http.getUserFacility(),o.params.per_page=this.per_page,o.params.consult_done=0,o.params.disable_filter=1,this.http.get("appointment/schedule",o).subscribe({next:s=>{this.todays_appointment=s[0].data,this.current_page=s[0].current_page,this.last_page=s[0].last_page,this.from=s[0].from,this.to=s[0].to,this.total=s[0].total,this.show_form=!0},error:s=>console.log(s)})}constructor(n,o){this.http=n,this.router=o,this.faCircleNotch=k.s4k,this.faAnglesLeft=k.rNr,this.faChevronLeft=k.Wzs,this.faChevronRight=k.XkK,this.faAnglesRight=k.up_,this.show_form=!1,this.per_page=5,this.modals=[],this.appointment_length=0}ngOnInit(){this.loadAppointments()}static{this.\u0275fac=function(o){return new(o||a)(e.rXU(C.k),e.rXU(_.Ix))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-todays-referral"]],inputs:{date_today:"date_today"},standalone:!1,decls:9,vars:5,consts:[[1,"mb-10","text-gray-600","h-100","border","border-slate-200","shadow-md","rounded-md"],[1,"md:flex","md:justify-between","md:items-center","pb-2","bg-rose-500","text-white","rounded-t-md"],[1,"font-semibold","pt-2","pl-5"],["class","p-3",4,"ngIf"],["class","-pt-3",4,"ngIf"],["class","pt-3",4,"ngIf"],[4,"ngIf"],[3,"selected_appointment","toggleModal","loadAppointments",4,"ngIf"],[1,"p-3"],["class","flex justify-between border-b border-gray-100",4,"ngFor","ngForOf"],[1,"flex","justify-between","border-b","border-gray-100"],[1,"flex","w-3/5"],[1,"flex","justify-center","text-gray-700","md:block","leading-tight","align-top","my-1","w-full","p-1","rounded-md"],[1,"w-full","font-medium","my-0","text-sm","rounded-md","py-2","px-3","hover:cursor-pointer","hover:bg-blue-500","hover:text-white",3,"click"],[1,"grid","grid-cols-12","text-left","w-2/5"],["class","col-span-12 text-gray-700 hover:bg-green-500 hover:text-white hover:cursor-pointer p-3 rounded-md text-[.85em]",3,"click",4,"ngFor","ngForOf"],[1,"col-span-12","text-gray-700","hover:bg-green-500","hover:text-white","hover:cursor-pointer","p-3","rounded-md","text-[.85em]",3,"click"],[1,"-pt-3"],[1,"text-center","items-center","mb-3","italic"],[1,"pt-3"],["animation","spin",1,"text-blue-500",3,"icon"],[1,"bg-white","px-4","py-3","flex","items-center","justify-between","border-t","border-gray-200","sm:px-6","rounded-b-md"],[1,"hidden","sm:flex-1","sm:flex","sm:items-center","sm:justify-between"],[1,"text-sm","text-gray-700"],[1,"font-medium"],["aria-label","Pagination",1,"relative","z-0","inline-flex","shadow-sm","-space-x-px"],[1,"relative","inline-flex","items-center","px-2","py-2","rounded-l-md","border","border-gray-300","enabled:bg-white","disabled:bg-gray-300","text-sm","font-medium","text-gray-500","hover:bg-gray-50",3,"click","disabled"],[1,"block","h-15","w-15","text-gray-500","pr-1",3,"icon"],[1,"relative","inline-flex","items-center","px-4","py-2","border","border-gray-300","enabled:bg-white","disabled:bg-gray-300","bg-white","text-sm","font-medium","text-gray-700","hover:bg-gray-50",3,"click","disabled"],[1,"h-5","w-5","text-gray-500",3,"icon"],[1,"relative","inline-flex","items-center","px-2","py-2","rounded-r-md","border","border-gray-300","enabled:bg-white","disabled:bg-gray-300","text-sm","font-medium","text-gray-500","hover:bg-gray-50",3,"click","disabled"],[3,"toggleModal","loadAppointments","selected_appointment"]],template:function(o,s){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"span",2),e.EFF(3,"Referrals"),e.k0s()(),e.DNE(4,Dt,3,3,"div",3)(5,_e,3,0,"div",4)(6,Gt,5,1,"div",5)(7,Mt,16,4,"div",6),e.k0s(),e.DNE(8,Ut,1,1,"app-outcome-form",7)),2&o&&(e.R7$(4),e.Y8G("ngIf",s.show_form),e.R7$(),e.Y8G("ngIf",s.show_form&&0===s.todays_appointment.length),e.R7$(),e.Y8G("ngIf",!s.show_form&&!s.todays_appointment),e.R7$(),e.Y8G("ngIf",s.total>=1),e.R7$(),e.Y8G("ngIf",s.modals.outcome))},dependencies:[x.Sq,x.bT,w.aY,tt,x.vh,x.lG],encapsulation:2})}}return a})();var Yt=b(8793),rt=b(7673),Bt=b(5964),st=b(3294),re=b(152),ot=b(8141),Ht=b(5558),zt=b(9437),Fe=b(6354),ue=b(8761);const Vt=(a,u)=>u.icd10_code,qt=a=>({"text-red-500":a});function Jt(a,u){if(1&a&&(e.j41(0,"div",57)(1,"h5",58)(2,"strong"),e.EFF(3),e.k0s(),e.EFF(4),e.k0s()()),2&a){const n=u.item,o=u.searchTerm;e.R7$(),e.Y8G("ngOptionHighlight",o),e.R7$(2),e.SpI("",n.icd10_code,":"),e.R7$(),e.SpI(" ",n.icd10_desc,"")}}function Wt(a,u){if(1&a&&(e.j41(0,"span",60),e.EFF(1),e.nrm(2,"br"),e.k0s()),2&a){const n=u.$implicit;e.R7$(),e.SpI(" ",n.icd10_code+" | "+n.lib_icd10.icd10_desc," ")}}function Te(a,u){if(1&a&&(e.j41(0,"td",59),e.Z7z(1,Wt,3,1,"span",60,Vt),e.k0s(),e.j41(3,"td",33)(4,"span",60),e.EFF(5),e.nI1(6,"date"),e.nrm(7,"br"),e.k0s()()),2&a){const n=e.XpG().$implicit,o=e.XpG();e.R7$(),e.Dyx(n.final_diagnosis.finaldx),e.R7$(4),e.SpI(" ",e.i5U(6,1,o.consult.prev_date,"MM/dd/yyyy")," ")}}function Kt(a,u){if(1&a&&(e.j41(0,"tbody"),e.DNE(1,Te,8,4),e.k0s()),2&a){const n=u.$implicit;e.R7$(),e.vxM((null==n.final_diagnosis?null:n.final_diagnosis.finaldx.length)>=1?1:-1)}}function Qt(a,u){if(1&a&&(e.j41(0,"div",61),e.EFF(1),e.k0s()),2&a){let n;const o=u.$implicit;e.R7$(),e.SpI(" ",null!==(n=o.lib_complaints.complaint_desc)&&void 0!==n?n:"-"," ")}}function Zt(a,u){if(1&a&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&a){const n=u.$implicit,o=u.last;e.R7$(),e.Lme("",n,"",o?"":", ","")}}function en(a,u){if(1&a&&(e.j41(0,"div")(1,"span",62),e.EFF(2),e.k0s(),e.DNE(3,Zt,2,2,"span",34),e.nrm(4,"br"),e.j41(5,"span"),e.EFF(6),e.k0s(),e.nrm(7,"br"),e.k0s()),2&a){const n=u.$implicit,o=e.XpG();e.R7$(2),e.SpI("",n.category_id,":"),e.R7$(),e.Y8G("ngForOf",o.pe_array[n.category_id]),e.R7$(3),e.SpI("Remarks: ",null==o.data.consult_notes||null==o.data.consult_notes.physical_exam_remarks?null:o.data.consult_notes.physical_exam_remarks[n.remarks_var],"")}}function tn(a,u){if(1&a&&(e.j41(0,"div",63)(1,"h3",50)(2,"span",41),e.EFF(3," Diagnosis: "),e.k0s(),e.j41(4,"span"),e.EFF(5),e.k0s()()()),2&a){let n;const o=u.$implicit;e.R7$(5),e.SpI(" ",null!==(n=o.diagnosis.class_name)&&void 0!==n?n:"-"," ")}}function ee(a,u){if(1&a&&(e.j41(0,"div",63)(1,"h3",50)(2,"span",41),e.EFF(3," Procedure: "),e.k0s(),e.j41(4,"span"),e.EFF(5),e.k0s(),e.nrm(6,"br"),e.j41(7,"span",41),e.EFF(8," Operation Date: "),e.k0s(),e.j41(9,"span"),e.EFF(10),e.nI1(11,"date"),e.k0s()()()),2&a){let n,o;const s=u.$implicit;e.R7$(5),e.SpI(" ",null!==(n=s.operation)&&void 0!==n?n:"-"," "),e.R7$(5),e.SpI(" ",e.i5U(11,2,s.operation_date,null!==(o="MM/dd/yyyy")&&void 0!==o?o:"-")," ")}}function at(a,u){if(1&a&&(e.j41(0,"div",64)(1,"span",65),e.EFF(2),e.k0s(),e.nrm(3,"br"),e.EFF(4),e.nrm(5,"br"),e.j41(6,"span",41),e.EFF(7," Dose Regimen: "),e.k0s(),e.EFF(8),e.nrm(9,"br"),e.j41(10,"span",41),e.EFF(11," Duration Intake: "),e.k0s(),e.EFF(12),e.nrm(13,"br"),e.j41(14,"span",41),e.EFF(15," Prescribed Quantity: "),e.k0s(),e.EFF(16),e.nrm(17,"br"),e.k0s()),2&a){let n,o,s,d;const h=u.$implicit;e.R7$(2),e.SpI("",null!==(n=null!==(n=null!==(n=null==h.konsulta_medicine?null:h.konsulta_medicine.desc)&&void 0!==n?n:null==h.medicine?null:h.medicine.gen_name)&&void 0!==n?n:h.added_medicine)&&void 0!==n?n:""," "),e.R7$(2),e.Lme(" ",null!==(o=null==h.medicine?null:h.medicine.form_desc)&&void 0!==o?o:" "," ",null!==(o=null==h.medicine?null:h.medicine.stre_desc)&&void 0!==o?o:" ",""),e.R7$(4),e.SpI(" ",null!==(s=null==h.dose_regimen?null:h.dose_regimen.desc)&&void 0!==s?s:" "," "),e.R7$(4),e.Lme(" ",h.duration_intake," ",null==h.duration_frequency?null:h.duration_frequency.desc," (s) "),e.R7$(4),e.Lme(" ",null!==(d=h.quantity)&&void 0!==d?d:" "," ",null!==(d=null==h.medicine?null:h.medicine.form_desc)&&void 0!==d?d:" "," ")}}let se=(()=>{class a{closeModal(){this.toggleModal.emit()}constructor(n,o,s){this.http=n,this.ageService=o,this.toastr=s,this.toggleModal=new e.bkB,this.faAnglesRight=k.up_,this.faAnglesLeft=k.rNr,this.faCircleXmark=k.bnw,this.faSearch=k.MjD,this.searchInput$=new A.B,this.minLengthTerm=3,this.fdxLoading=!1,this.show_form=!1,this.icd10=[],this.is_saving=!1,this.peCatArray=[{category_id:"ABDOMEN",remarks_var:"abdomen_remarks"},{category_id:"BARTHOLINS",remarks_var:"bartholins_remarks"},{category_id:"BREAST",remarks_var:"breast_remarks"},{category_id:"CHEST",remarks_var:"chest_remarks"},{category_id:"CONJUNCTIVA",remarks_var:"conjunctiva_remarks"},{category_id:"EXTREMITIES",remarks_var:"extremities_remarks"},{category_id:"GENITOURINARY",remarks_var:"genitourinary_remarks"},{category_id:"HEART",remarks_var:"heart_remarks"},{category_id:"HEENT",remarks_var:"heent_remarks"},{category_id:"NECK",remarks_var:"neck_remarks"},{category_id:"NEURO",remarks_var:"neuro_remarks"},{category_id:"PELVIC",remarks_var:"pelvic_remarks"},{category_id:"RECTAL",remarks_var:"rectal_remarks"},{category_id:"SKIN",remarks_var:"skin_remarks"},{category_id:"SPECULUM",remarks_var:"speculum_remarks"},{category_id:"THORAX",remarks_var:"thorax_remarks"}]}getAge(){if(this.data&&this.data.patient.birthdate){let n=this.ageService.calcuateAge(this.data.patient.birthdate);return this.patient_age=n,n.age}}loadFdx(n){this.fdx$=(0,Yt.x)((0,rt.of)(n),this.searchInput$.pipe((0,Bt.p)(o=>null!==o&&o.length>=this.minLengthTerm),(0,st.F)(),(0,re.B)(800),(0,ot.M)(()=>this.fdxLoading=!0),(0,Ht.n)(o=>this.getFdx(o).pipe((0,zt.W)(()=>(0,rt.of)([])),(0,ot.M)(()=>this.fdxLoading=!1)))))}getFdx(n=null){return this.http.get("libraries/icd10",{params:{"filter[search]":n}}).pipe((0,Fe.T)(o=>o.data))}loadSelected(){let n=[],o=[];this.final_dx&&Object.keys(this.final_dx).length>0?(Object.entries(this.final_dx).forEach(([s,d],h)=>{let D=d;n.push(D.icd10_code.toString()),o.push(D.lib_icd10)}),this.loadFdx(o),this.selectedFdx=n):this.loadFdx([])}onSubmit(){console.log(this.fdxremarks2,"reamrks"),this.is_saving=!0,this.selectedFdx&&Object.keys(this.selectedFdx).length>0?this.http.post("consultation/final-diagnosis",{notes_id:this.notes_id,final_diagnosis:this.selectedFdx}).subscribe({next:o=>{this.saveNotes()},error:o=>console.log(o)}):this.saveNotes()}saveNotes(){this.http.update("consultation/notes/",this.notes_id,{consult_id:this.consult_id,fdx_remarks:this.fdxremarks2}).subscribe({next:()=>{this.endVisit(),this.showToastr()},error:o=>console.log(o)})}endVisit(){this.http.update("consultation/records/",this.consult_id,{id:this.consult_id,consult_date:this.data.consult_date,patient_id:this.data.patient_id,pt_group:"cn",consult_done:"1"}).subscribe({next:()=>this.showToastr(),error:o=>console.log(o)})}showToastr(){this.is_saving=!1,this.toastr.success("Successfully updated!","Final Diagnosis")}iteratePE(){this.pe_array=[],this.data.consult_notes.physical_exam&&Object.entries(this.data.consult_notes.physical_exam).forEach(([n,o])=>{this.pe_array[o.lib_physical_exam.category_id]?this.pe_array[o.lib_physical_exam.category_id].push(o.lib_physical_exam.pe_desc):this.pe_array[o.lib_physical_exam.category_id]=[o.lib_physical_exam.pe_desc]}),console.log(this.pe_array)}ngOnInit(){this.data=this.show_patient_data.data[0],this.previous=this.show_patient_data.previous_diagnosis,this.notes_id=this.data.consult_notes.id,this.loadFdx([]),this.iteratePE(),console.log(this.previous,"previous ito"),console.log(this.data,"present ito")}static{this.\u0275fac=function(o){return new(o||a)(e.rXU(C.k),e.rXU(j.V),e.rXU(Qe.tw))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-final-dx"]],inputs:{show_patient_data:"show_patient_data",show_previous_dx:"show_previous_dx",pending_fdx:"pending_fdx",consult_id:"consult_id",consult_date:"consult_date"},outputs:{toggleModal:"toggleModal"},standalone:!1,decls:178,vars:48,consts:[["id","defaultModal","tabindex","-1","aria-modal","true","role","dialog",1,"overflow-x-auto","fixed","top-0","right-0","left-0","md:inset-0","h-modal","md:h-full","justify-center","items-center","flex","mx-auto",2,"z-index","60"],[1,"relative","p-4","w-full"],[1,"relative","bg-white","rounded-lg","shadow"],[1,"flex","justify-between","items-start","py-3","px-5","rounded-t","border-b","bg-blue-500"],[1,"mt-2","text-lg","text-white"],[1,"flex","justify-end"],[1,"border","border-gray-400","rounded-md","bg-white"],["type","button",1,"text-white","w-9","h-9",3,"click"],[1,"-mr-4",3,"icon"],[1,"h-[600px]","overflow-y-auto","scrollbar-thin","scrollbar-thumb-gray-400","scrollbar-track-gray-100"],[1,"relative","shadow-md","sm:rounded-lg","m-4"],[1,"w-full","text-sm","text-left","text-gray-500"],[1,"flex","justify-center","text-base","text-black","pb-2","px-5","rounded-t","border-black","border-t","border-b","border-r","border-l"],[1,"px-2"],[1,"text-left","w-full"],[1,"flex","text-right","w-full"],[1,"flex","justify-between","items-start","mt-2","py-2","px-5","rounded-t","border-b","bg-red-500"],[1,"text-lg","text-white"],[1,"flex"],[1,"border","rounded-md","px-5","w-full","py-1"],[1,"chips-container"],["placeholder","search final diagnosis","typeToSearchText","search...","bindValue","icd10_code","bindLabel","icd10_desc","notFoundText","No records found",1,"select-chips",3,"ngModelChange","items","multiple","loading","typeahead","ngModel"],["ng-option-tmp",""],["type","text","placeholder","Final Diagnosis Remarks",1,"shadow-md","form-input","text-sm","p-2","px-2","my-5","w-full","rounded","border-0","-outline-offset-8",3,"ngModelChange","ngModel"],[1,"flex","justify-end","py-4","px-5","space-x-4","rounded-b","border-t","border-gray-200","items-center"],["type","button",1,"text-white","bg-blue-500","hover:ring-2","focus:outline-none","hover:ring-red-300","rounded","text-sm","font-medium","px-6","py-2.5","transition","duration-150","ease-in-out","transform","hover:scale-110",3,"click"],[1,"shadow-md","-outline-offset-8"],[1,"border-b","rounded-t","bg-blue-500","mt-2","py-2","px-5"],[1,"mt-2","text-kg","text-white","font-bold"],[1,"w-full","table-auto","text-sm","text-black"],[1,"text-s","text-black","bg-white","-webkit-sticky","border-b",2,"z-index","20","position","sticky","top","0"],[1,"w-full"],[1,"px-5","py-2","w-1/2","text-center"],[1,"w-1/2","text-center"],[4,"ngFor","ngForOf"],[1,"grid","grid-cols-2","justify-between"],[1,"grid","col-span-1","mt-5","py-2","px-5","rounded-t","border-b","bg-gray-50"],[1,"mt-2","text-lg","text-gray-500","font-bold"],[1,"shadow-md","grid","border","w-full","border-1","-outline-offset-8"],[1,"flex","text-gray-700","md:block","leading-tight","align-top","my-1","w-full","p-1","rounded-md"],[1,"text-base","text-black","py-3","px-5","rounded-t"],[1,"font-bold"],[3,"ngClass"],[1,"flex","flex-col","mt-5","py-2","px-5","rounded-t","border-b","bg-gray-50"],[1,"shadow-md","flex","flex-col","border","w-full","border-1"],["class","pl-2 flex font-bold text-base text-gray-700 md:block leading-tight align-top my-1 w-full p-1 rounded-md",4,"ngFor","ngForOf"],[1,"border-b","rounded-t","bg-purple-600","mt-2","py-2","px-5"],[1,"mt-2","text-lg","text-white","font-bold"],[1,"px-5","py-2","w-1/2","text-left","text-black"],["class","pl-2 flex text-gray-700 md:block leading-tight align-top my-1 w-full p-1 rounded-md",4,"ngFor","ngForOf"],[1,"text-base","text-black","py-3","px-3","rounded-t"],[1,"border-b","rounded-t","bg-orange-600","mt-2","py-2","px-5"],["class","text-black py-2 px-5",4,"ngFor","ngForOf"],[1,"flex","justify-between","py-4","px-5","space-x-4","rounded-b","border-t","border-gray-200","items-center"],["type","button",1,"text-white","bg-red-500","hover:ring-2","focus:outline-none","hover:ring-red-300","rounded","text-sm","font-medium","px-6","py-2.5","transition","duration-150","ease-in-out","transform","hover:scale-110",3,"click"],[1,"flex","items-center","space-x-4"],[1,"opacity-50","fixed","inset-0","z-50","bg-black"],[1,"whitespace-normal"],[1,"text-gray-700",3,"ngOptionHighlight"],["colspan","1",1,"px-5","py-2"],[1,"text-black","bg-white","-webkit-sticky","font-bold"],[1,"pl-2","flex","font-bold","text-base","text-gray-700","md:block","leading-tight","align-top","my-1","w-full","p-1","rounded-md"],[1,"font-semibold","mr-2"],[1,"pl-2","flex","text-gray-700","md:block","leading-tight","align-top","my-1","w-full","p-1","rounded-md"],[1,"text-black","py-2","px-5"],[1,"font-bold","text-sm"]],template:function(o,s){if(1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),e.EFF(5),e.k0s(),e.j41(6,"div",5),e.nrm(7,"div",6),e.j41(8,"button",7),e.bIt("click",function(){return s.closeModal()}),e.nrm(9,"fa-icon",8),e.k0s()()(),e.j41(10,"div",9)(11,"div",10)(12,"div",11)(13,"fieldset",12)(14,"legend",13),e.EFF(15,"Patient Information"),e.k0s(),e.j41(16,"div",14)(17,"label"),e.EFF(18),e.k0s(),e.nrm(19,"br"),e.j41(20,"label"),e.EFF(21),e.nI1(22,"date"),e.k0s(),e.nrm(23,"br"),e.j41(24,"label"),e.EFF(25),e.k0s()(),e.j41(26,"div",15)(27,"label"),e.EFF(28),e.k0s()()(),e.j41(29,"div",16)(30,"h3",17),e.EFF(31," Final Diagnosis "),e.k0s()(),e.j41(32,"div",18)(33,"div",19)(34,"div",20)(35,"ng-select",21),e.nI1(36,"async"),e.mxI("ngModelChange",function(h){return e.DH7(s.selectedFdx,h)||(s.selectedFdx=h),h}),e.DNE(37,Jt,5,3,"ng-template",22),e.k0s()(),e.j41(38,"input",23),e.mxI("ngModelChange",function(h){return e.DH7(s.fdxremarks2,h)||(s.fdxremarks2=h),h}),e.k0s(),e.j41(39,"div",24)(40,"button",25),e.bIt("click",function(){return s.onSubmit()}),e.EFF(41," Save "),e.k0s()(),e.j41(42,"div",26)(43,"div",27)(44,"h3",28),e.EFF(45," Previous Diagnosis "),e.k0s()(),e.j41(46,"table",29)(47,"thead",30)(48,"tr",31)(49,"th",32),e.EFF(50," ICD 10 Code | Description "),e.k0s(),e.j41(51,"th",33),e.EFF(52," Date "),e.k0s()()(),e.DNE(53,Kt,2,1,"tbody",34),e.k0s()()()(),e.j41(54,"div",35)(55,"div",36)(56,"h3",37),e.EFF(57," Vitals Signs "),e.k0s(),e.j41(58,"div",38)(59,"div",39)(60,"fieldset",40)(61,"label")(62,"span",41),e.EFF(63," Weight: "),e.k0s(),e.EFF(64),e.k0s(),e.j41(65,"span"),e.EFF(66," kg"),e.k0s(),e.nrm(67,"br"),e.j41(68,"label")(69,"span",41),e.EFF(70," Height: "),e.k0s(),e.EFF(71),e.k0s(),e.j41(72,"span"),e.EFF(73," cm"),e.k0s(),e.nrm(74,"br"),e.j41(75,"label")(76,"span",41),e.EFF(77," BMI: "),e.k0s(),e.EFF(78),e.k0s(),e.nrm(79,"br"),e.j41(80,"label")(81,"span",41),e.EFF(82," Blood Pressure: "),e.k0s(),e.EFF(83),e.k0s(),e.nrm(84,"br"),e.j41(85,"label")(86,"span",41),e.EFF(87," Blood Oxygen (SPO2): "),e.k0s(),e.EFF(88),e.k0s(),e.nrm(89,"br"),e.j41(90,"label",42)(91,"span",41),e.EFF(92," Temperature: "),e.k0s(),e.EFF(93),e.k0s(),e.j41(94,"span"),e.EFF(95," \u2103"),e.k0s(),e.nrm(96,"br"),e.j41(97,"label")(98,"span",41),e.EFF(99," Heart Rate: "),e.k0s(),e.EFF(100),e.k0s(),e.nrm(101,"br"),e.j41(102,"label")(103,"span",41),e.EFF(104," Respiratory Rate: "),e.k0s(),e.EFF(105),e.k0s(),e.nrm(106,"br"),e.j41(107,"label")(108,"span",41),e.EFF(109," Pulse Rate: "),e.k0s(),e.EFF(110),e.k0s(),e.nrm(111,"br"),e.j41(112,"label")(113,"span",41),e.EFF(114," Visual Acuity (Right): "),e.k0s(),e.EFF(115),e.k0s(),e.nrm(116,"br"),e.j41(117,"label")(118,"span",41),e.EFF(119," Visual Acuity (Left): "),e.k0s(),e.EFF(120),e.k0s(),e.nrm(121,"br"),e.j41(122,"label")(123,"span",41),e.EFF(124," Waist: "),e.k0s(),e.EFF(125),e.k0s(),e.nrm(126,"br"),e.j41(127,"label")(128,"span",41),e.EFF(129," Hip: "),e.k0s(),e.EFF(130),e.k0s(),e.nrm(131,"br"),e.k0s()()()(),e.j41(132,"div",43)(133,"span",37),e.EFF(134," Chief Complaint "),e.k0s(),e.j41(135,"div",44),e.DNE(136,Qt,2,1,"div",45),e.j41(137,"h3",40),e.EFF(138),e.k0s()()()(),e.j41(139,"div",43)(140,"div",46)(141,"h3",47),e.EFF(142," History of Current Illness "),e.k0s()(),e.j41(143,"div")(144,"tr",31)(145,"th",48),e.EFF(146),e.k0s()()()(),e.j41(147,"div",35)(148,"div",36)(149,"h3",37),e.EFF(150," Physical Exam "),e.k0s(),e.j41(151,"div",38)(152,"div",39)(153,"fieldset",40),e.DNE(154,en,8,3,"div",34),e.k0s()()()(),e.j41(155,"div",43)(156,"span",37),e.EFF(157," Initial Diagnosis "),e.k0s(),e.j41(158,"div",44),e.DNE(159,tn,6,1,"div",49),e.j41(160,"h3",50)(161,"span",41),e.EFF(162," Remarks: "),e.k0s(),e.EFF(163),e.k0s()(),e.j41(164,"span",37),e.EFF(165," Surgical History "),e.k0s(),e.j41(166,"div",44),e.DNE(167,ee,12,5,"div",49),e.k0s()()(),e.j41(168,"div",43)(169,"div",51)(170,"h3",47),e.EFF(171," Drugs Prescribed "),e.k0s()(),e.DNE(172,at,18,8,"div",52),e.k0s()()()(),e.j41(173,"div",53)(174,"button",54),e.bIt("click",function(){return s.closeModal()}),e.EFF(175,"Close"),e.k0s(),e.nrm(176,"div",55),e.k0s()()()(),e.nrm(177,"div",56)),2&o){let d,h,D,B,te,pe,ae,je,be,Ee,Ie,Pe,Ae,Oe,Ne,$e,Le,De,ye;e.R7$(5),e.SpI(" Consult ID: ",s.consult_id," "),e.R7$(4),e.Y8G("icon",s.faCircleXmark),e.R7$(9),e.E5c("Name: ",s.data.patient.first_name," ",s.data.patient.middle_name," ",s.data.patient.last_name," "),e.R7$(3),e.Lme("Birthdate: ",e.i5U(22,41,s.data.patient.birthdate,"MM/dd/yyyy")," | ",s.getAge()," years old"),e.R7$(4),e.Lme("Address: ",s.data.patient.household_folder.address,", ",s.data.patient.household_folder.barangay.name," "),e.R7$(3),e.SpI("Consult Date: ",s.consult_date,""),e.R7$(7),e.Y8G("items",e.bMT(36,44,s.fdx$))("multiple",!0)("loading",s.fdxLoading)("typeahead",s.searchInput$),e.R50("ngModel",s.selectedFdx),e.R7$(3),e.R50("ngModel",s.fdxremarks2),e.R7$(15),e.Y8G("ngForOf",s.previous),e.R7$(11),e.SpI(" ",null!==(d=null==s.data||null==s.data.vitals_latest?null:s.data.vitals_latest.patient_weight)&&void 0!==d?d:"-"," "),e.R7$(7),e.SpI(" ",null!==(h=null==s.data||null==s.data.vitals_latest?null:s.data.vitals_latest.patient_height)&&void 0!==h?h:"-"," "),e.R7$(7),e.Lme(" ",null!==(D=null==s.data||null==s.data.vitals_latest?null:s.data.vitals_latest.patient_bmi)&&void 0!==D?D:"-"," (",null!==(D=null==s.data||null==s.data.vitals_latest?null:s.data.vitals_latest.patient_bmi_class)&&void 0!==D?D:"-",") "),e.R7$(5),e.Lme(" ",null!==(B=null==s.data.vitals_latest?null:s.data.vitals_latest.bp_systolic)&&void 0!==B?B:"-","/",null!==(B=null==s.data.vitals_latest?null:s.data.vitals_latest.bp_diastolic)&&void 0!==B?B:"-"," "),e.R7$(5),e.SpI(" ",null!==(te=null==s.data||null==s.data.vitals_latest?null:s.data.vitals_latest.patient_spo2)&&void 0!==te?te:"-"," "),e.R7$(2),e.Y8G("ngClass",e.eq3(46,qt,(null==s.data||null==s.data.vitals_latest?null:s.data.vitals_latest.patient_temp)>=38)),e.R7$(3),e.SpI(" ",null!==(pe=null==s.data||null==s.data.vitals_latest?null:s.data.vitals_latest.patient_temp)&&void 0!==pe?pe:"-"," "),e.R7$(7),e.SpI(" ",null!==(ae=null==s.data||null==s.data.vitals_latest?null:s.data.vitals_latest.patient_heart_rate)&&void 0!==ae?ae:"-"," "),e.R7$(5),e.SpI(" ",null!==(je=null==s.data||null==s.data.vitals_latest?null:s.data.vitals_latest.patient_respiratory_rate)&&void 0!==je?je:"-"," "),e.R7$(5),e.SpI(" ",null!==(be=null==s.data||null==s.data.vitals_latest?null:s.data.vitals_latest.patient_pulse_rate)&&void 0!==be?be:"-"," "),e.R7$(5),e.SpI(" ",null!==(Ee=null==s.data||null==s.data.vitals_latest?null:s.data.vitals_latest.patient_right_vision_acuity)&&void 0!==Ee?Ee:"-"," "),e.R7$(5),e.SpI(" ",null!==(Ie=null==s.data||null==s.data.vitals_latest?null:s.data.vitals_latest.patient_left_vision_acuity)&&void 0!==Ie?Ie:"-"," "),e.R7$(5),e.SpI(" ",null!==(Pe=null==s.data||null==s.data.vitals_latest?null:s.data.vitals_latest.patient_waist)&&void 0!==Pe?Pe:"-"," "),e.R7$(5),e.SpI(" ",null!==(Ae=null==s.data||null==s.data.vitals_latest?null:s.data.vitals_latest.patient_hip)&&void 0!==Ae?Ae:"-"," "),e.R7$(6),e.Y8G("ngForOf",null!==(Oe=null==s.data?null:s.data.consult_notes.complaints)&&void 0!==Oe?Oe:"-"),e.R7$(2),e.SpI(" Remarks: ",null!==(Ne=null==s.data?null:s.data.consult_notes.complaint)&&void 0!==Ne?Ne:"-"," "),e.R7$(8),e.SpI(" ",null!==($e=null==s.data?null:s.data.consult_notes.history)&&void 0!==$e?$e:"-"," "),e.R7$(8),e.Y8G("ngForOf",s.peCatArray),e.R7$(5),e.Y8G("ngForOf",null!==(Le=null==s.data?null:s.data.consult_notes.initialdx)&&void 0!==Le?Le:"-"),e.R7$(4),e.SpI(" ",null!==(De=null==s.data?null:s.data.consult_notes.idx_remarks)&&void 0!==De?De:"-"," "),e.R7$(4),e.Y8G("ngForOf",null!==(ye=null==s.data?null:s.data.surgical_history)&&void 0!==ye?ye:"-"),e.R7$(5),e.Y8G("ngForOf",null==s.data?null:s.data.prescription)}},dependencies:[x.YU,x.Sq,w.aY,P.me,P.BC,P.vS,ue.vr,ue.Uq,x.Jj,x.vh],encapsulation:2})}}return a})();function Se(a,u){if(1&a&&(e.j41(0,"option",20),e.EFF(1),e.k0s()),2&a){const n=u.$implicit;e.Y8G("value",n.id),e.R7$(),e.E5c("",n.last_name,", ",n.first_name," ",n.middle_name,"")}}function nn(a,u){if(1&a){const n=e.RV6();e.j41(0,"div",30)(1,"div",23)(2,"div",24)(3,"span",31),e.bIt("click",function(){const s=e.eBV(n).$implicit,d=e.XpG(2);return e.Njj(d.getData(s.patient_id,s.consult_date,s.consult_id))}),e.EFF(4),e.k0s()()(),e.j41(5,"div",32)(6,"div",33)(7,"span",34),e.EFF(8),e.k0s()()(),e.j41(9,"div",32)(10,"div",33)(11,"span",35),e.EFF(12),e.k0s()()(),e.j41(13,"div",36)(14,"div",33)(15,"span",34),e.EFF(16),e.k0s()()(),e.j41(17,"div",36)(18,"div",33)(19,"span",34),e.EFF(20),e.k0s()()()()}if(2&a){const n=u.$implicit;e.R7$(4),e.SpI(" ",n.patient_name," "),e.R7$(4),e.SpI(" ",n.consult_date," "),e.R7$(4),e.SpI(" ",n.is_konsulta," "),e.R7$(4),e.SpI(" ",n.physician_name?n.physician_name:"-"," "),e.R7$(4),e.SpI(" ",n.enocder_name?n.enocder_name:"-"," ")}}function rn(a,u){1&a&&(e.j41(0,"div",37)(1,"span",38),e.EFF(2,"No records found..."),e.k0s()())}function sn(a,u){if(1&a&&(e.j41(0,"div",21)(1,"div",22)(2,"div",23)(3,"div",24)(4,"span",25),e.EFF(5," Name "),e.k0s()()(),e.j41(6,"div",26)(7,"div",24)(8,"span",25),e.EFF(9," Consult date "),e.k0s()()(),e.j41(10,"div",26)(11,"div",24)(12,"span",25),e.EFF(13," For Konsulta "),e.k0s()()(),e.j41(14,"div",27)(15,"div",24)(16,"span",25),e.EFF(17," Referred to "),e.k0s()()(),e.j41(18,"div",27)(19,"div",24)(20,"span",25),e.EFF(21," Logged by "),e.k0s()()()(),e.DNE(22,nn,21,5,"div",28)(23,rn,3,0,"div",29),e.k0s()),2&a){const n=e.XpG();e.R7$(22),e.Y8G("ngForOf",n.pending_fdx),e.R7$(),e.Y8G("ngIf",0===n.pending_fdx.length)}}function on(a,u){1&a&&(e.j41(0,"div",39)(1,"div",40),e.EFF(2," No record to show "),e.k0s()())}function Re(a,u){if(1&a&&(e.j41(0,"div",41)(1,"div",40),e.nrm(2,"fa-icon",42),e.k0s()()),2&a){const n=e.XpG();e.R7$(2),e.Y8G("icon",n.faCircleNotch)}}function an(a,u){if(1&a){const n=e.RV6();e.j41(0,"div")(1,"nav",47)(2,"button",48),e.bIt("click",function(){e.eBV(n);const s=e.XpG(2);return e.Njj(s.getPatient(s.Number(1)))}),e.nrm(3,"fa-icon",49),e.k0s(),e.j41(4,"button",50),e.bIt("click",function(){e.eBV(n);const s=e.XpG(2);return e.Njj(s.getPatient(s.Number(s.current_page-1)))}),e.nrm(5,"fa-icon",49),e.EFF(6,"Previous "),e.k0s(),e.j41(7,"button",50),e.bIt("click",function(){e.eBV(n);const s=e.XpG(2);return e.Njj(s.getPatient(s.Number(s.current_page+1)))}),e.EFF(8," Next"),e.nrm(9,"fa-icon",51),e.k0s(),e.j41(10,"button",52),e.bIt("click",function(){e.eBV(n);const s=e.XpG(2);return e.Njj(s.getPatient(s.Number(s.last_page)))}),e.nrm(11,"fa-icon",51),e.k0s()()()}if(2&a){const n=e.XpG(2);e.R7$(2),e.Y8G("disabled",1===n.current_page),e.R7$(),e.Y8G("icon",n.faAnglesLeft),e.R7$(),e.Y8G("disabled",1===n.current_page),e.R7$(),e.Y8G("icon",n.faChevronLeft),e.R7$(2),e.Y8G("disabled",n.current_page===n.last_page),e.R7$(2),e.Y8G("icon",n.faChevronRight),e.R7$(),e.Y8G("disabled",n.current_page===n.last_page),e.R7$(),e.Y8G("icon",n.faAnglesRight)}}function ln(a,u){if(1&a&&(e.j41(0,"div")(1,"div",43)(2,"div",44)(3,"div")(4,"p",45),e.EFF(5," Showing "),e.j41(6,"span",46),e.EFF(7),e.k0s(),e.EFF(8," to "),e.j41(9,"span",46),e.EFF(10),e.k0s(),e.EFF(11," of "),e.j41(12,"span",46),e.EFF(13),e.k0s(),e.EFF(14," results "),e.k0s()(),e.DNE(15,an,12,8,"div",18),e.k0s()()()),2&a){const n=e.XpG();e.R7$(7),e.JRh(n.from),e.R7$(3),e.JRh(n.to),e.R7$(3),e.JRh(n.total),e.R7$(2),e.Y8G("ngIf",n.total>=6)}}function lt(a,u){if(1&a){const n=e.RV6();e.j41(0,"app-final-dx",53),e.bIt("toggleModal",function(){e.eBV(n);const s=e.XpG();return e.Njj(s.toggleModal())}),e.k0s()}if(2&a){const n=e.XpG();e.Y8G("show_patient_data",n.show_patient_data)("pending_fdx",n.pending_fdx)("consult_id",n.consult_id)("consult_date",n.fdx_consult_date)}}let ve=(()=>{class a{constructor(n){this.http=n,this.faCircleNotch=k.s4k,this.faAnglesLeft=k.rNr,this.faChevronLeft=k.Wzs,this.faChevronRight=k.XkK,this.faAnglesRight=k.up_,this.show_patient_data=[],this.show_form=!1,this.show_data=[],this.selected_physician="all",this.is_konsulta="",this.per_page=5,this.current_page=1,this.isLoading=!1,this.openList=!1,this.faSearch=k.MjD,this.Number=Number,this.faStethoscope=k.jrv}toggleModal(){this.show_data=[],this.openList=!this.openList,console.log(this.openList),this.openList||this.getPatient()}getPatient(n){this.isLoading=!0,this.show_form=!1;let o={params:{}};o.params.page=n||this.current_page,"all"!==this.selected_physician&&(o.params.physician_id=this.selected_physician),o.params.is_konsulta=this.is_konsulta,console.log(o),this.patient_search&&(o.params.search=this.patient_search),this.http.get("reports-2018/pending-fdx/report",o).subscribe({next:s=>{this.pending_fdx=s.data,this.current_page=s.meta.current_page,this.last_page=s.meta.last_page,this.from=s.meta.from,this.to=s.meta.to,this.total=s.meta.total,this.isLoading=!1,this.show_form=!0},error:s=>console.log(s)})}getData(n,o,s){this.http.get("reports-2018/pending-fdx/get-consultation",{params:{patient_id:n,consult_id:s}}).subscribe({next:h=>{this.show_patient_data=h,this.show_previous_dx=h,this.current_page=h.current_page,this.last_page=h.last_page,this.openList=!0,this.fdx_consult_date=o,this.consult_id=s},error:h=>console.log(h)})}loadPhysicians(){return new Promise((n,o)=>{this.http.get("users",{params:{per_page:"all",designation_code:"MD"}}).subscribe({next:s=>{this.physicians=s.data;let d=this.http.getUserFromJSON();this.selected_physician="MD"===d.designation_code?d.id:"all",n()},error:s=>{console.log(s),o(s)}})})}ngOnInit(){this.loadPhysicians(),this.current_page=1,this.getPatient()}static{this.\u0275fac=function(o){return new(o||a)(e.rXU(C.k))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-pending-fdx"]],inputs:{get_patient_data:"get_patient_data"},standalone:!1,decls:25,vars:10,consts:[[1,"mb-10","text-gray-600","h-100","border","border-slate-200","shadow-md","rounded-md"],[1,"md:flex","md:justify-between","md:items-center","pb-2","bg-blue-500","text-white","rounded-t-md"],[1,"font-semibold","pt-2","pl-5"],[1,"rounded-md","flex","items-center","m-2"],[1,"w-full","bg-white","rounded-md","flex","justify-between","mr-3"],["type","text","placeholder","Search Patient",1,"input","text-sm","text-gray-700","border-0","pt-0",3,"ngModelChange","keyup.enter","ngModel"],["type","button",1,"text-blue-500","border-gray-400","pr-2",3,"click"],[1,"-ml-1",3,"icon"],[1,"input","px-2","pt-0.5","mr-3","disabled:bg-gray-200","w-40","text-gray-800",3,"change","ngModelChange","ngModel"],["value",""],["value","1"],["value","0"],[1,"input","px-2","pt-0.5","mr-3","disabled:bg-red-600","w-72","text-gray-800",3,"change","ngModelChange","ngModel"],["value","all"],["class","pr-",3,"value",4,"ngFor","ngForOf"],["class","p-3",4,"ngIf"],["class","-pt-3",4,"ngIf"],["class","pt-3",4,"ngIf"],[4,"ngIf"],[3,"show_patient_data","pending_fdx","consult_id","consult_date","toggleModal",4,"ngIf"],[1,"pr-",3,"value"],[1,"p-3"],[1,"flex","justify-between","border-b","border-gray-100","bg-gray-200"],[1,"flex","w-4/12"],[1,"flex","justify-center","text-gray-700","md:block","leading-tight","align-top","my-1","w-full","p-1","rounded-md"],[1,"w-full","font-semibold","my-0","rounded-md","py-2","px-3","text-center","text-xs"],[1,"flex","w-1/12"],[1,"flex","w-3/12"],["class","flex justify-between border-b border-gray-100",4,"ngFor","ngForOf"],["class","w-full flex justify-center my-5",4,"ngIf"],[1,"flex","justify-between","border-b","border-gray-100"],[1,"w-full","font-medium","my-0","text-sm","rounded-md","py-2","px-3","hover:cursor-pointer","hover:bg-blue-500","hover:text-white",3,"click"],[1,"grid","grid-cols-5","text-left","w-1/12"],[1,"col-span-12","text-gray-700","p-3","rounded-md","text-[.85em]"],[1,"w-full","font-medium","my-0","text-sm"],[1,"w-full","font-medium","my-0","text-sm","text-center"],[1,"grid","grid-cols-5","text-left","w-3/12"],[1,"w-full","flex","justify-center","my-5"],[1,"italic"],[1,"-pt-3"],[1,"text-center","items-center","mb-3","italic"],[1,"pt-3"],["animation","spin",1,"text-blue-500",3,"icon"],[1,"bg-white","px-4","py-3","flex","items-center","justify-between","border-t","border-gray-200","sm:px-6","rounded-b-md"],[1,"hidden","sm:flex-1","sm:flex","sm:items-center","sm:justify-between"],[1,"text-sm","text-gray-700"],[1,"font-medium"],["aria-label","Pagination",1,"relative","z-0","inline-flex","shadow-sm","-space-x-px"],[1,"relative","inline-flex","items-center","px-2","py-2","rounded-l-md","border","border-gray-300","enabled:bg-white","disabled:bg-gray-300","text-sm","font-medium","text-gray-500","hover:bg-gray-50",3,"click","disabled"],[1,"block","h-15","w-15","text-gray-500","pr-1",3,"icon"],[1,"relative","inline-flex","items-center","px-4","py-2","border","border-gray-300","enabled:bg-white","disabled:bg-gray-300","bg-white","text-sm","font-medium","text-gray-700","hover:bg-gray-50",3,"click","disabled"],[1,"h-5","w-5","text-gray-500",3,"icon"],[1,"relative","inline-flex","items-center","px-2","py-2","rounded-r-md","border","border-gray-300","enabled:bg-white","disabled:bg-gray-300","text-sm","font-medium","text-gray-500","hover:bg-gray-50",3,"click","disabled"],[3,"toggleModal","show_patient_data","pending_fdx","consult_id","consult_date"]],template:function(o,s){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"span",2),e.EFF(3,"Pending Final Diagnosis"),e.k0s(),e.j41(4,"div",3)(5,"div",4)(6,"input",5),e.mxI("ngModelChange",function(h){return e.DH7(s.patient_search,h)||(s.patient_search=h),h}),e.bIt("keyup.enter",function(){return s.getPatient()}),e.k0s(),e.j41(7,"button",6),e.bIt("click",function(){return s.getPatient()}),e.nrm(8,"fa-icon",7),e.k0s()(),e.j41(9,"select",8),e.bIt("change",function(){return s.getPatient()}),e.mxI("ngModelChange",function(h){return e.DH7(s.is_konsulta,h)||(s.is_konsulta=h),h}),e.j41(10,"option",9),e.EFF(11,"All"),e.k0s(),e.j41(12,"option",10),e.EFF(13,"Yes"),e.k0s(),e.j41(14,"option",11),e.EFF(15,"No"),e.k0s()(),e.j41(16,"select",12),e.bIt("change",function(){return s.getPatient()}),e.mxI("ngModelChange",function(h){return e.DH7(s.selected_physician,h)||(s.selected_physician=h),h}),e.j41(17,"option",13),e.EFF(18,"All"),e.k0s(),e.DNE(19,Se,2,4,"option",14),e.k0s()()(),e.DNE(20,sn,24,2,"div",15)(21,on,3,0,"div",16)(22,Re,3,1,"div",17)(23,ln,16,4,"div",18),e.k0s(),e.DNE(24,lt,1,4,"app-final-dx",19)),2&o&&(e.R7$(6),e.R50("ngModel",s.patient_search),e.R7$(2),e.Y8G("icon",s.faSearch),e.R7$(),e.R50("ngModel",s.is_konsulta),e.R7$(7),e.R50("ngModel",s.selected_physician),e.R7$(3),e.Y8G("ngForOf",s.physicians),e.R7$(),e.Y8G("ngIf",s.show_form),e.R7$(),e.Y8G("ngIf",s.show_form&&0===s.getPatient.length),e.R7$(),e.Y8G("ngIf",!s.show_form&&!s.getPatient),e.R7$(),e.Y8G("ngIf",s.total>=1),e.R7$(),e.Y8G("ngIf",s.openList))},dependencies:[x.Sq,x.bT,w.aY,P.xH,P.y7,P.me,P.wz,P.BC,P.vS,se],encapsulation:2})}}return a})();function de(a,u){1&a&&e.nrm(0,"app-pending-fdx")}const he=[{path:"",component:(()=>{class a{constructor(n){this.http=n,this.date_today=(0,x.Yq)(new Date,"MM/dd/yyyy","en","Asia/Manila")}ngOnInit(){const n=this.http.getUserFromJSON();this.user_designation=n.designation?n.designation.code:n.designation_code}static{this.\u0275fac=function(o){return new(o||a)(e.rXU(C.k))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-dashboard"]],standalone:!1,decls:6,vars:4,consts:[[1,"grid","grid-cols-11","mt-4","gap-4","w-full"],[1,"col-span-11","grid","grid-cols-1"],[3,"date_today"],[4,"ngIf"]],template:function(o,s){1&o&&(e.j41(0,"div",0)(1,"div",1),e.nrm(2,"app-todays-consult",2)(3,"app-todays-appointment",2),e.DNE(4,de,1,0,"app-pending-fdx",3),e.nrm(5,"app-todays-referral",2),e.k0s()()),2&o&&(e.R7$(2),e.Y8G("date_today",s.date_today),e.R7$(),e.Y8G("date_today",s.date_today),e.R7$(),e.Y8G("ngIf","MD"===s.user_designation),e.R7$(),e.Y8G("date_today",s.date_today))},dependencies:[x.bT,Tt,Pt,Xt,ve],encapsulation:2})}}return a})()}];let cn=(()=>{class a{static{this.\u0275fac=function(o){return new(o||a)}}static{this.\u0275mod=e.$C({type:a})}static{this.\u0275inj=e.G2t({imports:[_.iI.forChild(he),_.iI]})}}return a})(),un=(()=>{class a{static{this.\u0275fac=function(o){return new(o||a)}}static{this.\u0275mod=e.$C({type:a})}static{this.\u0275inj=e.G2t({imports:[x.MD,cn,w.dX,P.YN,ue.MQ,P.X1]})}}return a})()},41:(Ge,V,b)=>{"use strict";b.d(V,{V:()=>w});var x=b(4438);let w=(()=>{class _{constructor(){}calcuateAge(C,k){let A,R,O=new Date(C);R=k?new Date(k):Date.now();let j=Math.abs(R-O.getTime()),E=+(Math.round(parseFloat(j/864e5/365.25+"e2"))+"e-2");if(E<1){let v=Math.floor(j/864e5/30);A=v<1?{age:Math.floor(j/864e5),type:"day"}:{age:v,type:"month"}}else A={age:E,type:"year"};return A}static{this.\u0275fac=function(k){return new(k||_)}}static{this.\u0275prov=x.jDH({token:_,factory:_.\u0275fac,providedIn:"root"})}}return _})()},1196:(Ge,V,b)=>{"use strict";b.d(V,{j:()=>w});var x=b(4438);let w=(()=>{class _{getVisitType(C){switch(C){case"ab":return"Animal Bite";case"at":return"Adolescent";case"cc":return"Child Care";case"cn":return"Consultation";case"cv":return"COVID-19";case"dn":return"Dental";case"fp":return"Family Planning";case"lp":return"Leprosy";case"mc":return"Maternal Care";case"mh":return"Mental Health";case"ml":return"Malaria";case"ncd":return"Non Communicable Disease";case"tb":return"TB Dots";case"gbv":return"Gender Based Violence"}}getURL(C){switch(C){case"CBC":return"laboratory/consult-laboratory-cbc";case"CRTN":return"laboratory/consult-laboratory-creatinine";case"CXRAY":return"laboratory/consult-laboratory-chestxray";case"ECG":return"laboratory/consult-laboratory-ecg";case"FBS":return"laboratory/consult-laboratory-fbs";case"RBS":return"laboratory/consult-laboratory-rbs";case"HBA":return"laboratory/consult-laboratory-hba1c";case"PSMR":return"laboratory/consult-laboratory-papsmear";case"PPD":return"laboratory/consult-laboratory-ppd";case"SPTM":return"laboratory/consult-laboratory-sputum";case"FCAL":return"laboratory/consult-laboratory-fecalysis";case"LPFL":return"laboratory/consult-laboratory-lipid-profile";case"URN":return"laboratory/consult-laboratory-urinalysis";case"OGTT":return"laboratory/consult-laboratory-oral-glucose";case"FOBT":return"laboratory/consult-laboratory-fecal-occult";case"GRMS":return"laboratory/consult-laboratory-gram-stain";case"MCRP":return"laboratory/consult-laboratory-microscopy";case"BCHM":return"laboratory/consult-laboratory-blood-chemistry";case"BPSY":return"laboratory/consult-laboratory-biopsy";case"USND":return"laboratory/consult-laboratory-ultrasound";case"SYPH":return"laboratory/consult-laboratory-syphilis";case"HEMA":return"laboratory/consult-laboratory-hematology";case"RDT":return"laboratory/consult-laboratory-dengue";case"MRDT":return"laboratory/consult-laboratory-malaria";case"WETS":return"laboratory/consult-laboratory-wet-smear";case"SRLG":return"laboratory/consult-laboratory-serology";case"KOH":return"laboratory/consult-laboratory-potassium";case"SSMR":return"laboratory/consult-laboratory-skin-slit";case"GXPT":return"laboratory/consult-laboratory-geneXpert";case"CCS":return"laboratory/consult-laboratory-cervical-cancer";default:return""}}constructor(){}static{this.\u0275fac=function(k){return new(k||_)}}static{this.\u0275prov=x.jDH({token:_,factory:_.\u0275fac,providedIn:"root"})}}return _})()},8916:Ge=>{window,Ge.exports=function(V){var b={};function x(w){if(b[w])return b[w].exports;var _=b[w]={i:w,l:!1,exports:{}};return V[w].call(_.exports,_,_.exports,x),_.l=!0,_.exports}return x.m=V,x.c=b,x.d=function(w,_,e){x.o(w,_)||Object.defineProperty(w,_,{enumerable:!0,get:e})},x.r=function(w){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(w,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(w,"__esModule",{value:!0})},x.t=function(w,_){if(1&_&&(w=x(w)),8&_||4&_&&"object"==typeof w&&w&&w.__esModule)return w;var e=Object.create(null);if(x.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:w}),2&_&&"string"!=typeof w)for(var C in w)x.d(e,C,function(k){return w[k]}.bind(null,C));return e},x.n=function(w){var _=w&&w.__esModule?function(){return w.default}:function(){return w};return x.d(_,"a",_),_},x.o=function(w,_){return Object.prototype.hasOwnProperty.call(w,_)},x.p="",x(x.s=2)}([function(V,b,x){"use strict";var w=this&&this.__extends||function(){var v=function(g,m){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(F,I){F.__proto__=I}||function(F,I){for(var M in I)I.hasOwnProperty(M)&&(F[M]=I[M])})(g,m)};return function(g,m){function F(){this.constructor=g}v(g,m),g.prototype=null===m?Object.create(m):(F.prototype=m.prototype,new F)}}();Object.defineProperty(b,"__esModule",{value:!0});var _=256,e=function(){function v(g){void 0===g&&(g="="),this._paddingCharacter=g}return v.prototype.encodedLength=function(g){return this._paddingCharacter?(g+2)/3*4|0:(8*g+5)/6|0},v.prototype.encode=function(g){for(var m="",F=0;F<g.length-2;F+=3)m+=this._encodeByte((I=g[F]<<16|g[F+1]<<8|g[F+2])>>>18&63),m+=this._encodeByte(I>>>12&63),m+=this._encodeByte(I>>>6&63),m+=this._encodeByte(I>>>0&63);var I,M=g.length-F;return M>0&&(m+=this._encodeByte((I=g[F]<<16|(2===M?g[F+1]<<8:0))>>>18&63),m+=this._encodeByte(I>>>12&63),m+=2===M?this._encodeByte(I>>>6&63):this._paddingCharacter||"",m+=this._paddingCharacter||""),m},v.prototype.maxDecodedLength=function(g){return this._paddingCharacter?g/4*3|0:(6*g+7)/8|0},v.prototype.decodedLength=function(g){return this.maxDecodedLength(g.length-this._getPaddingLength(g))},v.prototype.decode=function(g){if(0===g.length)return new Uint8Array(0);for(var m=this._getPaddingLength(g),F=g.length-m,I=new Uint8Array(this.maxDecodedLength(F)),M=0,U=0,J=0,K=0,q=0,G=0,W=0;U<F-4;U+=4)K=this._decodeChar(g.charCodeAt(U+0)),q=this._decodeChar(g.charCodeAt(U+1)),G=this._decodeChar(g.charCodeAt(U+2)),W=this._decodeChar(g.charCodeAt(U+3)),I[M++]=K<<2|q>>>4,I[M++]=q<<4|G>>>2,I[M++]=G<<6|W,J|=K&_,J|=q&_,J|=G&_,J|=W&_;if(U<F-1&&(K=this._decodeChar(g.charCodeAt(U)),q=this._decodeChar(g.charCodeAt(U+1)),I[M++]=K<<2|q>>>4,J|=K&_,J|=q&_),U<F-2&&(G=this._decodeChar(g.charCodeAt(U+2)),I[M++]=q<<4|G>>>2,J|=G&_),U<F-3&&(W=this._decodeChar(g.charCodeAt(U+3)),I[M++]=G<<6|W,J|=W&_),0!==J)throw new Error("Base64Coder: incorrect characters for decoding");return I},v.prototype._encodeByte=function(g){var m=g;return m+=65,m+=25-g>>>8&6,m+=51-g>>>8&-75,m+=61-g>>>8&-15,m+=62-g>>>8&3,String.fromCharCode(m)},v.prototype._decodeChar=function(g){var m=_;return m+=(42-g&g-44)>>>8&-_+g-43+62,m+=(46-g&g-48)>>>8&-_+g-47+63,m+=(47-g&g-58)>>>8&-_+g-48+52,(m+=(64-g&g-91)>>>8&-_+g-65+0)+((96-g&g-123)>>>8&-_+g-97+26)},v.prototype._getPaddingLength=function(g){var m=0;if(this._paddingCharacter){for(var F=g.length-1;F>=0&&g[F]===this._paddingCharacter;F--)m++;if(g.length<4||m>2)throw new Error("Base64Coder: incorrect padding")}return m},v}();b.Coder=e;var C=new e;b.encode=function k(v){return C.encode(v)},b.decode=function A(v){return C.decode(v)};var O=function(v){function g(){return null!==v&&v.apply(this,arguments)||this}return w(g,v),g.prototype._encodeByte=function(m){var F=m;return F+=65,F+=25-m>>>8&6,F+=51-m>>>8&-75,F+=61-m>>>8&-13,F+=62-m>>>8&49,String.fromCharCode(F)},g.prototype._decodeChar=function(m){var F=_;return F+=(44-m&m-46)>>>8&-_+m-45+62,F+=(94-m&m-96)>>>8&-_+m-95+63,F+=(47-m&m-58)>>>8&-_+m-48+52,(F+=(64-m&m-91)>>>8&-_+m-65+0)+((96-m&m-123)>>>8&-_+m-97+26)},g}(e);b.URLSafeCoder=O;var R=new O;b.encodeURLSafe=function j(v){return R.encode(v)},b.decodeURLSafe=function E(v){return R.decode(v)},b.encodedLength=function(v){return C.encodedLength(v)},b.maxDecodedLength=function(v){return C.maxDecodedLength(v)},b.decodedLength=function(v){return C.decodedLength(v)}},function(V,b,x){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var w="utf8: invalid string",_="utf8: invalid source encoding";function C(A){for(var O=0,R=0;R<A.length;R++){var j=A.charCodeAt(R);if(j<128)O+=1;else if(j<2048)O+=2;else if(j<55296)O+=3;else{if(!(j<=57343))throw new Error(w);if(R>=A.length-1)throw new Error(w);R++,O+=4}}return O}b.encode=function e(A){for(var O=new Uint8Array(C(A)),R=0,j=0;j<A.length;j++){var E=A.charCodeAt(j);E<128?O[R++]=E:E<2048?(O[R++]=192|E>>6,O[R++]=128|63&E):E<55296?(O[R++]=224|E>>12,O[R++]=128|E>>6&63,O[R++]=128|63&E):(j++,E=(1023&E)<<10,E|=1023&A.charCodeAt(j),O[R++]=240|(E+=65536)>>18,O[R++]=128|E>>12&63,O[R++]=128|E>>6&63,O[R++]=128|63&E)}return O},b.encodedLength=C,b.decode=function k(A){for(var O=[],R=0;R<A.length;R++){var j=A[R];if(128&j){var E=void 0;if(j<224){if(R>=A.length)throw new Error(_);if(128!=(192&(v=A[++R])))throw new Error(_);j=(31&j)<<6|63&v,E=128}else if(j<240){if(R>=A.length-1)throw new Error(_);var v=A[++R],g=A[++R];if(128!=(192&v)||128!=(192&g))throw new Error(_);j=(15&j)<<12|(63&v)<<6|63&g,E=2048}else{if(!(j<248))throw new Error(_);if(R>=A.length-2)throw new Error(_);v=A[++R],g=A[++R];var m=A[++R];if(128!=(192&v)||128!=(192&g)||128!=(192&m))throw new Error(_);j=(15&j)<<18|(63&v)<<12|(63&g)<<6|63&m,E=65536}if(j<E||j>=55296&&j<=57343)throw new Error(_);if(j>=65536){if(j>1114111)throw new Error(_);j-=65536,O.push(String.fromCharCode(55296|j>>10)),j=56320|1023&j}}O.push(String.fromCharCode(j))}return O.join("")}},function(V,b,x){V.exports=x(3).default},function(V,b,x){"use strict";x.r(b);class w{constructor(t,i){this.lastId=0,this.prefix=t,this.name=i}create(t){this.lastId++;var i=this.lastId,l=this.prefix+i,c=this.name+"["+i+"]",p=!1,f=function(){p||(t.apply(null,arguments),p=!0)};return this[i]=f,{number:i,id:l,name:c,callback:f}}remove(t){delete this[t.number]}}var _=new w("_pusher_script_","Pusher.ScriptReceivers"),C_VERSION="8.4.0-rc2",C_PROTOCOL=7,C_wsPort=80,C_wssPort=443,C_wsPath="",C_httpHost="sockjs.pusher.com",C_httpPort=80,C_httpsPort=443,C_httpPath="/pusher",C_stats_host="stats.pusher.com",C_authEndpoint="/pusher/auth",C_authTransport="ajax",C_activityTimeout=12e4,C_pongTimeout=3e4,C_unavailableTimeout=1e4,C_userAuthentication={endpoint:"/pusher/user-auth",transport:"ajax"},C_channelAuthorization={endpoint:"/pusher/auth",transport:"ajax"},C_cdn_http="http://js.pusher.com",C_cdn_https="https://js.pusher.com",C_dependency_suffix="";var A=new w("_pusher_dependencies","Pusher.DependenciesReceivers"),O=new class k{constructor(t){this.options=t,this.receivers=t.receivers||_,this.loading={}}load(t,i,l){var c=this;if(c.loading[t]&&c.loading[t].length>0)c.loading[t].push(l);else{c.loading[t]=[l];var p=S.createScriptRequest(c.getPath(t,i)),f=c.receivers.create(function(y){if(c.receivers.remove(f),c.loading[t]){var T=c.loading[t];delete c.loading[t];for(var N=function(X){X||p.cleanup()},$=0;$<T.length;$++)T[$](y,N)}});p.send(f)}}getRoot(t){var l=S.getDocument().location.protocol;return(t&&t.useTLS||"https:"===l?this.options.cdn_https:this.options.cdn_http).replace(/\/*$/,"")+"/"+this.options.version}getPath(t,i){return this.getRoot(i)+"/"+t+this.options.suffix+".js"}}({cdn_http:C_cdn_http,cdn_https:C_cdn_https,version:C_VERSION,suffix:C_dependency_suffix,receivers:A});const R={baseUrl:"https://pusher.com",urls:{authenticationEndpoint:{path:"/docs/channels/server_api/authenticating_users"},authorizationEndpoint:{path:"/docs/channels/server_api/authorizing-users/"},javascriptQuickStart:{path:"/docs/javascript_quick_start"},triggeringClientEvents:{path:"/docs/client_api_guide/client_events#trigger-events"},encryptedChannelSupport:{fullUrl:"https://github.com/pusher/pusher-js/tree/cc491015371a4bde5743d1c87a0fbac0feb53195#encrypted-channel-support"}}};var E_buildLogSuffix=function(r){const i=R.urls[r];if(!i)return"";let l;return i.fullUrl?l=i.fullUrl:i.path&&(l=R.baseUrl+i.path),l?`See: ${l}`:""},v=function(r){return r.UserAuthentication="user-authentication",r.ChannelAuthorization="channel-authorization",r}(v||{});class g extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class m extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class F extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class I extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class M extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class U extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class J extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class K extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class q extends Error{constructor(t,i){super(i),this.status=t,Object.setPrototypeOf(this,new.target.prototype)}}var W=function(r,t,i,l,c){const p=S.createXHR();for(var f in p.open("POST",i.endpoint,!0),p.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.headers)p.setRequestHeader(f,i.headers[f]);if(null!=i.headersProvider){let y=i.headersProvider();for(var f in y)p.setRequestHeader(f,y[f])}return p.onreadystatechange=function(){if(4===p.readyState)if(200===p.status){let y,T=!1;try{y=JSON.parse(p.responseText),T=!0}catch{c(new q(200,`JSON returned from ${l.toString()} endpoint was invalid, yet status code was 200. Data was: ${p.responseText}`),null)}T&&c(null,y)}else{let y="";switch(l){case v.UserAuthentication:y=E_buildLogSuffix("authenticationEndpoint");break;case v.ChannelAuthorization:y=`Clients must be authorized to join private or presence channels. ${E_buildLogSuffix("authorizationEndpoint")}`}c(new q(p.status,`Unable to retrieve auth string from ${l.toString()} endpoint - received status: ${p.status} from ${i.endpoint}. ${y}`),null)}},p.send(t),p};for(var le=String.fromCharCode,ne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ue={},fe=0;fe<64;fe++)Ue[ne.charAt(fe)]=fe;var Xe=function(r){var t=r.charCodeAt(0);return t<128?r:t<2048?le(192|t>>>6)+le(128|63&t):le(224|t>>>12&15)+le(128|t>>>6&63)+le(128|63&t)},Ye=function(r){return r.replace(/[^\x00-\x7F]/g,Xe)},ht=function(r){var t=[0,2,1][r.length%3],i=r.charCodeAt(0)<<16|(r.length>1?r.charCodeAt(1):0)<<8|(r.length>2?r.charCodeAt(2):0);return[ne.charAt(i>>>18),ne.charAt(i>>>12&63),t>=2?"=":ne.charAt(i>>>6&63),t>=1?"=":ne.charAt(63&i)].join("")},me=window.btoa||function(r){return r.replace(/[\s\S]{1,3}/g,ht)};var He=class Be{constructor(t,i,l,c){this.clear=i,this.timer=t(()=>{this.timer&&(this.timer=c(this.timer))},l)}isRunning(){return null!==this.timer}ensureAborted(){this.timer&&(this.clear(this.timer),this.timer=null)}};function pt(r){window.clearTimeout(r)}function ke(r){window.clearInterval(r)}class ie extends He{constructor(t,i){super(setTimeout,pt,t,function(l){return i(),null})}}class ze extends He{constructor(t,i){super(setInterval,ke,t,function(l){return i(),l})}}var ft={now:()=>Date.now?Date.now():(new Date).valueOf(),defer:r=>new ie(0,r),method(r,...t){var i=Array.prototype.slice.call(arguments,1);return function(l){return l[r].apply(l,i.concat(arguments))}}},Y=ft;function z(r,...t){for(var i=0;i<t.length;i++){var l=t[i];for(var c in l)r[c]=l[c]&&l[c].constructor&&l[c].constructor===Object?z(r[c]||{},l[c]):l[c]}return r}function mt(){for(var r=["Pusher"],t=0;t<arguments.length;t++)r.push("string"==typeof arguments[t]?arguments[t]:ge(arguments[t]));return r.join(" : ")}function Ve(r,t){var i=Array.prototype.indexOf;if(null===r)return-1;if(i&&r.indexOf===i)return r.indexOf(t);for(var l=0,c=r.length;l<c;l++)if(r[l]===t)return l;return-1}function Q(r,t){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&t(r[i],i,r)}function P(r){var t=[];return Q(r,function(i,l){t.push(l)}),t}function ce(r,t,i){for(var l=0;l<r.length;l++)t.call(i||window,r[l],l,r)}function qe(r,t){for(var i=[],l=0;l<r.length;l++)i.push(t(r[l],l,r,i));return i}function Je(r,t){t=t||function(c){return!!c};for(var i=[],l=0;l<r.length;l++)t(r[l],l,r,i)&&i.push(r[l]);return i}function We(r,t){var i={};return Q(r,function(l,c){(t&&t(l,c,r,i)||l)&&(i[c]=l)}),i}function Ke(r,t){for(var i=0;i<r.length;i++)if(t(r[i],i,r))return!0;return!1}function yt(r){return function _t(r,t){var i={};return Q(r,function(l,c){i[c]=t(l)}),i}(r,function(t){return"object"==typeof t&&(t=ge(t)),encodeURIComponent(function Me(r){return me(Ye(r))}(t.toString()))})}function kt(r){return qe(function vt(r){var t=[];return Q(r,function(i,l){t.push([l,i])}),t}(yt(We(r,function(l){return void 0!==l}))),Y.method("join","=")).join("&")}function ge(r){try{return JSON.stringify(r)}catch{return JSON.stringify(function xt(r){var t=[],i=[];return function l(c,p){var f,y,T;switch(typeof c){case"object":if(!c)return null;for(f=0;f<t.length;f+=1)if(t[f]===c)return{$ref:i[f]};if(t.push(c),i.push(p),"[object Array]"===Object.prototype.toString.apply(c))for(T=[],f=0;f<c.length;f+=1)T[f]=l(c[f],p+"["+f+"]");else for(y in T={},c)Object.prototype.hasOwnProperty.call(c,y)&&(T[y]=l(c[y],p+"["+JSON.stringify(y)+"]"));return T;case"number":case"string":case"boolean":return c}}(r,"$")}(r))}}var L=new class wt{constructor(){this.globalLog=t=>{window.console&&window.console.log&&window.console.log(t)}}debug(...t){this.log(this.globalLog,t)}warn(...t){this.log(this.globalLogWarn,t)}error(...t){this.log(this.globalLogError,t)}globalLogWarn(t){window.console&&window.console.warn?window.console.warn(t):this.globalLog(t)}globalLogError(t){window.console&&window.console.error?window.console.error(t):this.globalLogWarn(t)}log(t,...i){var l=mt.apply(this,arguments);dn.log?dn.log(l):dn.logToConsole&&t.bind(this)(l)}},Ft=function(r,t,i,l,c){(void 0!==i.headers||null!=i.headersProvider)&&L.warn(`To send headers with the ${l.toString()} request, you must use AJAX, rather than JSONP.`);var p=r.nextAuthCallbackID.toString();r.nextAuthCallbackID++;var f=r.getDocument(),y=f.createElement("script");r.auth_callbacks[p]=function($){c(null,$)},y.src=i.endpoint+"?callback="+encodeURIComponent("Pusher.auth_callbacks['"+p+"']")+"&"+t;var N=f.getElementsByTagName("head")[0]||f.documentElement;N.insertBefore(y,N.firstChild)};class Tt{constructor(t){this.src=t}send(t){var i=this,l="Error loading "+i.src;i.script=document.createElement("script"),i.script.id=t.id,i.script.src=i.src,i.script.type="text/javascript",i.script.charset="UTF-8",i.script.addEventListener?(i.script.onerror=function(){t.callback(l)},i.script.onload=function(){t.callback(null)}):i.script.onreadystatechange=function(){("loaded"===i.script.readyState||"complete"===i.script.readyState)&&t.callback(null)},void 0===i.script.async&&document.attachEvent&&/opera/i.test(navigator.userAgent)?(i.errorScript=document.createElement("script"),i.errorScript.id=t.id+"_error",i.errorScript.text=t.name+"('"+l+"');",i.script.async=i.errorScript.async=!1):i.script.async=!0;var c=document.getElementsByTagName("head")[0];c.insertBefore(i.script,c.firstChild),i.errorScript&&c.insertBefore(i.errorScript,i.script.nextSibling)}cleanup(){this.script&&(this.script.onload=this.script.onerror=null,this.script.onreadystatechange=null),this.script&&this.script.parentNode&&this.script.parentNode.removeChild(this.script),this.errorScript&&this.errorScript.parentNode&&this.errorScript.parentNode.removeChild(this.errorScript),this.script=null,this.errorScript=null}}class St{constructor(t,i){this.url=t,this.data=i}send(t){if(!this.request){var i=kt(this.data);this.request=S.createScriptRequest(this.url+"/"+t.number+"?"+i),this.request.send(t)}}cleanup(){this.request&&this.request.cleanup()}}var Et={name:"jsonp",getAgent:function(r,t){return function(i,l){var f=S.createJSONPRequest("http"+(t?"s":"")+"://"+(r.host||r.options.host)+r.options.path,i),y=S.ScriptReceivers.create(function(T,N){_.remove(y),f.cleanup(),N&&N.host&&(r.host=N.host),l&&l(T,N)});f.send(y)}}};function xe(r,t,i){return r+(t.useTLS?"s":"")+"://"+(t.useTLS?t.hostTLS:t.hostNonTLS)+i}function we(r,t){return"/app/"+r+"?protocol="+C_PROTOCOL+"&client=js&version="+C_VERSION+(t?"&"+t:"")}var It={getInitial:function(r,t){return xe("ws",t,(t.httpPath||"")+we(r,"flash=false"))}},Pt={getInitial:function(r,t){return xe("http",t,(t.httpPath||"/pusher")+we(r))}},At={getInitial:function(r,t){return xe("http",t,t.httpPath||"/pusher")},getPath:function(r,t){return we(r)}};class Qe{constructor(){this._callbacks={}}get(t){return this._callbacks[Ce(t)]}add(t,i,l){var c=Ce(t);this._callbacks[c]=this._callbacks[c]||[],this._callbacks[c].push({fn:i,context:l})}remove(t,i,l){if(t||i||l){var c=t?[Ce(t)]:P(this._callbacks);i||l?this.removeCallback(c,i,l):this.removeAllCallbacks(c)}else this._callbacks={}}removeCallback(t,i,l){ce(t,function(c){this._callbacks[c]=Je(this._callbacks[c]||[],function(p){return i&&i!==p.fn||l&&l!==p.context}),0===this._callbacks[c].length&&delete this._callbacks[c]},this)}removeAllCallbacks(t){ce(t,function(i){delete this._callbacks[i]},this)}}function Ce(r){return"_"+r}class Z{constructor(t){this.callbacks=new Qe,this.global_callbacks=[],this.failThrough=t}bind(t,i,l){return this.callbacks.add(t,i,l),this}bind_global(t){return this.global_callbacks.push(t),this}unbind(t,i,l){return this.callbacks.remove(t,i,l),this}unbind_global(t){return t?(this.global_callbacks=Je(this.global_callbacks||[],i=>i!==t),this):(this.global_callbacks=[],this)}unbind_all(){return this.unbind(),this.unbind_global(),this}emit(t,i,l){for(var c=0;c<this.global_callbacks.length;c++)this.global_callbacks[c](t,i);var p=this.callbacks.get(t),f=[];if(l?f.push(i,l):i&&f.push(i),p&&p.length>0)for(c=0;c<p.length;c++)p[c].fn.apply(p[c].context||window,f);else this.failThrough&&this.failThrough(t,i);return this}}class Ot extends Z{constructor(t,i,l,c,p){super(),this.initialize=S.transportConnectionInitializer,this.hooks=t,this.name=i,this.priority=l,this.key=c,this.options=p,this.state="new",this.timeline=p.timeline,this.activityTimeout=p.activityTimeout,this.id=this.timeline.generateUniqueID()}handlesActivityChecks(){return!!this.hooks.handlesActivityChecks}supportsPing(){return!!this.hooks.supportsPing}connect(){if(this.socket||"initialized"!==this.state)return!1;var t=this.hooks.urls.getInitial(this.key,this.options);try{this.socket=this.hooks.getSocket(t,this.options)}catch(i){return Y.defer(()=>{this.onError(i),this.changeState("closed")}),!1}return this.bindListeners(),L.debug("Connecting",{transport:this.name,url:t}),this.changeState("connecting"),!0}close(){return!!this.socket&&(this.socket.close(),!0)}send(t){return"open"===this.state&&(Y.defer(()=>{this.socket&&this.socket.send(t)}),!0)}ping(){"open"===this.state&&this.supportsPing()&&this.socket.ping()}onOpen(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options)),this.changeState("open"),this.socket.onopen=void 0}onError(t){this.emit("error",{type:"WebSocketError",error:t}),this.timeline.error(this.buildTimelineMessage({error:t.toString()}))}onClose(t){t?this.changeState("closed",{code:t.code,reason:t.reason,wasClean:t.wasClean}):this.changeState("closed"),this.unbindListeners(),this.socket=void 0}onMessage(t){this.emit("message",t)}onActivity(){this.emit("activity")}bindListeners(){this.socket.onopen=()=>{this.onOpen()},this.socket.onerror=t=>{this.onError(t)},this.socket.onclose=t=>{this.onClose(t)},this.socket.onmessage=t=>{this.onMessage(t)},this.supportsPing()&&(this.socket.onactivity=()=>{this.onActivity()})}unbindListeners(){this.socket&&(this.socket.onopen=void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))}changeState(t,i){this.state=t,this.timeline.info(this.buildTimelineMessage({state:t,params:i})),this.emit(t,i)}buildTimelineMessage(t){return z({cid:this.id},t)}}class oe{constructor(t){this.hooks=t}isSupported(t){return this.hooks.isSupported(t)}createConnection(t,i,l,c){return new Ot(this.hooks,t,i,l,c)}}var Nt=new oe({urls:It,handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return!!S.getWebSocketAPI()},isSupported:function(){return!!S.getWebSocketAPI()},getSocket:function(r){return S.createWebSocket(r)}}),Ze={urls:Pt,handlesActivityChecks:!1,supportsPing:!0,isInitialized:function(){return!0}},et=z({getSocket:function(r){return S.HTTPFactory.createStreamingSocket(r)}},Ze),tt=z({getSocket:function(r){return S.HTTPFactory.createPollingSocket(r)}},Ze),nt={isSupported:function(){return S.isXHRSupported()}},_e={ws:Nt,xhr_streaming:new oe(z({},et,nt)),xhr_polling:new oe(z({},tt,nt))},Gt=new oe({file:"sockjs",urls:At,handlesActivityChecks:!0,supportsPing:!1,isSupported:function(){return!0},isInitialized:function(){return void 0!==window.SockJS},getSocket:function(r,t){return new window.SockJS(r,null,{js_path:O.getPath("sockjs",{useTLS:t.useTLS}),ignore_null_origin:t.ignoreNullOrigin})},beforeOpen:function(r,t){r.send(JSON.stringify({path:t}))}}),it={isSupported:function(r){return S.isXDRSupported(r.useTLS)}},Mt=new oe(z({},et,it)),Ut=new oe(z({},tt,it));_e.xdr_streaming=Mt,_e.xdr_polling=Ut,_e.sockjs=Gt;var Xt=_e;var rt=new class Yt extends Z{constructor(){super();var t=this;void 0!==window.addEventListener&&(window.addEventListener("online",function(){t.emit("online")},!1),window.addEventListener("offline",function(){t.emit("offline")},!1))}isOnline(){return void 0===window.navigator.onLine||window.navigator.onLine}};class Bt{constructor(t,i,l){this.manager=t,this.transport=i,this.minPingDelay=l.minPingDelay,this.maxPingDelay=l.maxPingDelay,this.pingDelay=void 0}createConnection(t,i,l,c){c=z({},c,{activityTimeout:this.pingDelay});var p=this.transport.createConnection(t,i,l,c),f=null,y=function(){p.unbind("open",y),p.bind("closed",T),f=Y.now()},T=N=>{if(p.unbind("closed",T),1002===N.code||1003===N.code)this.manager.reportDeath();else if(!N.wasClean&&f){var $=Y.now()-f;$<2*this.maxPingDelay&&(this.manager.reportDeath(),this.pingDelay=Math.max($/2,this.minPingDelay))}};return p.bind("open",y),p}isSupported(t){return this.manager.isAlive()&&this.transport.isSupported(t)}}const st={decodeMessage:function(r){try{var t=JSON.parse(r.data),i=t.data;if("string"==typeof i)try{i=JSON.parse(t.data)}catch{}var l={event:t.event,channel:t.channel,data:i};return t.user_id&&(l.user_id=t.user_id),l}catch(c){throw{type:"MessageParseError",error:c,data:r.data}}},encodeMessage:function(r){return JSON.stringify(r)},processHandshake:function(r){var t=st.decodeMessage(r);if("pusher:connection_established"===t.event){if(!t.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:t.data.socket_id,activityTimeout:1e3*t.data.activity_timeout}}if("pusher:error"===t.event)return{action:this.getCloseAction(t.data),error:this.getCloseError(t.data)};throw"Invalid handshake"},getCloseAction:function(r){return r.code<4e3?r.code>=1002&&r.code<=1004?"backoff":null:4e3===r.code?"tls_only":r.code<4100?"refused":r.code<4200?"backoff":r.code<4300?"retry":"refused"},getCloseError:function(r){return 1e3!==r.code&&1001!==r.code?{type:"PusherError",data:{code:r.code,message:r.reason||r.message}}:null}};var re=st;class ot extends Z{constructor(t,i){super(),this.id=t,this.transport=i,this.activityTimeout=i.activityTimeout,this.bindListeners()}handlesActivityChecks(){return this.transport.handlesActivityChecks()}send(t){return this.transport.send(t)}send_event(t,i,l){var c={event:t,data:i};return l&&(c.channel=l),L.debug("Event sent",c),this.send(re.encodeMessage(c))}ping(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})}close(){this.transport.close()}bindListeners(){var t={message:l=>{var c;try{c=re.decodeMessage(l)}catch(p){this.emit("error",{type:"MessageParseError",error:p,data:l.data})}if(void 0!==c){switch(L.debug("Event recd",c),c.event){case"pusher:error":this.emit("error",{type:"PusherError",data:c.data});break;case"pusher:ping":this.emit("ping");break;case"pusher:pong":this.emit("pong")}this.emit("message",c)}},activity:()=>{this.emit("activity")},error:l=>{this.emit("error",l)},closed:l=>{i(),l&&l.code&&this.handleCloseEvent(l),this.transport=null,this.emit("closed")}},i=()=>{Q(t,(l,c)=>{this.transport.unbind(c,l)})};Q(t,(l,c)=>{this.transport.bind(c,l)})}handleCloseEvent(t){var i=re.getCloseAction(t),l=re.getCloseError(t);l&&this.emit("error",l),i&&this.emit(i,{action:i,error:l})}}class Ht{constructor(t,i){this.transport=t,this.callback=i,this.bindListeners()}close(){this.unbindListeners(),this.transport.close()}bindListeners(){this.onMessage=t=>{var i;this.unbindListeners();try{i=re.processHandshake(t)}catch(l){return this.finish("error",{error:l}),void this.transport.close()}"connected"===i.action?this.finish("connected",{connection:new ot(i.id,this.transport),activityTimeout:i.activityTimeout}):(this.finish(i.action,{error:i.error}),this.transport.close())},this.onClosed=t=>{this.unbindListeners();var i=re.getCloseAction(t)||"backoff",l=re.getCloseError(t);this.finish(i,{error:l})},this.transport.bind("message",this.onMessage),this.transport.bind("closed",this.onClosed)}unbindListeners(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)}finish(t,i){this.callback(z({transport:this.transport,action:t},i))}}class zt{constructor(t,i){this.timeline=t,this.options=i||{}}send(t,i){this.timeline.isEmpty()||this.timeline.send(S.TimelineTransport.getAgent(this,t),i)}}class Fe extends Z{constructor(t,i){super(function(l,c){L.debug("No callbacks on "+t+" for "+l)}),this.name=t,this.pusher=i,this.subscribed=!1,this.subscriptionPending=!1,this.subscriptionCancelled=!1}authorize(t,i){return i(null,{auth:""})}trigger(t,i){if(0!==t.indexOf("client-"))throw new g("Event '"+t+"' does not start with 'client-'");if(!this.subscribed){var l=E_buildLogSuffix("triggeringClientEvents");L.warn(`Client event triggered before channel 'subscription_succeeded' event . ${l}`)}return this.pusher.send_event(t,i,this.name)}disconnect(){this.subscribed=!1,this.subscriptionPending=!1}handleEvent(t){var i=t.event,l=t.data;"pusher_internal:subscription_succeeded"===i?this.handleSubscriptionSucceededEvent(t):"pusher_internal:subscription_count"===i?this.handleSubscriptionCountEvent(t):0!==i.indexOf("pusher_internal:")&&this.emit(i,l,{})}handleSubscriptionSucceededEvent(t){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):this.emit("pusher:subscription_succeeded",t.data)}handleSubscriptionCountEvent(t){t.data.subscription_count&&(this.subscriptionCount=t.data.subscription_count),this.emit("pusher:subscription_count",t.data)}subscribe(){this.subscribed||(this.subscriptionPending=!0,this.subscriptionCancelled=!1,this.authorize(this.pusher.connection.socket_id,(t,i)=>{t?(this.subscriptionPending=!1,L.error(t.toString()),this.emit("pusher:subscription_error",Object.assign({},{type:"AuthError",error:t.message},t instanceof q?{status:t.status}:{}))):this.pusher.send_event("pusher:subscribe",{auth:i.auth,channel_data:i.channel_data,channel:this.name})}))}unsubscribe(){this.subscribed=!1,this.pusher.send_event("pusher:unsubscribe",{channel:this.name})}cancelSubscription(){this.subscriptionCancelled=!0}reinstateSubscription(){this.subscriptionCancelled=!1}}class ue extends Fe{authorize(t,i){return this.pusher.config.channelAuthorizer({channelName:this.name,socketId:t},i)}}class Vt{constructor(){this.reset()}get(t){return Object.prototype.hasOwnProperty.call(this.members,t)?{id:t,info:this.members[t]}:null}each(t){Q(this.members,(i,l)=>{t(this.get(l))})}setMyID(t){this.myID=t}onSubscription(t){this.members=t.presence.hash,this.count=t.presence.count,this.me=this.get(this.myID)}addMember(t){return null===this.get(t.user_id)&&this.count++,this.members[t.user_id]=t.user_info,this.get(t.user_id)}removeMember(t){var i=this.get(t.user_id);return i&&(delete this.members[t.user_id],this.count--),i}reset(){this.members={},this.count=0,this.myID=null,this.me=null}}var qt=function(r,t,i,l){return new(i||(i=Promise))(function(p,f){function y($){try{N(l.next($))}catch(X){f(X)}}function T($){try{N(l.throw($))}catch(X){f(X)}}function N($){$.done?p($.value):function c(p){return p instanceof i?p:new i(function(f){f(p)})}($.value).then(y,T)}N((l=l.apply(r,t||[])).next())})};class Jt extends ue{constructor(t,i){super(t,i),this.members=new Vt}authorize(t,i){super.authorize(t,(l,c)=>qt(this,void 0,void 0,function*(){if(!l)if(null!=c.channel_data){var p=JSON.parse(c.channel_data);this.members.setMyID(p.user_id)}else{if(yield this.pusher.user.signinDonePromise,null==this.pusher.user.user_data){let f=E_buildLogSuffix("authorizationEndpoint");return L.error(`Invalid auth response for channel '${this.name}', expected 'channel_data' field. ${f}, or the user should be signed in.`),void i("Invalid auth response")}this.members.setMyID(this.pusher.user.user_data.id)}i(l,c)}))}handleEvent(t){var i=t.event;if(0===i.indexOf("pusher_internal:"))this.handleInternalEvent(t);else{var l=t.data,c={};t.user_id&&(c.user_id=t.user_id),this.emit(i,l,c)}}handleInternalEvent(t){var l=t.data;switch(t.event){case"pusher_internal:subscription_succeeded":this.handleSubscriptionSucceededEvent(t);break;case"pusher_internal:subscription_count":this.handleSubscriptionCountEvent(t);break;case"pusher_internal:member_added":var c=this.members.addMember(l);this.emit("pusher:member_added",c);break;case"pusher_internal:member_removed":var p=this.members.removeMember(l);p&&this.emit("pusher:member_removed",p)}}handleSubscriptionSucceededEvent(t){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):(this.members.onSubscription(t.data),this.emit("pusher:subscription_succeeded",this.members))}disconnect(){this.members.reset(),super.disconnect()}}var Wt=x(1),Te=x(0);class Kt extends ue{constructor(t,i,l){super(t,i),this.key=null,this.nacl=l}authorize(t,i){super.authorize(t,(l,c)=>{if(l)return void i(l,c);let p=c.shared_secret;p?(this.key=Object(Te.decode)(p),delete c.shared_secret,i(null,c)):i(new Error(`No shared_secret key in auth payload for encrypted channel: ${this.name}`),null)})}trigger(t,i){throw new U("Client events are not currently supported for encrypted channels")}handleEvent(t){var i=t.event,l=t.data;0!==i.indexOf("pusher_internal:")&&0!==i.indexOf("pusher:")?this.handleEncryptedEvent(i,l):super.handleEvent(t)}handleEncryptedEvent(t,i){if(!this.key)return void L.debug("Received encrypted event before key has been retrieved from the authEndpoint");if(!i.ciphertext||!i.nonce)return void L.error("Unexpected format for encrypted event, expected object with `ciphertext` and `nonce` fields, got: "+i);let l=Object(Te.decode)(i.ciphertext);if(l.length<this.nacl.secretbox.overheadLength)return void L.error(`Expected encrypted event ciphertext length to be ${this.nacl.secretbox.overheadLength}, got: ${l.length}`);let c=Object(Te.decode)(i.nonce);if(c.length<this.nacl.secretbox.nonceLength)return void L.error(`Expected encrypted event nonce length to be ${this.nacl.secretbox.nonceLength}, got: ${c.length}`);let p=this.nacl.secretbox.open(l,c,this.key);if(null===p)return L.debug("Failed to decrypt an event, probably because it was encrypted with a different key. Fetching a new key from the authEndpoint..."),void this.authorize(this.pusher.connection.socket_id,(f,y)=>{f?L.error(`Failed to make a request to the authEndpoint: ${y}. Unable to fetch new key, so dropping encrypted event`):(p=this.nacl.secretbox.open(l,c,this.key),null!==p?this.emit(t,this.getDataToEmit(p)):L.error("Failed to decrypt event with new key. Dropping encrypted event"))});this.emit(t,this.getDataToEmit(p))}getDataToEmit(t){let i=Object(Wt.decode)(t);try{return JSON.parse(i)}catch{return i}}}class Qt extends Z{constructor(t,i){super(),this.state="initialized",this.connection=null,this.key=t,this.options=i,this.timeline=this.options.timeline,this.usingTLS=this.options.useTLS,this.errorCallbacks=this.buildErrorCallbacks(),this.connectionCallbacks=this.buildConnectionCallbacks(this.errorCallbacks),this.handshakeCallbacks=this.buildHandshakeCallbacks(this.errorCallbacks);var l=S.getNetwork();l.bind("online",()=>{this.timeline.info({netinfo:"online"}),("connecting"===this.state||"unavailable"===this.state)&&this.retryIn(0)}),l.bind("offline",()=>{this.timeline.info({netinfo:"offline"}),this.connection&&this.sendActivityCheck()}),this.updateStrategy()}switchCluster(t){this.key=t,this.updateStrategy(),this.retryIn(0)}connect(){if(!this.connection&&!this.runner){if(!this.strategy.isSupported())return void this.updateState("failed");this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()}}send(t){return!!this.connection&&this.connection.send(t)}send_event(t,i,l){return!!this.connection&&this.connection.send_event(t,i,l)}disconnect(){this.disconnectInternally(),this.updateState("disconnected")}isUsingTLS(){return this.usingTLS}startConnecting(){var t=(i,l)=>{i?this.runner=this.strategy.connect(0,t):"error"===l.action?(this.emit("error",{type:"HandshakeError",error:l.error}),this.timeline.error({handshakeError:l.error})):(this.abortConnecting(),this.handshakeCallbacks[l.action](l))};this.runner=this.strategy.connect(0,t)}abortConnecting(){this.runner&&(this.runner.abort(),this.runner=null)}disconnectInternally(){this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.connection&&this.abandonConnection().close()}updateStrategy(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,useTLS:this.usingTLS})}retryIn(t){this.timeline.info({action:"retry",delay:t}),t>0&&this.emit("connecting_in",Math.round(t/1e3)),this.retryTimer=new ie(t||0,()=>{this.disconnectInternally(),this.connect()})}clearRetryTimer(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)}setUnavailableTimer(){this.unavailableTimer=new ie(this.options.unavailableTimeout,()=>{this.updateState("unavailable")})}clearUnavailableTimer(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()}sendActivityCheck(){this.stopActivityCheck(),this.connection.ping(),this.activityTimer=new ie(this.options.pongTimeout,()=>{this.timeline.error({pong_timed_out:this.options.pongTimeout}),this.retryIn(0)})}resetActivityCheck(){this.stopActivityCheck(),this.connection&&!this.connection.handlesActivityChecks()&&(this.activityTimer=new ie(this.activityTimeout,()=>{this.sendActivityCheck()}))}stopActivityCheck(){this.activityTimer&&this.activityTimer.ensureAborted()}buildConnectionCallbacks(t){return z({},t,{message:i=>{this.resetActivityCheck(),this.emit("message",i)},ping:()=>{this.send_event("pusher:pong",{})},activity:()=>{this.resetActivityCheck()},error:i=>{this.emit("error",i)},closed:()=>{this.abandonConnection(),this.shouldRetry()&&this.retryIn(1e3)}})}buildHandshakeCallbacks(t){return z({},t,{connected:i=>{this.activityTimeout=Math.min(this.options.activityTimeout,i.activityTimeout,i.connection.activityTimeout||1/0),this.clearUnavailableTimer(),this.setConnection(i.connection),this.socket_id=this.connection.id,this.updateState("connected",{socket_id:this.socket_id})}})}buildErrorCallbacks(){let t=i=>l=>{l.error&&this.emit("error",{type:"WebSocketError",error:l.error}),i(l)};return{tls_only:t(()=>{this.usingTLS=!0,this.updateStrategy(),this.retryIn(0)}),refused:t(()=>{this.disconnect()}),backoff:t(()=>{this.retryIn(1e3)}),retry:t(()=>{this.retryIn(0)})}}setConnection(t){for(var i in this.connection=t,this.connectionCallbacks)this.connection.bind(i,this.connectionCallbacks[i]);this.resetActivityCheck()}abandonConnection(){if(this.connection){for(var t in this.stopActivityCheck(),this.connectionCallbacks)this.connection.unbind(t,this.connectionCallbacks[t]);var i=this.connection;return this.connection=null,i}}updateState(t,i){var l=this.state;if(this.state=t,l!==t){var c=t;"connected"===c&&(c+=" with new socket ID "+i.socket_id),L.debug("State changed",l+" -> "+c),this.timeline.info({state:t,params:i}),this.emit("state_change",{previous:l,current:t}),this.emit(t,i)}}shouldRetry(){return"connecting"===this.state||"connected"===this.state}}class Zt{constructor(){this.channels={}}add(t,i){return this.channels[t]||(this.channels[t]=function en(r,t){if(0===r.indexOf("private-encrypted-")){if(t.config.nacl)return ee.createEncryptedChannel(r,t,t.config.nacl);let i="Tried to subscribe to a private-encrypted- channel but no nacl implementation available",l=E_buildLogSuffix("encryptedChannelSupport");throw new U(`${i}. ${l}`)}if(0===r.indexOf("private-"))return ee.createPrivateChannel(r,t);if(0===r.indexOf("presence-"))return ee.createPresenceChannel(r,t);if(0===r.indexOf("#"))throw new m('Cannot create a channel with name "'+r+'".');return ee.createChannel(r,t)}(t,i)),this.channels[t]}all(){return function gt(r){var t=[];return Q(r,function(i){t.push(i)}),t}(this.channels)}find(t){return this.channels[t]}remove(t){var i=this.channels[t];return delete this.channels[t],i}disconnect(){Q(this.channels,function(t){t.disconnect()})}}var ee={createChannels:()=>new Zt,createConnectionManager:(r,t)=>new Qt(r,t),createChannel:(r,t)=>new Fe(r,t),createPrivateChannel:(r,t)=>new ue(r,t),createPresenceChannel:(r,t)=>new Jt(r,t),createEncryptedChannel:(r,t,i)=>new Kt(r,t,i),createTimelineSender:(r,t)=>new zt(r,t),createHandshake:(r,t)=>new Ht(r,t),createAssistantToTheTransportManager:(r,t,i)=>new Bt(r,t,i)};class at{constructor(t){this.options=t||{},this.livesLeft=this.options.lives||1/0}getAssistant(t){return ee.createAssistantToTheTransportManager(this,t,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})}isAlive(){return this.livesLeft>0}reportDeath(){this.livesLeft-=1}}class se{constructor(t,i){this.strategies=t,this.loop=!!i.loop,this.failFast=!!i.failFast,this.timeout=i.timeout,this.timeoutLimit=i.timeoutLimit}isSupported(){return Ke(this.strategies,Y.method("isSupported"))}connect(t,i){var l=this.strategies,c=0,p=this.timeout,f=null,y=(T,N)=>{N?i(null,N):(c+=1,this.loop&&(c%=l.length),c<l.length?(p&&(p*=2,this.timeoutLimit&&(p=Math.min(p,this.timeoutLimit))),f=this.tryStrategy(l[c],t,{timeout:p,failFast:this.failFast},y)):i(!0))};return f=this.tryStrategy(l[c],t,{timeout:p,failFast:this.failFast},y),{abort:function(){f.abort()},forceMinPriority:function(T){t=T,f&&f.forceMinPriority(T)}}}tryStrategy(t,i,l,c){var p=null,f=null;return l.timeout>0&&(p=new ie(l.timeout,function(){f.abort(),c(!0)})),f=t.connect(i,function(y,T){y&&p&&p.isRunning()&&!l.failFast||(p&&p.ensureAborted(),c(y,T))}),{abort:function(){p&&p.ensureAborted(),f.abort()},forceMinPriority:function(y){f.forceMinPriority(y)}}}}class Se{constructor(t){this.strategies=t}isSupported(){return Ke(this.strategies,Y.method("isSupported"))}connect(t,i){return function nn(r,t,i){var l=qe(r,function(c,p,f,y){return c.connect(t,i(p,y))});return{abort:function(){ce(l,sn)},forceMinPriority:function(c){ce(l,function(p){p.forceMinPriority(c)})}}}(this.strategies,t,function(l,c){return function(p,f){c[l].error=p,p?function rn(r){return function bt(r,t){for(var i=0;i<r.length;i++)if(!t(r[i],i,r))return!1;return!0}(r,function(t){return!!t.error})}(c)&&i(!0):(ce(c,function(y){y.forceMinPriority(f.transport.priority)}),i(null,f))}})}}function sn(r){!r.error&&!r.aborted&&(r.abort(),r.aborted=!0)}class on{constructor(t,i,l){this.strategy=t,this.transports=i,this.ttl=l.ttl||18e5,this.usingTLS=l.useTLS,this.timeline=l.timeline}isSupported(){return this.strategy.isSupported()}connect(t,i){var l=this.usingTLS,c=function an(r){var t=S.getLocalStorage();if(t)try{var i=t[Re(r)];if(i)return JSON.parse(i)}catch{lt(r)}return null}(l),p=c&&c.cacheSkipCount?c.cacheSkipCount:0,f=[this.strategy];if(c&&c.timestamp+this.ttl>=Y.now()){var y=this.transports[c.transport];y&&(["ws","wss"].includes(c.transport)||p>3?(this.timeline.info({cached:!0,transport:c.transport,latency:c.latency}),f.push(new se([y],{timeout:2*c.latency+1e3,failFast:!0}))):p++)}var T=Y.now(),N=f.pop().connect(t,function $(X,ut){X?(lt(l),f.length>0?(T=Y.now(),N=f.pop().connect(t,$)):i(X)):(function ln(r,t,i,l){var c=S.getLocalStorage();if(c)try{c[Re(r)]=ge({timestamp:Y.now(),transport:t,latency:i,cacheSkipCount:l})}catch{}}(l,ut.transport.name,Y.now()-T,p),i(null,ut))});return{abort:function(){N.abort()},forceMinPriority:function($){t=$,N&&N.forceMinPriority($)}}}}function Re(r){return"pusherTransport"+(r?"TLS":"NonTLS")}function lt(r){var t=S.getLocalStorage();if(t)try{delete t[Re(r)]}catch{}}class ve{constructor(t,{delay:i}){this.strategy=t,this.options={delay:i}}isSupported(){return this.strategy.isSupported()}connect(t,i){var c,l=this.strategy,p=new ie(this.options.delay,function(){c=l.connect(t,i)});return{abort:function(){p.ensureAborted(),c&&c.abort()},forceMinPriority:function(f){t=f,c&&c.forceMinPriority(f)}}}}class de{constructor(t,i,l){this.test=t,this.trueBranch=i,this.falseBranch=l}isSupported(){return(this.test()?this.trueBranch:this.falseBranch).isSupported()}connect(t,i){return(this.test()?this.trueBranch:this.falseBranch).connect(t,i)}}class fn{constructor(t){this.strategy=t}isSupported(){return this.strategy.isSupported()}connect(t,i){var l=this.strategy.connect(t,function(c,p){p&&l.abort(),i(c,p)});return l}}function he(r){return function(){return r.isSupported()}}var n={getRequest:function(r){var t=new window.XDomainRequest;return t.ontimeout=function(){r.emit("error",new F),r.close()},t.onerror=function(i){r.emit("error",i),r.close()},t.onprogress=function(){t.responseText&&t.responseText.length>0&&r.onChunk(200,t.responseText)},t.onload=function(){t.responseText&&t.responseText.length>0&&r.onChunk(200,t.responseText),r.emit("finished",200),r.close()},t},abortRequest:function(r){r.ontimeout=r.onerror=r.onprogress=r.onload=null,r.abort()}};class s extends Z{constructor(t,i,l){super(),this.hooks=t,this.method=i,this.url=l}start(t){this.position=0,this.xhr=this.hooks.getRequest(this),this.unloader=()=>{this.close()},S.addUnloadListener(this.unloader),this.xhr.open(this.method,this.url,!0),this.xhr.setRequestHeader&&this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.send(t)}close(){this.unloader&&(S.removeUnloadListener(this.unloader),this.unloader=null),this.xhr&&(this.hooks.abortRequest(this.xhr),this.xhr=null)}onChunk(t,i){for(;;){var l=this.advanceBuffer(i);if(!l)break;this.emit("chunk",{status:t,data:l})}this.isBufferTooLong(i)&&this.emit("buffer_too_long")}advanceBuffer(t){var i=t.slice(this.position),l=i.indexOf("\n");return-1!==l?(this.position+=l+1,i.slice(0,l)):null}isBufferTooLong(t){return this.position===t.length&&t.length>262144}}var d=function(r){return r[r.CONNECTING=0]="CONNECTING",r[r.OPEN=1]="OPEN",r[r.CLOSED=3]="CLOSED",r}(d||{}),h=d,D=1;function ae(r){var t=-1===r.indexOf("?")?"?":"&";return r+t+"t="+ +new Date+"&n="+D++}function be(r){return S.randomInt(r)}var Ie=class B{constructor(t,i){this.hooks=t,this.session=be(1e3)+"/"+function Ee(r){for(var t=[],i=0;i<r;i++)t.push(be(32).toString(32));return t.join("")}(8),this.location=function te(r){var t=/([^\?]*)\/*(\??.*)/.exec(r);return{base:t[1],queryString:t[2]}}(i),this.readyState=h.CONNECTING,this.openStream()}send(t){return this.sendRaw(JSON.stringify([t]))}ping(){this.hooks.sendHeartbeat(this)}close(t,i){this.onClose(t,i,!0)}sendRaw(t){if(this.readyState!==h.OPEN)return!1;try{return S.createSocketRequest("POST",ae(function pe(r,t){return r.base+"/"+t+"/xhr_send"}(this.location,this.session))).start(t),!0}catch{return!1}}reconnect(){this.closeStream(),this.openStream()}onClose(t,i,l){this.closeStream(),this.readyState=h.CLOSED,this.onclose&&this.onclose({code:t,reason:i,wasClean:l})}onChunk(t){var i;if(200===t.status)switch(this.readyState===h.OPEN&&this.onActivity(),t.data.slice(0,1)){case"o":i=JSON.parse(t.data.slice(1)||"{}"),this.onOpen(i);break;case"a":i=JSON.parse(t.data.slice(1)||"[]");for(var c=0;c<i.length;c++)this.onEvent(i[c]);break;case"m":i=JSON.parse(t.data.slice(1)||"null"),this.onEvent(i);break;case"h":this.hooks.onHeartbeat(this);break;case"c":i=JSON.parse(t.data.slice(1)||"[]"),this.onClose(i[0],i[1],!0)}}onOpen(t){this.readyState===h.CONNECTING?(t&&t.hostname&&(this.location.base=function je(r,t){var i=/(https?:\/\/)([^\/:]+)((\/|:)?.*)/.exec(r);return i[1]+t+i[3]}(this.location.base,t.hostname)),this.readyState=h.OPEN,this.onopen&&this.onopen()):this.onClose(1006,"Server lost session",!0)}onEvent(t){this.readyState===h.OPEN&&this.onmessage&&this.onmessage({data:t})}onActivity(){this.onactivity&&this.onactivity()}onError(t){this.onerror&&this.onerror(t)}openStream(){this.stream=S.createSocketRequest("POST",ae(this.hooks.getReceiveURL(this.location,this.session))),this.stream.bind("chunk",t=>{this.onChunk(t)}),this.stream.bind("finished",t=>{this.hooks.onFinished(this,t)}),this.stream.bind("buffer_too_long",()=>{this.reconnect()});try{this.stream.start()}catch(t){Y.defer(()=>{this.onError(t),this.onClose(1006,"Could not start streaming",!1)})}}closeStream(){this.stream&&(this.stream.unbind_all(),this.stream.close(),this.stream=null)}},Ae={getReceiveURL:function(r,t){return r.base+"/"+t+"/xhr_streaming"+r.queryString},onHeartbeat:function(r){r.sendRaw("[]")},sendHeartbeat:function(r){r.sendRaw("[]")},onFinished:function(r,t){r.onClose(1006,"Connection interrupted ("+t+")",!1)}},Ne={getReceiveURL:function(r,t){return r.base+"/"+t+"/xhr"+r.queryString},onHeartbeat:function(){},sendHeartbeat:function(r){r.sendRaw("[]")},onFinished:function(r,t){200===t?r.reconnect():r.onClose(1006,"Connection interrupted ("+t+")",!1)}},Le={getRequest:function(r){var i=new(S.getXHRAPI());return i.onreadystatechange=i.onprogress=function(){switch(i.readyState){case 3:i.responseText&&i.responseText.length>0&&r.onChunk(i.status,i.responseText);break;case 4:i.responseText&&i.responseText.length>0&&r.onChunk(i.status,i.responseText),r.emit("finished",i.status),r.close()}},i},abortRequest:function(r){r.onreadystatechange=null,r.abort()}},S={nextAuthCallbackID:1,auth_callbacks:{},ScriptReceivers:_,DependenciesReceivers:A,getDefaultStrategy:function(r,t,i){var l={};function c(Fn,ri,si,oi,ai){var Tn=i(r,Fn,ri,si,oi,ai);return l[Fn]=Tn,Tn}var pn,p=Object.assign({},t,{hostNonTLS:r.wsHost+":"+r.wsPort,hostTLS:r.wsHost+":"+r.wssPort,httpPath:r.wsPath}),f=Object.assign({},p,{useTLS:!0}),y=Object.assign({},t,{hostNonTLS:r.httpHost+":"+r.httpPort,hostTLS:r.httpHost+":"+r.httpsPort,httpPath:r.httpPath}),T={loop:!0,timeout:15e3,timeoutLimit:6e4},N=new at({minPingDelay:1e4,maxPingDelay:r.activityTimeout}),$=new at({lives:2,minPingDelay:1e4,maxPingDelay:r.activityTimeout}),X=c("ws","ws",3,p,N),ut=c("wss","ws",3,f,N),Zn=c("sockjs","sockjs",1,y),bn=c("xhr_streaming","xhr_streaming",1,y,$),ei=c("xdr_streaming","xdr_streaming",1,y,$),yn=c("xhr_polling","xhr_polling",1,y),ti=c("xdr_polling","xdr_polling",1,y),kn=new se([X],T),ni=new se([ut],T),ii=new se([Zn],T),xn=new se([new de(he(bn),bn,ei)],T),wn=new se([new de(he(yn),yn,ti)],T),Cn=new se([new de(he(xn),new Se([xn,new ve(wn,{delay:4e3})]),wn)],T),hn=new de(he(Cn),Cn,ii);return pn=new Se(t.useTLS?[kn,new ve(hn,{delay:2e3})]:[kn,new ve(ni,{delay:2e3}),new ve(hn,{delay:5e3})]),new on(new fn(new de(he(X),pn,hn)),l,{ttl:18e5,timeline:t.timeline,useTLS:t.useTLS})},Transports:Xt,transportConnectionInitializer:function(){var r=this;r.timeline.info(r.buildTimelineMessage({transport:r.name+(r.options.useTLS?"s":"")})),r.hooks.isInitialized()?r.changeState("initialized"):r.hooks.file?(r.changeState("initializing"),O.load(r.hooks.file,{useTLS:r.options.useTLS},function(t,i){r.hooks.isInitialized()?(r.changeState("initialized"),i(!0)):(t&&r.onError(t),r.onClose(),i(!1))})):r.onClose()},HTTPFactory:{createStreamingSocket(r){return this.createSocket(Ae,r)},createPollingSocket(r){return this.createSocket(Ne,r)},createSocket:(r,t)=>new Ie(r,t),createXHR(r,t){return this.createRequest(Le,r,t)},createRequest:(r,t,i)=>new s(r,t,i),createXDR:function(r,t){return this.createRequest(n,r,t)}},TimelineTransport:Et,getXHRAPI:()=>window.XMLHttpRequest,getWebSocketAPI:()=>window.WebSocket||window.MozWebSocket,setup(r){window.Pusher=r;var t=()=>{this.onDocumentBody(r.ready)};window.JSON?t():O.load("json2",{},t)},getDocument:()=>document,getProtocol(){return this.getDocument().location.protocol},getAuthorizers:()=>({ajax:W,jsonp:Ft}),onDocumentBody(r){document.body?r():setTimeout(()=>{this.onDocumentBody(r)},0)},createJSONPRequest:(r,t)=>new St(r,t),createScriptRequest:r=>new Tt(r),getLocalStorage(){try{return window.localStorage}catch{return}},createXHR(){return this.getXHRAPI()?this.createXMLHttpRequest():this.createMicrosoftXHR()},createXMLHttpRequest(){return new(this.getXHRAPI())},createMicrosoftXHR:()=>new ActiveXObject("Microsoft.XMLHTTP"),getNetwork:()=>rt,createWebSocket(r){return new(this.getWebSocketAPI())(r)},createSocketRequest(r,t){if(this.isXHRSupported())return this.HTTPFactory.createXHR(r,t);if(this.isXDRSupported(0===t.indexOf("https:")))return this.HTTPFactory.createXDR(r,t);throw"Cross-origin HTTP requests are not supported"},isXHRSupported(){var r=this.getXHRAPI();return!!r&&void 0!==(new r).withCredentials},isXDRSupported(r){var t=r?"https:":"http:",i=this.getProtocol();return!!window.XDomainRequest&&i===t},addUnloadListener(r){void 0!==window.addEventListener?window.addEventListener("unload",r,!1):void 0!==window.attachEvent&&window.attachEvent("onunload",r)},removeUnloadListener(r){void 0!==window.addEventListener?window.removeEventListener("unload",r,!1):void 0!==window.detachEvent&&window.detachEvent("onunload",r)},randomInt:r=>Math.floor((window.crypto||window.msCrypto).getRandomValues(new Uint32Array(1))[0]/Math.pow(2,32)*r)},mn=function(r){return r[r.ERROR=3]="ERROR",r[r.INFO=6]="INFO",r[r.DEBUG=7]="DEBUG",r}(mn||{}),ct=mn;class jn{constructor(t,i,l){this.key=t,this.session=i,this.events=[],this.options=l||{},this.sent=0,this.uniqueID=0}log(t,i){t<=this.options.level&&(this.events.push(z({},i,{timestamp:Y.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())}error(t){this.log(ct.ERROR,t)}info(t){this.log(ct.INFO,t)}debug(t){this.log(ct.DEBUG,t)}isEmpty(){return 0===this.events.length}send(t,i){var l=z({session:this.session,bundle:this.sent+1,key:this.key,lib:"js",version:this.options.version,cluster:this.options.cluster,features:this.options.features,timeline:this.events},this.options.params);return this.events=[],t(l,(c,p)=>{c||this.sent++,i&&i(c,p)}),!0}generateUniqueID(){return this.uniqueID++,this.uniqueID}}class En{constructor(t,i,l,c){this.name=t,this.priority=i,this.transport=l,this.options=c||{}}isSupported(){return this.transport.isSupported({useTLS:this.options.useTLS})}connect(t,i){if(!this.isSupported())return gn(new K,i);if(this.priority<t)return gn(new I,i);var l=!1,c=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),p=null,f=function(){c.unbind("initialized",f),c.connect()},y=function(){p=ee.createHandshake(c,function(X){l=!0,$(),i(null,X)})},T=function(X){$(),i(X)},N=function(){var X;$(),X=ge(c),i(new M(X))},$=function(){c.unbind("initialized",f),c.unbind("open",y),c.unbind("error",T),c.unbind("closed",N)};return c.bind("initialized",f),c.bind("open",y),c.bind("error",T),c.bind("closed",N),c.initialize(),{abort:()=>{l||($(),p?p.close():c.close())},forceMinPriority:X=>{l||this.priority<X&&(p?p.close():c.close())}}}}function gn(r,t){return Y.defer(function(){t(r)}),{abort:function(){},forceMinPriority:function(){}}}const{Transports:In}=S;var Pn=function(r,t,i,l,c,p){var T,f=In[i];if(!f)throw new J(i);return r.enabledTransports&&-1===Ve(r.enabledTransports,t)||r.disabledTransports&&-1!==Ve(r.disabledTransports,t)?T=An:(c=Object.assign({ignoreNullOrigin:r.ignoreNullOrigin},c),T=new En(t,l,p?p.getAssistant(f):f,c)),T},An={isSupported:function(){return!1},connect:function(r,t){var i=Y.defer(function(){t(new K)});return{abort:function(){i.ensureAborted()},forceMinPriority:function(){}}}};var $n=r=>{if(typeof S.getAuthorizers()[r.transport]>"u")throw`'${r.transport}' is not a recognized auth transport`;return(t,i)=>{const l=((r,t)=>{var i="socket_id="+encodeURIComponent(r.socketId);for(var l in t.params)i+="&"+encodeURIComponent(l)+"="+encodeURIComponent(t.params[l]);if(null!=t.paramsProvider){let c=t.paramsProvider();for(var l in c)i+="&"+encodeURIComponent(l)+"="+encodeURIComponent(c[l])}return i})(t,r);S.getAuthorizers()[r.transport](S,l,r,v.UserAuthentication,i)}};var Dn=r=>{if(typeof S.getAuthorizers()[r.transport]>"u")throw`'${r.transport}' is not a recognized auth transport`;return(t,i)=>{const l=((r,t)=>{var i="socket_id="+encodeURIComponent(r.socketId);for(var l in i+="&channel_name="+encodeURIComponent(r.channelName),t.params)i+="&"+encodeURIComponent(l)+"="+encodeURIComponent(t.params[l]);if(null!=t.paramsProvider){let c=t.paramsProvider();for(var l in c)i+="&"+encodeURIComponent(l)+"="+encodeURIComponent(c[l])}return i})(t,r);S.getAuthorizers()[r.transport](S,l,r,v.ChannelAuthorization,i)}};const Gn=(r,t,i)=>{const l={authTransport:t.transport,authEndpoint:t.endpoint,auth:{params:t.params,headers:t.headers}};return(c,p)=>{const f=r.channel(c.channelName);i(f,l).authorize(c.socketId,p)}};function _n(r,t){let i={activityTimeout:r.activityTimeout||C_activityTimeout,cluster:r.cluster,httpPath:r.httpPath||C_httpPath,httpPort:r.httpPort||C_httpPort,httpsPort:r.httpsPort||C_httpsPort,pongTimeout:r.pongTimeout||C_pongTimeout,statsHost:r.statsHost||C_stats_host,unavailableTimeout:r.unavailableTimeout||C_unavailableTimeout,wsPath:r.wsPath||C_wsPath,wsPort:r.wsPort||C_wsPort,wssPort:r.wssPort||C_wssPort,enableStats:Bn(r),httpHost:Mn(r),useTLS:Yn(r),wsHost:Un(r),userAuthenticator:Hn(r),channelAuthorizer:Vn(r,t)};return"disabledTransports"in r&&(i.disabledTransports=r.disabledTransports),"enabledTransports"in r&&(i.enabledTransports=r.enabledTransports),"ignoreNullOrigin"in r&&(i.ignoreNullOrigin=r.ignoreNullOrigin),"timelineParams"in r&&(i.timelineParams=r.timelineParams),"nacl"in r&&(i.nacl=r.nacl),i}function Mn(r){return r.httpHost?r.httpHost:r.cluster?`sockjs-${r.cluster}.pusher.com`:C_httpHost}function Un(r){return r.wsHost?r.wsHost:function Xn(r){return`ws-${r}.pusher.com`}(r.cluster)}function Yn(r){return"https:"===S.getProtocol()||!1!==r.forceTLS}function Bn(r){return"enableStats"in r?r.enableStats:"disableStats"in r&&!r.disableStats}const vn=r=>"customHandler"in r&&null!=r.customHandler;function Hn(r){const t=Object.assign(Object.assign({},C_userAuthentication),r.userAuthentication);return vn(t)?t.customHandler:$n(t)}function Vn(r,t){const i=function zn(r,t){let i;if("channelAuthorization"in r)i=Object.assign(Object.assign({},C_channelAuthorization),r.channelAuthorization);else if(i={transport:r.authTransport||C_authTransport,endpoint:r.authEndpoint||C_authEndpoint},"auth"in r&&("params"in r.auth&&(i.params=r.auth.params),"headers"in r.auth&&(i.headers=r.auth.headers)),"authorizer"in r)return{customHandler:Gn(t,i,r.authorizer)};return i}(r,t);return vn(i)?i.customHandler:Dn(i)}class qn extends Z{constructor(t){super(function(i,l){L.debug(`No callbacks on watchlist events for ${i}`)}),this.pusher=t,this.bindWatchlistInternalEvent()}handleEvent(t){t.data.events.forEach(i=>{this.emit(i.name,i)})}bindWatchlistInternalEvent(){this.pusher.connection.bind("message",t=>{"pusher_internal:watchlist_events"===t.event&&this.handleEvent(t)})}}var Wn=function Jn(){let r,t;return{promise:new Promise((l,c)=>{r=l,t=c}),resolve:r,reject:t}};class Kn extends Z{constructor(t){super(function(i,l){L.debug("No callbacks on user for "+i)}),this.signin_requested=!1,this.user_data=null,this.serverToUserChannel=null,this.signinDonePromise=null,this._signinDoneResolve=null,this._onAuthorize=(i,l)=>{if(i)return L.warn(`Error during signin: ${i}`),void this._cleanup();this.pusher.send_event("pusher:signin",{auth:l.auth,user_data:l.user_data})},this.pusher=t,this.pusher.connection.bind("state_change",({previous:i,current:l})=>{"connected"!==i&&"connected"===l&&this._signin(),"connected"===i&&"connected"!==l&&(this._cleanup(),this._newSigninPromiseIfNeeded())}),this.watchlist=new qn(t),this.pusher.connection.bind("message",i=>{"pusher:signin_success"===i.event&&this._onSigninSuccess(i.data),this.serverToUserChannel&&this.serverToUserChannel.name===i.channel&&this.serverToUserChannel.handleEvent(i)})}signin(){this.signin_requested||(this.signin_requested=!0,this._signin())}_signin(){this.signin_requested&&(this._newSigninPromiseIfNeeded(),"connected"===this.pusher.connection.state&&this.pusher.config.userAuthenticator({socketId:this.pusher.connection.socket_id},this._onAuthorize))}_onSigninSuccess(t){try{this.user_data=JSON.parse(t.user_data)}catch{return L.error(`Failed parsing user data after signin: ${t.user_data}`),void this._cleanup()}if("string"!=typeof this.user_data.id||""===this.user_data.id)return L.error(`user_data doesn't contain an id. user_data: ${this.user_data}`),void this._cleanup();this._signinDoneResolve(),this._subscribeChannels()}_subscribeChannels(){this.serverToUserChannel=new Fe(`#server-to-user-${this.user_data.id}`,this.pusher),this.serverToUserChannel.bind_global((i,l)=>{0===i.indexOf("pusher_internal:")||0===i.indexOf("pusher:")||this.emit(i,l)}),(i=>{i.subscriptionPending&&i.subscriptionCancelled?i.reinstateSubscription():!i.subscriptionPending&&"connected"===this.pusher.connection.state&&i.subscribe()})(this.serverToUserChannel)}_cleanup(){this.user_data=null,this.serverToUserChannel&&(this.serverToUserChannel.unbind_all(),this.serverToUserChannel.disconnect(),this.serverToUserChannel=null),this.signin_requested&&this._signinDoneResolve()}_newSigninPromiseIfNeeded(){if(!this.signin_requested||this.signinDonePromise&&!this.signinDonePromise.done)return;const{promise:t,resolve:i}=Wn();t.done=!1;const c=()=>{t.done=!0};t.then(c).catch(c),this.signinDonePromise=t,this._signinDoneResolve=i}}class H{static ready(){H.isReady=!0;for(var t=0,i=H.instances.length;t<i;t++)H.instances[t].connect()}static getClientFeatures(){return P(We({ws:S.Transports.ws},function(t){return t.isSupported({})}))}constructor(t,i){(function Qn(r){if(null==r)throw"You must pass your app key when you instantiate Pusher."})(t),function On(r){if(null==r)throw"You must pass an options object";if(null==r.cluster)throw"Options object must provide a cluster";"disableStats"in r&&L.warn("The disableStats option is deprecated in favor of enableStats")}(i),this.key=t,this.options=i,this.config=_n(this.options,this),this.channels=ee.createChannels(),this.global_emitter=new Z,this.sessionID=S.randomInt(1e9),this.timeline=new jn(this.key,this.sessionID,{cluster:this.config.cluster,features:H.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:ct.INFO,version:C_VERSION}),this.config.enableStats&&(this.timelineSender=ee.createTimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/"+S.TimelineTransport.name})),this.connection=ee.createConnectionManager(this.key,{getStrategy:c=>S.getDefaultStrategy(this.config,c,Pn),timeline:this.timeline,activityTimeout:this.config.activityTimeout,pongTimeout:this.config.pongTimeout,unavailableTimeout:this.config.unavailableTimeout,useTLS:!!this.config.useTLS}),this.connection.bind("connected",()=>{this.subscribeAll(),this.timelineSender&&this.timelineSender.send(this.connection.isUsingTLS())}),this.connection.bind("message",c=>{var f=0===c.event.indexOf("pusher_internal:");if(c.channel){var y=this.channel(c.channel);y&&y.handleEvent(c)}f||this.global_emitter.emit(c.event,c.data)}),this.connection.bind("connecting",()=>{this.channels.disconnect()}),this.connection.bind("disconnected",()=>{this.channels.disconnect()}),this.connection.bind("error",c=>{L.warn(c)}),H.instances.push(this),this.timeline.info({instances:H.instances.length}),this.user=new Kn(this),H.isReady&&this.connect()}switchCluster(t){const{appKey:i,cluster:l}=t;this.key=i,this.options=Object.assign(Object.assign({},this.options),{cluster:l}),this.config=_n(this.options,this),this.connection.switchCluster(this.key)}channel(t){return this.channels.find(t)}allChannels(){return this.channels.all()}connect(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var t=this.connection.isUsingTLS(),i=this.timelineSender;this.timelineSenderTimer=new ze(6e4,function(){i.send(t)})}}disconnect(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)}bind(t,i,l){return this.global_emitter.bind(t,i,l),this}unbind(t,i,l){return this.global_emitter.unbind(t,i,l),this}bind_global(t){return this.global_emitter.bind_global(t),this}unbind_global(t){return this.global_emitter.unbind_global(t),this}unbind_all(t){return this.global_emitter.unbind_all(),this}subscribeAll(){var t;for(t in this.channels.channels)this.channels.channels.hasOwnProperty(t)&&this.subscribe(t)}subscribe(t){var i=this.channels.add(t,this);return i.subscriptionPending&&i.subscriptionCancelled?i.reinstateSubscription():!i.subscriptionPending&&"connected"===this.connection.state&&i.subscribe(),i}unsubscribe(t){var i=this.channels.find(t);i&&i.subscriptionPending?i.cancelSubscription():(i=this.channels.remove(t))&&i.subscribed&&i.unsubscribe()}send_event(t,i,l){return this.connection.send_event(t,i,l)}shouldUseTLS(){return this.config.useTLS}signin(){this.user.signin()}}H.instances=[],H.isReady=!1,H.logToConsole=!1,H.Runtime=S,H.ScriptReceivers=S.ScriptReceivers,H.DependenciesReceivers=S.DependenciesReceivers,H.auth_callbacks=S.auth_callbacks;var dn=b.default=H;S.setup(H)}])}}]);